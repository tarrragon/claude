# 📚 專案文件責任明確區分

## 三大核心文件的不同用途與寫作風格

**文件責任分工的重要性**: 每種文件都有明確且不同的目標讀者和用途，絕不可混淆責任或寫作風格

### 📰 CHANGELOG.md - 使用者導向的版本更新記錄

**目標讀者**: 產品使用者、專案維護者  
**核心用途**: 快速了解版本更新帶來的變化和影響  
**寫作風格**: 簡潔、直接、聚焦於「對使用者的價值」

**✅ 應該包含的內容**:

- **新功能**: 使用者可以使用的新功能
- **改進項目**: 效能提升、使用體驗改善
- **錯誤修正**: 已解決的問題和 bug
- **重大變更**: 可能影響使用者的變更

**✅ 正確的寫作風格範例**: 使用 feat/fix/change 分類，每項描述具體的使用者價值和功能變更

**📋 標準分類說明**:

- **feat**: 新功能 (使用者可以做之前做不到的事)
- **fix**: 錯誤修正 (修正使用者遇到的問題或當機)
- **change**: 重要變更 (改變現有功能的運作方式)

**✅ 寫作原則**:

- 描述使用者可直接感受到的功能變化
- 使用具體的操作和結果描述，避免抽象概念
- 說明實際的使用者體驗改變

**❌ 不應該包含的內容**:

- 詳細的技術實作過程
- 開發思考過程和決策原因
- 具體的程式碼變更細節
- 內部協作和溝通記錄
- 冗長的工作流程描述

**❌ 避免抽象或無法驗證的描述**:

- "提升核心功能穩定性" → ✅ 改為 "修正匯入JSON時程式當機問題"
- "強化資料品質保證" → ✅ 改為 "新增重複書籍檢查功能"
- "架構複雜度降低90%" → ✅ 改為 "移除自動同步設定介面"
- "大幅降低維護成本" → ✅ 改為 "簡化為單一匯出/匯入按鈕"
- "提升使用者體驗" → ✅ 改為 "錯誤訊息改為中文顯示"

### 📋 TODO.md - 開發規劃與進度追蹤

**目標讀者**: 開發團隊、專案經理  
**核心用途**: 追蹤開發進度和規劃未來工作  
**寫作風格**: 結構化、狀態明確、優先級清楚

**✅ 應該包含的內容**:

- **當前專案狀態**: 版本號、整體進度
- **進行中的工作**: 具體的開發任務
- **待完成項目**: 按優先級排序的工作清單
- **完成狀態追蹤**: 明確的完成度標記

**✅ 正確的寫作風格範例**:

```markdown
### ✅ Popup 模組化整合已完成 (架構完成度: 100%)

- [x] PopupController 依賴注入架構
- [x] 事件系統架構完整實作
- [x] 完整測試覆蓋 (18 個測試檔案)

### 🎯 下一步高優先級工作

- [ ] 職責拆分檢查 - data-synchronization-service.js (1689行)
```

**❌ 不應該包含的內容**:

- 詳細的開發過程記錄
- 技術問題的分析過程
- 完整的解決方案描述
- 給使用者的功能說明

### 📝 工作日誌 - 協作者知識交換平台

**目標讀者**: 開發團隊成員、未來的協作者  
**核心用途**: 詳細記錄開發過程，知識傳承和協作溝通  
**寫作風格**: 詳細、分析性、教學性

**✅ 應該包含的內容**:

- **完整的思考過程**: 如何發現問題、分析原因
- **技術決策記錄**: 為什麼選擇某種解決方案
- **問題解決流程**: 詳細的調查和修正步驟
- **學習和改進**: 經驗總結和預防機制
- **協作交接資訊**: 為下一個開發者提供的詳細脈絡

**✅ 正確的寫作風格範例**:

```markdown
### 系統性調查方法論

#### Phase 1: 實際程式碼狀況驗證

調查步驟：

1. 程式碼架構分析：檢查 PopupController 實際實作
   - 發現完整的依賴注入架構
   - 支援 EventManager 和降級機制

#### Phase 2: 測試執行狀況驗證

執行測試：npm test -- --testPathPattern="popup" --verbose
結果分析：

- 測試檔案存在且可執行
- 測試結構顯示完整的模組化架構已建立
```

**❌ 不應該包含的內容**:

- 簡化的狀態更新
- 面向使用者的功能說明
- 缺乏分析深度的流水帳記錄

## 📏 文件寫作品質標準

### CHANGELOG.md 品質要求

- **標準格式**: 使用 feat/fix/change 三大分類，每項控制在 3-5 行
- **使用者價值**: 每個項目都要能回答「這對使用者有什麼好處？」
- **具體描述**: 使用動作詞彙，明確說明功能改進或問題解決
- **影響導向**: 聚焦於使用者可感知的變更和影響

### TODO.md 品質要求

- **狀態準確**: 狀態必須與實際程式碼狀況 100% 一致
- **優先級明確**: 工作項目按重要性和緊急性排序
- **可追蹤性**: 每個項目都有明確的完成標準
- **定期更新**: 每完成一個工作立即更新狀態

### 工作日誌品質要求

- **教學性**: 新協作者能夠從中學習和理解
- **完整性**: 記錄完整的思考和決策過程
- **可重現性**: 其他人能夠根據記錄重現相同的分析
- **預防性**: 包含防止類似問題的具體建議

## 🚨 文件責任混淆的風險提醒

**文件責任混淆會導致**:

- **使用者困惑**: CHANGELOG 過於技術化，使用者無法理解版本變更價值
- **開發規劃混亂**: TODO 包含過多細節，重點不清楚
- **知識流失**: 工作日誌過於簡化，協作者無法獲得足夠資訊
- **維護困難**: 各文件責任重疊，更新時容易遺漏或不一致

**最佳實踐檢查清單**:

- [ ] CHANGELOG 是否簡潔且聚焦於使用者價值？
- [ ] TODO 是否狀態明確且優先級清楚？
- [ ] 工作日誌是否包含完整的思考和決策過程？
- [ ] 三種文件是否各司其職，沒有責任重疊？

## 📋 版本控制與工作日誌管理

### 版本號系統規範

#### 版本類型明確區分

**🎯 專案版本（數字版本號）**：

- **格式**: v0.9.x, v1.0.0（影響整個產品發布）
- **用途**: 實際的產品發布版本，面向使用者
- **範例**: v0.9.18, v1.0.0, v1.2.5

**🏗 架構版本（希臘字母）**：

- **格式**: α (Alpha), β (Beta), γ (Gamma), δ (Delta), ε (Epsilon), ζ (Zeta), η (Eta), θ (Theta)
- **用途**: 內部技術架構演進標記，不影響產品版本號
- **範例**: 事件系統架構-α, BookSearchFilter重構-β, Content模組化-γ
- **排序**: α → β → γ → δ → ε → ζ → η → θ → ι → κ → λ → μ

**🔧 功能版本（模組內部）**：

- **格式**: API v1.2, Engine v3.1（特定功能模組版本）
- **用途**: 模組內部版本追蹤，與專案版本無關

#### 版本號規則

- **v0.9.x 階段**: 重構和準備階段，為 v1.0 做準備
- **v1.0.0**: 第一個正式發布版本
- **v1.x.x**: 功能更新和改進
- **v2.0.0**: 重大架構變更或突破性更新

#### 版本確認檢查點

**任何版本相關工作前，必須先確認當前專案狀態**：

**必須檢查的檔案（按優先順序）**：

1. **`docs/todolist.md`** - 查看「🎯 專案當前狀態」章節的版本號
2. **`CHANGELOG.md`** - 確認最新版本記錄
3. **`package.json`** - 查看專案版本號
4. **最新工作日誌** - 在 `docs/work-logs/` 中找到最新的 `vX.X.X-work-log.md`

### TDD 循環合規檢查與版本提交

#### 每個 TDD 循環完成後的標準流程

#### 1. 完整合規檢查

```bash
# 執行完整檢查套件
npm test && npm run test:coverage && npm run lint && npm run build
```

**品質標準驗證**：

- [ ] 測試覆蓋率達到 100%
- [ ] 所有 linter 檢查通過
- [ ] 建置成功無錯誤
- [ ] 效能沒有明顯退化

#### 2. Git 操作驗證

```bash
git status      # 檢查變更狀態
git diff        # 確認變更內容
```

**變更驗證**：

- [ ] 變更範圍與功能描述一致
- [ ] 沒有不相關的程式碼變更
- [ ] 沒有敏感資訊洩漏

#### 3. 文件同步更新

必須更新的三大核心文件（按照「📚 專案文件責任明確區分」章節的責任分工和品質標準執行）

**文件更新檢查清單**:

- [ ] **TODO.md**: 符合開發規劃與進度追蹤標準
- [ ] **工作日誌**: 符合協作者知識交換平台標準
- [ ] **CHANGELOG.md**: 符合使用者導向版本更新記錄標準
- [ ] **專家審查記錄**: 所有專家審查報告已歸檔到 `docs/context/expert_reviews/`
- [ ] **🧠 Memory知識網路**: 重要洞察已原子化為Memory並建立連結關係

#### 4. Git Commit 提交

```bash
git add .
git commit -m "$(cat <<'EOF'
[commit message here]

EOF
)"
```

**Commit 品質標準**：

- [ ] 使用 Conventional Commits 格式
- [ ] 訊息清楚描述變更內容和原因

### 工作日誌管理規範

- **建立時機**: 每個中版本號變更時建立新的工作日誌檔案
- **檔案命名**: `docs/work-logs/vX.X.X-work-log.md`
- **更新頻率**: 每完成一個 TDD 循環或重要修復後立即更新

### 🧠 Context 使用量管理機制

**Context 容量預警規則**:

- **80% 容量觸發點**: 當偵測到 context 使用量達到上限的 80% 時，必須立即執行以下流程
- **預防性工作日誌更新**: 立即停止當前工作，更新當前進度到工作日誌
- **Context 清理重載**: 清除舊的思考內容和暫存資訊，重新讀取工作日誌內容接續工作
- **工作連續性保證**: 確保重載後能夠無縫接續中斷前的工作狀態

**Context 管理工作流程**:

1. **即時偵測**: 持續監控 context 使用量，接近 80% 時主動提醒
2. **緊急記錄**: 將當前思考過程、決策依據、下一步計劃完整記錄到工作日誌
3. **狀態保存**: 記錄當前 TDD 階段、測試狀態、技術債務、待解決問題
4. **Context 重置**: 清除所有暫存內容，從乾淨的 context 狀態重新開始
5. **工作恢復**: 重新讀取工作日誌，快速恢復到中斷前的工作狀態

**Context 重載檢查清單**:

- [ ] 當前進度已完整記錄到工作日誌
- [ ] 重要決策和發現已保存
- [ ] 下一步行動計劃已明確記錄
- [ ] 技術債務和已知問題已列出
- [ ] 測試狀態和通過/失敗情況已記錄
- [ ] 重新讀取工作日誌後能快速理解當前狀況

### 工作日誌必須包含內容

- TDD 循環的完整 Red-Green-Refactor 過程
- **詳細的思考過程和決策邏輯**
- **問題發現過程**: 如何檢查到錯誤、錯誤症狀描述
- **問題原因分析**: 深入分析錯誤為什麼會發生、根本原因追溯
- **解決方案過程**: 解決方法的選擇、嘗試過程、最終方案
- **重構思路**: 原程式碼的不佳問題、優化思路、改善效果
- **架構決策與專案結構調整**
- **技術棧選擇與工具變更決策**
- **除錯過程**: 包含錯誤訊息、診斷步驟、修復驗證
- **效能優化**: 效能問題識別、分析方法、優化成果

### 🧠 Memory與工作日誌協同機制

**工作日誌與Memory的分工**:

- **工作日誌**: 記錄完整的思考過程、調查步驟、解決方案選擇過程
- **Memory**: 萃取工作日誌中的關鍵洞察，以結論導向的原子化知識單元儲存

**Memory萃取觸發時機**:

- **專家審查階段**: 當Linux或John Carmack專家發現重要洞察時
- **問題解決完成**: 當找到根本原因和有效解決方案時
- **效能突破**: 當發現顯著的效能優化方法時
- **架構洞察**: 當重構過程發現重要的架構模式時

**工作日誌中的Memory引用**:

```markdown
### 重要發現記錄

本次開發過程中的關鍵洞察已萃取為以下Memory:

- [[使用Map代替Array查找讓搜尋效能提升10倍]] - 效能優化洞察
- [[消除if-else特殊情況的三種資料結構重設計模式]] - 重構模式

詳細的調查和實作過程記錄於上述章節。
```

**Memory與工作日誌的連結**:

- Memory中的「關鍵文件」章節必須引用對應的工作日誌檔案
- 工作日誌完成後，必須檢查是否有值得萃取的Memory
- Memory的觸發原因必須能追溯到具體的工作日誌章節

**協同品質標準**:

- [ ] 工作日誌記錄完整的過程，Memory記錄精煉的結論
- [ ] Memory標題必須比工作日誌章節標題更具結論性
- [ ] 重要的技術決策同時出現在工作日誌和Memory中
- [ ] Memory的連結網路能反映專案的技術演進脈絡

### 版本混淆防範機制

#### 絕對禁止的行為

- ❌ **將架構版本當作專案版本**: 不可將 "α, β, γ" 用於專案發布
- ❌ **跳過版本確認步驟**: 任何版本變更前必須確認當前狀態
- ❌ **版本號自動提升**: 不可未經確認自動提升大版本號
- ❌ **混合使用版本系統**: 同一文件中不可混用不同版本系統

#### 強制檢查機制

- ✅ **工作日誌強制標註**: 必須明確標註版本類型（專案/架構/功能）
- ✅ **TODO 更新前確認**: 更新 TODO 前必須確認當前專案版本
- ✅ **架構文件版本分離**: 架構文件使用希臘字母，工作日誌使用專案版本
- ✅ **Commit 訊息版本正確**: 提交訊息必須使用正確的版本號類型

---

## 🔗 相關文件連結

- [返回主指導文件](../../CLAUDE.md)
- [TDD 協作開發流程](../tdd-collaboration-flow.md)
- [Agent 協作規範](../agent-collaboration.md)
- 歷史參考（Architecture）：[v1.0-refactor-plan](../domains/archive/v1.0-refactor-plan.md)，[v1.0-refactor-analysis](../domains/archive/v1.0-refactor-analysis.md)
