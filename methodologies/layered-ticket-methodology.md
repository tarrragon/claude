# å±¤ç´šéš”é›¢æ´¾å·¥æ–¹æ³•è«–

**ç‰ˆæœ¬**: v1.0.0
**å»ºç«‹æ—¥æœŸ**: 2025-10-11
**æœ€å¾Œæ›´æ–°**: 2025-10-11
**é©ç”¨ç¯„åœ**: æ‰€æœ‰éµå¾ª Clean Architecture çš„å°ˆæ¡ˆ
**èªè¨€**: ç¹é«”ä¸­æ–‡

---

## ğŸ“‹ æ–‡ä»¶è³‡è¨Š

**ç›®çš„**: å®šç¾© Clean Architecture äº”å±¤åŠƒåˆ†æ¨™æº–å’Œå–®å±¤ä¿®æ”¹åŸå‰‡ï¼ŒæŒ‡å° Ticket æ‹†åˆ†å’Œå¯¦ä½œé †åº

> **âš ï¸ èˆ‡ Atomic Ticket æ–¹æ³•è«–çš„é—œä¿‚**ï¼š
>
> æœ¬æ–¹æ³•è«–å°ˆæ³¨æ–¼**å±¤ç´šéš”é›¢**åŸå‰‡ï¼ˆå–®å±¤ä¿®æ”¹ï¼‰ï¼Œèˆ‡ [ğŸ¯ Atomic Ticket æ–¹æ³•è«–](./atomic-ticket-methodology.md) çš„**å–®ä¸€è·è²¬**åŸå‰‡äº’è£œä½¿ç”¨ï¼š
> - **Atomic Ticket**ï¼šä¸€å€‹ Action + ä¸€å€‹ Targetï¼ˆè·è²¬ç¶­åº¦ï¼‰
> - **å±¤ç´šéš”é›¢**ï¼šä¸€å€‹ Ticket åªä¿®æ”¹ä¸€å€‹æ¶æ§‹å±¤ç´šï¼ˆå±¤ç´šç¶­åº¦ï¼‰
>
> **æœ¬æ–‡ä»¶ä¸­çš„é‡åŒ–æŒ‡æ¨™ï¼ˆæª”æ¡ˆæ•¸ã€è¡Œæ•¸ç­‰ï¼‰åƒ…ä¾›åƒè€ƒ**ï¼ŒTicket æ‹†åˆ†çš„æ ¸å¿ƒä¾æ“šä»æ˜¯å–®ä¸€è·è²¬åŸå‰‡ã€‚

**é©ç”¨å°è±¡**:
- å°ˆæ¡ˆç¶“ç†ï¼ˆPMï¼‰- è¦åŠƒå’Œæ‹†åˆ† Ticket
- é–‹ç™¼äººå“¡ - åŸ·è¡Œå–®å±¤ä¿®æ”¹
- æ¶æ§‹å¸« - è¨­è¨ˆå’Œå¯©æŸ¥æ¶æ§‹
- Code Reviewer - æª¢æŸ¥å±¤ç´šéš”é›¢åŸå‰‡

**é—œéµæ¦‚å¿µ**:
- Clean Architecture äº”å±¤æ¶æ§‹
- å–®å±¤ä¿®æ”¹åŸå‰‡
- å¾å¤–è€Œå…§å¯¦ä½œé †åº
- Ticket ç²’åº¦æ¨™æº–

---

## ç¬¬ä¸€ç« ï¼šæ–¹æ³•è«–æ¦‚è¿°

### 1.1 ç‚ºä»€éº¼éœ€è¦å±¤ç´šéš”é›¢

**å•é¡ŒèƒŒæ™¯**:

åœ¨è»Ÿé«”é–‹ç™¼ä¸­ï¼Œæˆ‘å€‘å¸¸å¸¸é‡åˆ°ä»¥ä¸‹å•é¡Œï¼š
- âŒ Ticket ç¯„åœéå¤§ï¼Œä¸€å€‹ Ticket ä¿®æ”¹å¤šå€‹æ¶æ§‹å±¤ç´š
- âŒ è®Šæ›´å½±éŸ¿ç¯„åœä¸å¯æ§ï¼Œä¿®æ”¹ UI å»å½±éŸ¿ Domain é‚è¼¯
- âŒ æ¸¬è©¦å›°é›£ï¼Œéœ€è¦å•Ÿå‹•æ•´å€‹ç³»çµ±æ‰èƒ½æ¸¬è©¦å–®ä¸€åŠŸèƒ½
- âŒ Code Review è¤‡é›œï¼Œå¯©æŸ¥è€…éœ€è¦ç†è§£æ‰€æœ‰å±¤ç´š

**æ ¹æœ¬åŸå› **:
- ç¼ºä¹æ˜ç¢ºçš„å±¤ç´šåŠƒåˆ†æ¨™æº–
- ç¼ºä¹å–®å±¤ä¿®æ”¹çš„åˆ¤æ–·æ¨™æº–
- ç¼ºä¹å¯¦ä½œé †åºçš„æŒ‡å¼•

**å±¤ç´šéš”é›¢è§£æ±ºçš„å•é¡Œ**:
1. **é™ä½è®Šæ›´é¢¨éšª**: å–®å±¤ä¿®æ”¹ç¢ºä¿å½±éŸ¿ç¯„åœæœ€å°åŒ–
2. **æå‡æ¸¬è©¦ç¨ç«‹æ€§**: æ¯å±¤å¯ä»¥ç¨ç«‹æ¸¬è©¦ï¼Œä¸éœ€è¦å•Ÿå‹•æ•´å€‹ç³»çµ±
3. **åŠ é€Ÿé–‹ç™¼å¾ªç’°**: å¾å¤–è€Œå…§å¯¦ä½œï¼Œå¿«é€Ÿé©—è­‰éœ€æ±‚
4. **æå‡ Code Review æ•ˆç‡**: å¯©æŸ¥è€…åªéœ€è¦é—œæ³¨å–®ä¸€å±¤ç´š

### 1.2 æ ¸å¿ƒåŸå‰‡

æœ¬æ–¹æ³•è«–åŸºæ–¼ä»¥ä¸‹æ ¸å¿ƒåŸå‰‡ï¼š

**åŸå‰‡ 1: äº”å±¤æ¶æ§‹æ˜ç¢ºåŠƒåˆ†**
```text
Layer 1: UI/Presentation         (è¦–è¦ºå‘ˆç¾)
Layer 2: Application/Behavior    (äº‹ä»¶è™•ç†)
Layer 3: UseCase                 (æ¥­å‹™æµç¨‹)
Layer 4: Domain Events/Interfaces (ä»‹é¢å¥‘ç´„)
Layer 5: Domain Implementation   (æ ¸å¿ƒæ¥­å‹™é‚è¼¯)
```

**åŸå‰‡ 2: å–®å±¤ä¿®æ”¹**
> ä¸€å€‹ Ticket åªæ‡‰è©²ä¿®æ”¹å–®ä¸€æ¶æ§‹å±¤ç´šçš„ç¨‹å¼ç¢¼ï¼Œè®Šæ›´çš„åŸå› å–®ä¸€ä¸”æ˜ç¢ºã€‚

**åŸå‰‡ 3: å¾å¤–è€Œå…§å¯¦ä½œ**
> å¯¦ä½œé †åºç‚º Layer 1 â†’ Layer 2 â†’ Layer 3 â†’ Layer 4 â†’ Layer 5ï¼Œå½±éŸ¿ç¯„åœéå¢ã€‚

**åŸå‰‡ 4: ä¾è³´å€’ç½®**
> å¤–å±¤ä¾è³´å…§å±¤çš„æŠ½è±¡ä»‹é¢ï¼Œå…§å±¤ä¸ä¾è³´å¤–å±¤ï¼Œæ‰€æœ‰ä¾è³´é€šéä»‹é¢ã€‚

### 1.3 é©ç”¨å ´æ™¯

**é©ç”¨å ´æ™¯** âœ…:
- æ–°åŠŸèƒ½é–‹ç™¼ï¼ˆå¾é›¶é–‹å§‹è¨­è¨ˆï¼‰
- ç¾æœ‰åŠŸèƒ½ä¿®æ”¹ï¼ˆå„ªåŒ–æˆ–èª¿æ•´ï¼‰
- é‡æ§‹ï¼ˆæ”¹å–„ç¨‹å¼å“è³ªï¼‰
- æ¶æ§‹é·ç§»ï¼ˆå¾èˆŠæ¶æ§‹é·ç§»åˆ°æ–°æ¶æ§‹ï¼‰

**ä¸é©ç”¨å ´æ™¯** âŒ:
- ç·Šæ€¥ Hotfixï¼ˆå¯èƒ½éœ€è¦å¿«é€Ÿè·¨å±¤ä¿®æ”¹ï¼‰
- åŸå‹é–‹ç™¼ï¼ˆéœ€è¦å¿«é€Ÿé©—è­‰æ¦‚å¿µï¼‰
- ä¸€æ¬¡æ€§è…³æœ¬ï¼ˆä¸éœ€è¦æ¶æ§‹è¨­è¨ˆï¼‰

**ç‰¹æ®Šå ´æ™¯** âš ï¸:
- æ¶æ§‹é·ç§» â†’ ä½¿ç”¨ Interface-First ç­–ç•¥
- å®‰å…¨æ€§ä¿®å¾© â†’ ä½¿ç”¨å¾å…§è€Œå¤–ç­–ç•¥
- ç¬¬ä¸‰æ–¹å¥—ä»¶å‡ç´š â†’ è¦–æƒ…æ³èª¿æ•´é †åº

### 1.4 èˆ‡ç¾æœ‰æ–¹æ³•è«–çš„é—œä¿‚

**èˆ‡ Clean Architecture å¯¦ä½œæ–¹æ³•è«–çš„é—œä¿‚**:
- **Clean Architecture å¯¦ä½œæ–¹æ³•è«–**: å®šç¾©å¦‚ä½•å¯¦ä½œæ¯ä¸€å±¤çš„ç¨‹å¼ç¢¼
- **å±¤ç´šéš”é›¢æ´¾å·¥æ–¹æ³•è«–**: å®šç¾©å¦‚ä½•æ‹†åˆ† Ticket å’Œå¯¦ä½œé †åº
- **é—œä¿‚**: äº’è£œï¼Œå±¤ç´šéš”é›¢æ–¹æ³•è«–æ˜¯ Clean Architecture çš„æ´¾å·¥æŒ‡å—

**èˆ‡ TDD å››éšæ®µæµç¨‹çš„é—œä¿‚**:
- **Phase 1 (åŠŸèƒ½è¨­è¨ˆ)**: ä½¿ç”¨å±¤ç´šéš”é›¢æ–¹æ³•è«–æ‹†åˆ† Ticket
- **Phase 2 (æ¸¬è©¦é©—è­‰)**: é©—è­‰æ¯å±¤çš„æ¸¬è©¦ç¨ç«‹æ€§
- **Phase 3 (å¯¦ä½œåŸ·è¡Œ)**: éµå¾ªå¾å¤–è€Œå…§å¯¦ä½œé †åº
- **Phase 4 (é‡æ§‹å„ªåŒ–)**: è©•ä¼°æ˜¯å¦é•åå–®å±¤ä¿®æ”¹åŸå‰‡

**èˆ‡ Ticket è¨­è¨ˆæ–¹æ³•è«–çš„é—œä¿‚**:
- **Ticket è¨­è¨ˆæ–¹æ³•è«–**: å®šç¾© Ticket çš„åŸºæœ¬æ ¼å¼å’Œå…§å®¹
- **å±¤ç´šéš”é›¢æ´¾å·¥æ–¹æ³•è«–**: å®šç¾© Ticket çš„ç²’åº¦å’Œæ‹†åˆ†æ¨™æº–
- **é—œä¿‚**: å±¤ç´šéš”é›¢æ–¹æ³•è«–æ˜¯ Ticket è¨­è¨ˆæ–¹æ³•è«–çš„å…·é«”æ‡‰ç”¨

### 1.5 æ–‡ä»¶ç« ç¯€å°è¦½

**å¿«é€Ÿå°èˆª**ï¼šæ ¹æ“šæ‚¨çš„è§’è‰²å’Œéœ€æ±‚ï¼Œé¸æ“‡é©åˆçš„ç« ç¯€é–‹å§‹é–±è®€

| ç« ç¯€ | ä¸»é¡Œ | é©ç”¨å°è±¡ | æ ¸å¿ƒå…§å®¹ | é è¨ˆé–±è®€æ™‚é–“ |
|------|------|---------|---------|------------|
| **ç¬¬ä¸€ç« ** | æ–¹æ³•è«–æ¦‚è¿° | æ‰€æœ‰äºº | ç‚ºä»€éº¼éœ€è¦å±¤ç´šéš”é›¢ã€æ ¸å¿ƒåŸå‰‡ | 10 åˆ†é˜ |
| **ç¬¬äºŒç« ** | äº”å±¤æ¶æ§‹å®šç¾© | PMã€é–‹ç™¼äººå“¡ã€æ¶æ§‹å¸« | Layer 1-5 å®Œæ•´å®šç¾©ã€æ±ºç­–æ¨¹ | 30 åˆ†é˜ |
| **ç¬¬ä¸‰ç« ** | å–®å±¤ä¿®æ”¹åŸå‰‡ | PMã€é–‹ç™¼äººå“¡ | åŸå‰‡å®šç¾©ã€é•è¦æ¨¡å¼è­˜åˆ¥ | 15 åˆ†é˜ |
| **ç¬¬å››ç« ** | å¯¦ä½œé †åºæŒ‡å¼• | é–‹ç™¼äººå“¡ã€æ¶æ§‹å¸« | å¾å¤–è€Œå…§ç­–ç•¥ã€ç‰¹æ®Šå ´æ™¯è™•ç† | 20 åˆ†é˜ |
| **ç¬¬äº”ç« ** | Ticket ç²’åº¦æ¨™æº– | PM | é‡åŒ–æŒ‡æ¨™ã€æ‹†åˆ†æŒ‡å¼•ã€ç¯„ä¾‹ | 25 åˆ†é˜ |
| **ç¬¬å…­ç« ** | å±¤ç´šæª¢æŸ¥æ©Ÿåˆ¶ | Code Reviewerã€é–‹ç™¼äººå“¡ | è‡ªå‹•åŒ–æª¢æŸ¥ã€é•è¦æ¨¡å¼ | 20 åˆ†é˜ |
| **ç¬¬ä¸ƒç« ** | å¯¦è¸æ¡ˆä¾‹ | æ‰€æœ‰äºº | 3 å€‹å®Œæ•´æ¡ˆä¾‹ï¼ˆæ–°å¢ã€é‡æ§‹ã€é·ç§»ï¼‰ | 40 åˆ†é˜ |
| **ç¬¬å…«ç« ** | æ–¹æ³•è«–æ•´åˆ | PMã€æ¶æ§‹å¸« | èˆ‡ TDDã€æ•æ·ã€Clean Architecture æ•´åˆ | 10 åˆ†é˜ |
| **ç¬¬ä¹ç« ** | å¸¸è¦‹å•é¡Œ FAQ | æ‰€æœ‰äºº | 12 å€‹ Q&Aï¼ˆç†è«–ã€å¯¦å‹™ã€åœ˜éšŠå”ä½œï¼‰ | 30 åˆ†é˜ |
| **ç¬¬åç« ** | åƒè€ƒè³‡æ–™ | æ‰€æœ‰äºº | æ–‡ç»ã€å·¥å…·ã€ç·šä¸Šè³‡æº | 10 åˆ†é˜ |

**é–±è®€å»ºè­°**ï¼š
- **PM**: å»ºè­°é–±è®€[ç¬¬ä¸€ç« ](#ç¬¬ä¸€ç« æ–¹æ³•è«–æ¦‚è¿°)ã€[ç¬¬äºŒç« ](#ç¬¬äºŒç« clean-architecture-äº”å±¤å®šç¾©)ã€[ç¬¬äº”ç« ](#ç¬¬äº”ç« ticket-ç²’åº¦æ¨™æº–)ã€[ç¬¬ä¹ç« ](#ç¬¬ä¹ç« å¸¸è¦‹å•é¡Œ-faq)ï¼ˆæ ¸å¿ƒï¼šTicket æ‹†åˆ†å’Œç²’åº¦æ¨™æº–ï¼‰
- **é–‹ç™¼äººå“¡**: å»ºè­°é–±è®€[ç¬¬ä¸€ç« ](#ç¬¬ä¸€ç« æ–¹æ³•è«–æ¦‚è¿°)ã€[ç¬¬äºŒç« ](#ç¬¬äºŒç« clean-architecture-äº”å±¤å®šç¾©)ã€[ç¬¬ä¸‰ç« ](#ç¬¬ä¸‰ç« å–®å±¤ä¿®æ”¹åŸå‰‡)ã€[ç¬¬å››ç« ](#ç¬¬å››ç« å¯¦ä½œé †åºæŒ‡å¼•å¾å¤–è€Œå…§)ã€[ç¬¬å…­ç« ](#ç¬¬å…­ç« å±¤ç´šæª¢æŸ¥æ©Ÿåˆ¶)ï¼ˆæ ¸å¿ƒï¼šå–®å±¤ä¿®æ”¹å’Œå¯¦ä½œé †åºï¼‰
- **æ¶æ§‹å¸«**: å»ºè­°é–±è®€[ç¬¬ä¸€ç« ](#ç¬¬ä¸€ç« æ–¹æ³•è«–æ¦‚è¿°)ã€[ç¬¬äºŒç« ](#ç¬¬äºŒç« clean-architecture-äº”å±¤å®šç¾©)ã€[ç¬¬å››ç« ](#ç¬¬å››ç« å¯¦ä½œé †åºæŒ‡å¼•å¾å¤–è€Œå…§)ã€[ç¬¬ä¸ƒç« ](#ç¬¬ä¸ƒç« å¯¦è¸æ¡ˆä¾‹)ã€[ç¬¬å…«ç« ](#ç¬¬å…«ç« èˆ‡å…¶ä»–æ–¹æ³•è«–çš„æ•´åˆ)ï¼ˆæ ¸å¿ƒï¼šæ¶æ§‹è¨­è¨ˆå’Œæ–¹æ³•è«–æ•´åˆï¼‰
- **Code Reviewer**: å»ºè­°é–±è®€[ç¬¬ä¸€ç« ](#ç¬¬ä¸€ç« æ–¹æ³•è«–æ¦‚è¿°)ã€[ç¬¬äºŒç« ](#ç¬¬äºŒç« clean-architecture-äº”å±¤å®šç¾©)ã€[ç¬¬ä¸‰ç« ](#ç¬¬ä¸‰ç« å–®å±¤ä¿®æ”¹åŸå‰‡)ã€[ç¬¬å…­ç« ](#ç¬¬å…­ç« å±¤ç´šæª¢æŸ¥æ©Ÿåˆ¶)ï¼ˆæ ¸å¿ƒï¼šå±¤ç´šæª¢æŸ¥æ©Ÿåˆ¶ï¼‰
- **æ–°æ‰‹**: å»ºè­°æŒ‰é †åºå®Œæ•´é–±è®€ï¼Œé è¨ˆ 3-4 å°æ™‚

### 1.6 å¿«é€Ÿé–‹å§‹æŒ‡å¼•ï¼ˆ5 åˆ†é˜ï¼‰

**æ ¹æ“šæ‚¨çš„è§’è‰²ï¼Œé¸æ“‡å°æ‡‰çš„å¿«é€Ÿé–‹å§‹æµç¨‹**

#### ğŸ¯ PM å¿«é€Ÿé–‹å§‹

**ç›®æ¨™**ï¼šå­¸æœƒæ‹†åˆ†ç¬¦åˆå±¤ç´šéš”é›¢åŸå‰‡çš„ Ticket

**4 æ­¥å¿«é€Ÿä¸Šæ‰‹**ï¼š
1. **ç†è§£äº”å±¤æ¶æ§‹** â†’ é–±è®€ [2.2 äº”å±¤æ¶æ§‹å®Œæ•´å®šç¾©](#22-äº”å±¤æ¶æ§‹å®Œæ•´å®šç¾©)
2. **ä½¿ç”¨æ±ºç­–æ¨¹** â†’ é–±è®€ [2.4 æ±ºç­–æ¨¹](#24-åˆ¤æ–·ç¨‹å¼ç¢¼å±¬æ–¼å“ªä¸€å±¤çš„æ±ºç­–æ¨¹)
3. **æŒ‰å±¤ç´šæ‹†åˆ† Ticket** â†’ é–±è®€ [5.3 è‰¯å¥½ Ticket ç¯„ä¾‹](#53-è‰¯å¥½çš„-ticket-è¨­è¨ˆç¯„ä¾‹)
4. **æª¢æŸ¥ç²’åº¦æ¨™æº–** â†’ é–±è®€ [5.2 é‡åŒ–æŒ‡æ¨™](#52-é‡åŒ–æŒ‡æ¨™å®šç¾©)

**å¿«é€Ÿæª¢æŸ¥æ¸…å–®**ï¼š
- [ ] æ¯å€‹ Ticket åªä¿®æ”¹å–®ä¸€å±¤ç´šï¼Ÿ
- [ ] æª”æ¡ˆæ•¸åœ¨ 1-5 å€‹ä¹‹é–“ï¼Ÿ
- [ ] é ä¼°å·¥æ™‚åœ¨ 2-8 å°æ™‚ï¼Ÿ
- [ ] æœ‰æ˜ç¢ºçš„é©—æ”¶æ¢ä»¶ï¼Ÿ

---

#### ğŸ‘¨â€ğŸ’» é–‹ç™¼äººå“¡å¿«é€Ÿé–‹å§‹

**ç›®æ¨™**ï¼šåŸ·è¡Œç¬¦åˆå±¤ç´šéš”é›¢åŸå‰‡çš„å–®å±¤ä¿®æ”¹

**4 æ­¥å¿«é€Ÿä¸Šæ‰‹**ï¼š
1. **ç¢ºèª Ticket å±¤ç´šå®šä½** â†’ æª¢æŸ¥ Ticket æ¨™é¡Œæ˜¯å¦æ¨™æ˜ [Layer X]
2. **éµå¾ªå–®å±¤ä¿®æ”¹åŸå‰‡** â†’ é–±è®€ [3.1 å–®å±¤ä¿®æ”¹åŸå‰‡å®šç¾©](#31-å–®å±¤ä¿®æ”¹åŸå‰‡å®šç¾©)
3. **éµå¾ªå¾å¤–è€Œå…§é †åº** â†’ é–±è®€ [4.1 å¾å¤–è€Œå…§å¯¦ä½œ](#41-ç‚ºä»€éº¼å¾å¤–è€Œå…§å¯¦ä½œ)
4. **ç¢ºä¿æ¸¬è©¦é€šé** â†’ é–±è®€ [6.4 æ¸¬è©¦ç¯„åœåˆ†æ](#64-æ¸¬è©¦ç¯„åœåˆ†ææ³•)

**é–‹ç™¼å‰æª¢æŸ¥æ¸…å–®**ï¼š
- [ ] ç¢ºèªæ­¤ Ticket åªä¿®æ”¹å–®ä¸€å±¤ç´šï¼Ÿ
- [ ] ç¢ºèªä¾è³´çš„å…§å±¤ä»‹é¢å·²å­˜åœ¨ï¼Ÿ
- [ ] æº–å‚™å¥½ Mock æˆ– Stubï¼ˆå¦‚æœå…§å±¤æœªå®Œæˆï¼‰ï¼Ÿ
- [ ] æ¸¬è©¦æª”æ¡ˆè·¯å¾‘å°æ‡‰å±¤ç´šçµæ§‹ï¼Ÿ

**é–‹ç™¼å¾Œæª¢æŸ¥æ¸…å–®**ï¼š
- [ ] æ‰€æœ‰æ¸¬è©¦ 100% é€šéï¼Ÿ
- [ ] æ²’æœ‰è·¨å±¤ç›´æ¥å‘¼å«ï¼Ÿ
- [ ] ä¾è³´æ–¹å‘æ­£ç¢ºï¼ˆå¤–å±¤ä¾è³´å…§å±¤ï¼‰ï¼Ÿ

---

#### ğŸ” Code Reviewer å¿«é€Ÿé–‹å§‹

**ç›®æ¨™**ï¼šå¿«é€Ÿæª¢æŸ¥ PR æ˜¯å¦ç¬¦åˆå±¤ç´šéš”é›¢åŸå‰‡

**3 æ­¥å¿«é€Ÿæª¢æŸ¥**ï¼š
1. **æª¢æŸ¥å–®å±¤ä¿®æ”¹åŸå‰‡** â†’ ä½¿ç”¨ [6.2 æª”æ¡ˆè·¯å¾‘åˆ†ææ³•](#62-æª”æ¡ˆè·¯å¾‘åˆ†ææ³•)
2. **æª¢æŸ¥æ¸¬è©¦è¦†è“‹ç‡** â†’ ä½¿ç”¨ [6.4 æ¸¬è©¦ç¯„åœåˆ†ææ³•](#64-æ¸¬è©¦ç¯„åœåˆ†ææ³•)
3. **è­˜åˆ¥é•è¦æ¨¡å¼** â†’ åƒè€ƒ [6.5 é•è¦æ¨¡å¼è­˜åˆ¥](#65-é•è¦æ¨¡å¼è­˜åˆ¥)

**Code Review å¿«é€Ÿæª¢æŸ¥æ¸…å–®**ï¼š
- [ ] æ­¤ PR æ˜¯å¦åªä¿®æ”¹å–®ä¸€å±¤ç´šï¼Ÿï¼ˆçœ‹æª”æ¡ˆè·¯å¾‘ï¼‰
- [ ] ä¾è³´æ–¹å‘æ˜¯å¦æ­£ç¢ºï¼Ÿï¼ˆçœ‹ import èªå¥ï¼‰
- [ ] æ¸¬è©¦æª”æ¡ˆè·¯å¾‘æ˜¯å¦å°æ‡‰å±¤ç´šï¼Ÿï¼ˆçœ‹ test/ è·¯å¾‘ï¼‰
- [ ] æ¸¬è©¦è¦†è“‹ç‡æ˜¯å¦é”åˆ° 100%ï¼Ÿ
- [ ] æ˜¯å¦æœ‰é•è¦æ¨¡å¼ï¼Ÿï¼ˆUI åŒ…å«æ¥­å‹™é‚è¼¯ã€Controller åŒ…å«æ¥­å‹™è¦å‰‡ç­‰ï¼‰

**å¿«é€Ÿåˆ¤æ–·æŠ€å·§**ï¼š
- **5 ç§’æª¢æŸ¥**ï¼šçœ‹æª”æ¡ˆè·¯å¾‘ï¼Œåˆ¤æ–·æ˜¯å¦è·¨å±¤
- **10 ç§’æª¢æŸ¥**ï¼šçœ‹ import èªå¥ï¼Œåˆ¤æ–·ä¾è³´æ–¹å‘
- **30 ç§’æª¢æŸ¥**ï¼šçœ‹æ¸¬è©¦æª”æ¡ˆï¼Œåˆ¤æ–·æ¸¬è©¦ç¯„åœ

---

#### ğŸ“š å®Œæ•´å­¸ç¿’è·¯å¾‘

**æ–°æ‰‹å»ºè­°**ï¼ˆ3-4 å°æ™‚å®Œæ•´é–±è®€ï¼‰ï¼š

**æ­¥é©Ÿ 1ï¼šç†è§£èƒŒæ™¯å’ŒåŸå‰‡**ï¼ˆ30 åˆ†é˜ï¼‰
  - [ç¬¬ä¸€ç« ï¼šæ–¹æ³•è«–æ¦‚è¿°](#ç¬¬ä¸€ç« æ–¹æ³•è«–æ¦‚è¿°)
  - [ç¬¬äºŒç« ï¼šäº”å±¤æ¶æ§‹å®šç¾©](#ç¬¬äºŒç« clean-architecture-äº”å±¤å®šç¾©)

**æ­¥é©Ÿ 2ï¼šæŒæ¡æ ¸å¿ƒæŠ€èƒ½**ï¼ˆ1 å°æ™‚ï¼‰
  - [ç¬¬ä¸‰ç« ï¼šå–®å±¤ä¿®æ”¹åŸå‰‡](#ç¬¬ä¸‰ç« å–®å±¤ä¿®æ”¹åŸå‰‡)
  - [ç¬¬å››ç« ï¼šå¯¦ä½œé †åºæŒ‡å¼•](#ç¬¬å››ç« å¯¦ä½œé †åºæŒ‡å¼•å¾å¤–è€Œå…§)
  - [ç¬¬äº”ç« ï¼šTicket ç²’åº¦æ¨™æº–](#ç¬¬äº”ç« ticket-ç²’åº¦æ¨™æº–)

**æ­¥é©Ÿ 3ï¼šå­¸ç¿’æª¢æŸ¥å’Œå¯¦è¸**ï¼ˆ1.5 å°æ™‚ï¼‰
  - [ç¬¬å…­ç« ï¼šå±¤ç´šæª¢æŸ¥æ©Ÿåˆ¶](#ç¬¬å…­ç« å±¤ç´šæª¢æŸ¥æ©Ÿåˆ¶)
  - [ç¬¬ä¸ƒç« ï¼šå¯¦è¸æ¡ˆä¾‹](#ç¬¬ä¸ƒç« å¯¦è¸æ¡ˆä¾‹)

**æ­¥é©Ÿ 4ï¼šæ·±å…¥æ•´åˆå’Œ FAQ**ï¼ˆ1 å°æ™‚ï¼‰
  - [ç¬¬å…«ç« ï¼šèˆ‡å…¶ä»–æ–¹æ³•è«–çš„æ•´åˆ](#ç¬¬å…«ç« èˆ‡å…¶ä»–æ–¹æ³•è«–çš„æ•´åˆ)
  - [ç¬¬ä¹ç« ï¼šå¸¸è¦‹å•é¡Œ FAQ](#ç¬¬ä¹ç« å¸¸è¦‹å•é¡Œ-faq)
  - [ç¬¬åç« ï¼šåƒè€ƒè³‡æ–™](#ç¬¬åç« åƒè€ƒè³‡æ–™)

---

## ç¬¬äºŒç« ï¼šClean Architecture äº”å±¤å®šç¾©

### 2.1 ç‚ºä»€éº¼éœ€è¦äº”å±¤è€Œéå‚³çµ±çš„ä¸‰å±¤æˆ–å››å±¤ï¼Ÿ

**å‚³çµ± Clean Architecture å››å±¤å•é¡Œ**:
```text
å‚³çµ±å››å±¤:
Layer 1: Entities
Layer 2: Use Cases
Layer 3: Interface Adapters (Controller + Presenter + Gateway)
Layer 4: Frameworks & Drivers (UI + DB + External)

å•é¡Œï¼š
- Interface Adapters å±¤æ··åˆäº†ã€Œè¡Œç‚ºé‚è¼¯ã€å’Œã€Œè³‡æ–™è½‰æ›ã€
- Frameworks & Drivers å±¤æ··åˆäº†ã€ŒUI æ¸²æŸ“ã€å’Œã€ŒåŸºç¤è¨­æ–½ã€
- é›£ä»¥åˆ¤æ–·ã€Œäº‹ä»¶è™•ç†é‚è¼¯ã€æ‡‰è©²æ”¾åœ¨å“ªä¸€å±¤
```

**äº”å±¤æ¶æ§‹å„ªå‹¢**:
```text
å„ªåŒ–å¾Œçš„äº”å±¤:
Layer 1: UI/Presentation (è¦–è¦ºå…ƒç´ )
Layer 2: Application/Behavior (UI é‚è¼¯å’Œäº‹ä»¶è™•ç†)
Layer 3: UseCase (æ¥­å‹™æµç¨‹ç·¨æ’)
Layer 4: Domain Events/Interfaces (äº‹ä»¶å®šç¾©å’Œä»‹é¢å¥‘ç´„)
Layer 5: Domain Implementation (æ ¸å¿ƒæ¥­å‹™é‚è¼¯)

å„ªå‹¢ï¼š
- è·è²¬é‚Šç•Œæ›´æ¸…æ™°ï¼Œæ¯å±¤çš„è®Šæ›´åŸå› å–®ä¸€
- ç¬¦åˆ Flutter å¯¦å‹™æ¶æ§‹ï¼ˆWidget â†” Controller â†” UseCase â†” Repository â†” Entityï¼‰
- ä¾¿æ–¼ Ticket ç²’åº¦æª¢æŸ¥ï¼ˆä¸€å€‹ Ticket åªä¿®æ”¹ä¸€å±¤ï¼‰
- é¿å…ã€Œè¡Œç‚ºé‚è¼¯ã€å’Œã€Œè¦–è¦ºå‘ˆç¾ã€æ··æ·†
```

### 2.2 äº”å±¤æ¶æ§‹å®Œæ•´å®šç¾©

#### Layer 1: UI/Presentationï¼ˆè¦–è¦ºå‘ˆç¾å±¤ï¼‰

**è·è²¬ç¯„åœ**:
- **è¦–è¦ºå…ƒç´ **: Widgets, Components, UI Layout
- **æ¨£å¼å®šç¾©**: Colors, TextStyles, Themes
- **UI ç‹€æ…‹ç®¡ç†**: UI-specific State (å¦‚å±•é–‹/æ”¶åˆã€é¸ä¸­ç‹€æ…‹)

**ä¸è² è²¬**:
- âŒ äº‹ä»¶è™•ç†é‚è¼¯ï¼ˆå±¬æ–¼ Layer 2ï¼‰
- âŒ æ¥­å‹™æµç¨‹å‘¼å«ï¼ˆå±¬æ–¼ Layer 3ï¼‰
- âŒ è³‡æ–™é©—è­‰ï¼ˆå±¬æ–¼ Layer 4 æˆ– Layer 5ï¼‰

**Flutter å°æ‡‰**:
- `Widget` é¡åˆ¥ï¼ˆStatefulWidget, StatelessWidgetï¼‰
- `build()` æ–¹æ³•å…§çš„ UI æ¨¹çµæ§‹
- Theme å’Œ Style å®šç¾©

**åˆ¤æ–·æ¨™æº–**:
- **è®Šæ›´åŸå› **: åªå› ç‚ºã€Œè¦–è¦ºè¨­è¨ˆè®Šæ›´ã€è€Œä¿®æ”¹
- **æ¸¬è©¦é¡å‹**: Widget æ¸¬è©¦ï¼ˆé©—è­‰ UI æ¸²æŸ“ï¼‰
- **ä¾è³´æ–¹å‘**: ä¾è³´ Layer 2 çš„ Controller æˆ– ViewModel

**ç¯„ä¾‹**:
```dart
// âœ… Layer 1: ç´”ç²¹çš„è¦–è¦ºå‘ˆç¾ï¼Œä¸åŒ…å«æ¥­å‹™é‚è¼¯
class BookDetailPage extends StatelessWidget {
  final BookDetailController controller;

  const BookDetailPage({required this.controller});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('æ›¸ç±è©³æƒ…')),
      body: Column(
        children: [
          // ç´”ç²¹çš„ UI å…ƒç´ 
          Text(controller.bookTitle),
          ElevatedButton(
            // åªå‘¼å« Controller æ–¹æ³•ï¼Œä¸åŒ…å«é‚è¼¯
            onPressed: controller.onAddToFavorite,
            child: Text('åŠ å…¥æ”¶è—'),
          ),
        ],
      ),
    );
  }
}
```

---

#### Layer 2: Application/Behaviorï¼ˆæ‡‰ç”¨è¡Œç‚ºå±¤ï¼‰

**è·è²¬ç¯„åœ**:
- **äº‹ä»¶è™•ç†**: è™•ç† UI äº‹ä»¶ï¼ˆé»æ“Šã€è¼¸å…¥ã€æ‰‹å‹¢ï¼‰
- **UI é‚è¼¯**: æ§åˆ¶ UI ç‹€æ…‹è½‰æ›ã€é¡¯ç¤º/éš±è—å…ƒç´ 
- **è¼¸å…¥é©—è­‰**: è¡¨å–®é©—è­‰ã€æ ¼å¼æª¢æŸ¥ï¼ˆUI å±¤ç´šï¼‰
- **UseCase å”èª¿**: å‘¼å« UseCase ä¸¦è™•ç†çµæœ
- **è³‡æ–™è½‰æ›**: å°‡ Domain Entity è½‰æ›ç‚º UI å¯é¡¯ç¤ºçš„ ViewModel

**ä¸è² è²¬**:
- âŒ UI æ¸²æŸ“ï¼ˆå±¬æ–¼ Layer 1ï¼‰
- âŒ æ¥­å‹™æµç¨‹ç·¨æ’ï¼ˆå±¬æ–¼ Layer 3ï¼‰
- âŒ æ ¸å¿ƒæ¥­å‹™è¦å‰‡ï¼ˆå±¬æ–¼ Layer 5ï¼‰

**Flutter å°æ‡‰**:
- `Controller` é¡åˆ¥ï¼ˆå¦‚ `BookDetailController`ï¼‰
- `ViewModel` é¡åˆ¥
- `Bloc` / `Cubit` çš„äº‹ä»¶è™•ç†éƒ¨åˆ†
- `Presenter` é¡åˆ¥

**åˆ¤æ–·æ¨™æº–**:
- **è®Šæ›´åŸå› **: å› ç‚ºã€Œäº’å‹•æµç¨‹è®Šæ›´ã€æˆ–ã€Œäº‹ä»¶è™•ç†é‚è¼¯è®Šæ›´ã€è€Œä¿®æ”¹
- **æ¸¬è©¦é¡å‹**: è¡Œç‚ºæ¸¬è©¦ï¼ˆé©—è­‰äº‹ä»¶è§¸ç™¼å’Œç‹€æ…‹è®Šæ›´ï¼‰
- **ä¾è³´æ–¹å‘**: ä¾è³´ Layer 3 çš„ UseCase

**ç¯„ä¾‹ 1: åŸºæœ¬äº‹ä»¶è™•ç†**:
```dart
// âœ… Layer 2: è™•ç† UI äº‹ä»¶ï¼Œå”èª¿ UseCase
class BookDetailController {
  final AddBookToFavoriteUseCase addToFavoriteUseCase;

  BookDetailController({required this.addToFavoriteUseCase});

  String bookTitle = '';
  bool isLoading = false;

  // äº‹ä»¶è™•ç†é‚è¼¯
  Future<void> onAddToFavorite() async {
    isLoading = true;
    notifyListeners();

    // å‘¼å« UseCase
    final result = await addToFavoriteUseCase.execute(bookId);

    // è™•ç†çµæœä¸¦æ›´æ–° UI ç‹€æ…‹
    isLoading = false;
    if (result.isSuccess) {
      showSuccessMessage('å·²åŠ å…¥æ”¶è—');
    } else {
      showErrorMessage(result.error);
    }
    notifyListeners();
  }
}
```

**ç¯„ä¾‹ 2: Presenter è³‡æ–™è½‰æ›** (ä¿®æ­£ #1):
```dart
// âœ… Layer 2: Presenter è² è²¬è³‡æ–™è½‰æ›
class BookDetailController {
  final GetBookDetailUseCase getBookDetailUseCase;

  // ViewModel ç”¨æ–¼ UI é¡¯ç¤º
  BookViewModel? bookViewModel;

  Future<void> loadBookDetail(String bookId) async {
    final result = await getBookDetailUseCase.execute(bookId);

    if (result.isSuccess) {
      // Layer 2 è² è²¬è½‰æ› Domain Entity â†’ ViewModel
      bookViewModel = BookPresenter.toViewModel(result.data);
      notifyListeners();
    }
  }
}

// Presenter é¡åˆ¥
class BookPresenter {
  static BookViewModel toViewModel(Book book) {
    return BookViewModel(
      title: book.title.value,
      author: book.author.name,
      publishYear: book.publicationDate.year.toString(),
      isNew: book.isNewRelease(), // å‘¼å« Domain æ–¹æ³•
    );
  }
}

// ViewModel å®šç¾©
class BookViewModel {
  final String title;
  final String author;
  final String publishYear;
  final bool isNew;

  BookViewModel({
    required this.title,
    required this.author,
    required this.publishYear,
    required this.isNew,
  });
}
```

**ç¯„ä¾‹ 3: éŒ¯èª¤è™•ç†è½‰æ›** (ä¿®æ­£ #2):
```dart
// âœ… Layer 2: æ•æ‰ Domain éŒ¯èª¤ä¸¦è½‰æ›ç‚º UI å¯ç†è§£çš„æ ¼å¼
class BookSearchController {
  Future<void> searchBook(String isbn) async {
    try {
      final book = await searchBookUseCase.execute(isbn);
      bookViewModel = BookPresenter.toViewModel(book);
    } on BookNotFoundException catch (e) {
      // è½‰æ›ç‚º ErrorViewModel
      errorViewModel = ErrorViewModel(
        title: 'æ‰¾ä¸åˆ°æ›¸ç±',
        message: 'æŸ¥ç„¡ ISBN: ${e.isbn} çš„æ›¸ç±è³‡æ–™',
        errorCode: 'BOOK_NOT_FOUND',
        actionText: 'é‡æ–°æœå°‹',
      );
    } on NetworkException catch (e) {
      errorViewModel = ErrorViewModel(
        title: 'ç¶²è·¯éŒ¯èª¤',
        message: 'è«‹æª¢æŸ¥ç¶²è·¯é€£ç·š',
        errorCode: 'NETWORK_ERROR',
        actionText: 'é‡è©¦',
      );
    }
    notifyListeners();
  }
}
```

**Presenter/DTO è½‰æ›è·è²¬åˆ¤æ–·**:
- å¦‚æœè½‰æ›ç›®çš„æ˜¯ç‚ºäº† UI é¡¯ç¤º â†’ Layer 2
- å¦‚æœè½‰æ›æ˜¯æ¥­å‹™æµç¨‹çš„ä¸€éƒ¨åˆ†ï¼ˆè·¨ Domain è³‡æ–™æ•´åˆï¼‰â†’ Layer 3

**éŒ¯èª¤è™•ç†çš„ä¸‰éšæ®µæµç¨‹** (ä¿®æ­£ #2):

**Layer 5 (Domain) - æ‹‹å‡ºéŒ¯èª¤**:
```dart
// Domain æ‹‹å‡ºå…·é«”çš„æ¥­å‹™éŒ¯èª¤
class BookService {
  Book getBookByIsbn(String isbn) {
    if (!_repository.exists(isbn)) {
      throw BookNotFoundException(
        isbn: isbn,
        message: 'Book with ISBN $isbn not found',
      );
    }
    return _repository.findByIsbn(isbn);
  }
}
```

**Layer 2 (Behavior) - è½‰æ›éŒ¯èª¤**: ï¼ˆè¦‹ä¸Šæ–¹ç¯„ä¾‹ 3ï¼‰

**Layer 1 (UI) - é¡¯ç¤ºéŒ¯èª¤**:
```dart
// Widget åªè² è²¬é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
class BookSearchPage extends StatelessWidget {
  Widget build(BuildContext context) {
    if (controller.errorViewModel != null) {
      return ErrorDialog(
        title: controller.errorViewModel!.title,
        message: controller.errorViewModel!.message,
        actionText: controller.errorViewModel!.actionText,
        onAction: controller.retry,
      );
    }
    // ... æ­£å¸¸ UI
  }
}
```

---

#### Layer 3: UseCaseï¼ˆæ¥­å‹™æµç¨‹å±¤ï¼‰

**è·è²¬ç¯„åœ**:
- **æ¥­å‹™æµç¨‹ç·¨æ’**: å”èª¿å¤šå€‹ Domain Services æˆ– Repository
- **è³‡æ–™æ•´åˆ**: è·¨ Domain çš„è³‡æ–™æ•´åˆå’Œè½‰æ›
- **éŒ¯èª¤è™•ç†**: çµ±ä¸€è™•ç†æ¥­å‹™éŒ¯èª¤å’Œç•°å¸¸
- **äº‹ä»¶ç™¼å¸ƒ**: ç™¼å¸ƒ Domain Events

**ä¸è² è²¬**:
- âŒ UI é‚è¼¯ï¼ˆå±¬æ–¼ Layer 2ï¼‰
- âŒ æ ¸å¿ƒæ¥­å‹™è¦å‰‡ï¼ˆå±¬æ–¼ Layer 5ï¼‰
- âŒ è³‡æ–™æŒä¹…åŒ–ç´°ç¯€ï¼ˆå±¬æ–¼ Infrastructureï¼‰

**Flutter å°æ‡‰**:
- `UseCase` é¡åˆ¥ï¼ˆå¦‚ `AddBookToFavoriteUseCase`ï¼‰
- `execute()` æ–¹æ³•ï¼ˆåŸ·è¡Œæ¥­å‹™æµç¨‹ï¼‰

**åˆ¤æ–·æ¨™æº–**:
- **è®Šæ›´åŸå› **: å› ç‚ºã€Œæ¥­å‹™æµç¨‹è®Šæ›´ã€æˆ–ã€Œç·¨æ’é‚è¼¯è®Šæ›´ã€è€Œä¿®æ”¹
- **æ¸¬è©¦é¡å‹**: UseCase æ¸¬è©¦ï¼ˆé©—è­‰æ¥­å‹™æµç¨‹æ­£ç¢ºæ€§ï¼‰
- **ä¾è³´æ–¹å‘**: ä¾è³´ Layer 4 çš„ä»‹é¢ï¼ˆRepository Interface, Event Interfaceï¼‰

**ç¯„ä¾‹**:
```dart
// âœ… Layer 3: æ¥­å‹™æµç¨‹ç·¨æ’
class AddBookToFavoriteUseCase {
  final IBookRepository bookRepository;
  final IFavoriteRepository favoriteRepository;
  final IEventBus eventBus;

  AddBookToFavoriteUseCase({
    required this.bookRepository,
    required this.favoriteRepository,
    required this.eventBus,
  });

  Future<OperationResult<void>> execute(String bookId) async {
    try {
      // 1. æª¢æŸ¥æ›¸ç±æ˜¯å¦å­˜åœ¨ï¼ˆå”èª¿å¤šå€‹ Repositoryï¼‰
      final bookResult = await bookRepository.findById(bookId);
      if (!bookResult.isSuccess) {
        return OperationResult.failure('æ›¸ç±ä¸å­˜åœ¨');
      }

      // 2. æª¢æŸ¥æ˜¯å¦å·²æ”¶è—
      final isFavorited = await favoriteRepository.contains(bookId);
      if (isFavorited) {
        return OperationResult.failure('å·²åŠ å…¥æ”¶è—');
      }

      // 3. åŸ·è¡Œæ”¶è—æ“ä½œ
      await favoriteRepository.add(bookId);

      // 4. ç™¼å¸ƒäº‹ä»¶
      eventBus.publish(BookFavoritedEvent(bookId: bookId));

      return OperationResult.success(null);
    } catch (e) {
      return OperationResult.failure('æ“ä½œå¤±æ•—: $e');
    }
  }
}
```

---

#### Layer 4: Domain Events/Interfacesï¼ˆé ˜åŸŸäº‹ä»¶èˆ‡ä»‹é¢å±¤ï¼‰

**è·è²¬ç¯„åœ**:
- **äº‹ä»¶å®šç¾©**: å®šç¾© Domain Events çš„çµæ§‹å’Œèªæ„
- **ä»‹é¢å¥‘ç´„**: å®šç¾© Repository, Service çš„æŠ½è±¡ä»‹é¢
- **DTO å®šç¾©**: å®šç¾©è·¨å±¤å‚³è¼¸çš„è³‡æ–™çµæ§‹
- **å”è­°è¦ç¯„**: å®šç¾©å¤–éƒ¨ç³»çµ±æ•´åˆçš„å”è­°

**ä¸è² è²¬**:
- âŒ ä»‹é¢å¯¦ä½œï¼ˆå±¬æ–¼ Infrastructureï¼‰
- âŒ äº‹ä»¶è™•ç†é‚è¼¯ï¼ˆå±¬æ–¼ Layer 3 æˆ– Layer 5ï¼‰
- âŒ æ ¸å¿ƒæ¥­å‹™è¦å‰‡ï¼ˆå±¬æ–¼ Layer 5ï¼‰

**Flutter å°æ‡‰**:
- `abstract class` å®šç¾©çš„ä»‹é¢ï¼ˆå¦‚ `IBookRepository`ï¼‰
- `Event` é¡åˆ¥ï¼ˆå¦‚ `BookFavoritedEvent`ï¼‰
- `DTO` é¡åˆ¥ï¼ˆå¦‚ `BookDto`ï¼‰

**åˆ¤æ–·æ¨™æº–**:
- **è®Šæ›´åŸå› **: å› ç‚ºã€Œå¥‘ç´„å®šç¾©è®Šæ›´ã€æˆ–ã€Œäº‹ä»¶çµæ§‹è®Šæ›´ã€è€Œä¿®æ”¹
- **æ¸¬è©¦é¡å‹**: ä»‹é¢æ¸¬è©¦ï¼ˆé©—è­‰å¥‘ç´„å®Œæ•´æ€§ï¼‰
- **ä¾è³´æ–¹å‘**: è¢« Layer 3 ä¾è³´ï¼Œä¸ä¾è³´ä»»ä½•å±¤ç´š

**ç¯„ä¾‹**:
```dart
// âœ… Layer 4: ä»‹é¢å¥‘ç´„å®šç¾©
abstract class IBookRepository {
  Future<OperationResult<Book>> findById(String id);
  Future<OperationResult<void>> save(Book book);
  Future<OperationResult<void>> delete(String id);
}

// âœ… Layer 4: äº‹ä»¶å®šç¾©
class BookFavoritedEvent {
  final String bookId;
  final DateTime timestamp;

  BookFavoritedEvent({
    required this.bookId,
    DateTime? timestamp,
  }) : timestamp = timestamp ?? DateTime.now();
}
```

---

#### Layer 5: Domain Implementationï¼ˆé ˜åŸŸå¯¦ä½œå±¤ï¼‰

**è·è²¬ç¯„åœ**:

- **æ ¸å¿ƒæ¥­å‹™é‚è¼¯**: Entities, Aggregates, Value Objects
- **æ¥­å‹™è¦å‰‡**: Business Invariants, Domain Validations
- **Domain Services**: è¤‡é›œæ¥­å‹™é‚è¼¯çš„å°è£
- **æ¥­å‹™è¨ˆç®—**: æ¥­å‹™ç›¸é—œçš„è¨ˆç®—å’Œæ¨å°

**ä¸è² è²¬**:

- âŒ è³‡æ–™æŒä¹…åŒ–ï¼ˆå±¬æ–¼ Infrastructureï¼‰
- âŒ UI é‚è¼¯ï¼ˆå±¬æ–¼ Layer 2ï¼‰
- âŒ æµç¨‹ç·¨æ’ï¼ˆå±¬æ–¼ Layer 3ï¼‰

**Flutter å°æ‡‰**:

- `Entity` é¡åˆ¥ï¼ˆå¦‚ `Book`, `Favorite`ï¼‰
- `Value Object` é¡åˆ¥ï¼ˆå¦‚ `ISBN`, `Title`ï¼‰
- `Domain Service` é¡åˆ¥

**åˆ¤æ–·æ¨™æº–**:

- **è®Šæ›´åŸå› **: å› ç‚ºã€Œæ ¸å¿ƒæ¥­å‹™è¦å‰‡è®Šæ›´ã€è€Œä¿®æ”¹
- **æ¸¬è©¦é¡å‹**: Domain æ¸¬è©¦ï¼ˆé©—è­‰æ¥­å‹™è¦å‰‡æ­£ç¢ºæ€§ï¼‰
- **ä¾è³´æ–¹å‘**: ä¸ä¾è³´ä»»ä½•å±¤ç´šï¼ˆæœ€å…§å±¤ï¼‰

**ç¯„ä¾‹**:
```dart
// âœ… Layer 5: æ ¸å¿ƒæ¥­å‹™é‚è¼¯
class Book {
  final ISBN isbn;
  final Title title;
  final Author author;
  final PublicationDate publicationDate;

  Book({
    required this.isbn,
    required this.title,
    required this.author,
    required this.publicationDate,
  }) {
    _validate();
  }

  // æ¥­å‹™ä¸è®Šé‡é©—è­‰
  void _validate() {
    if (!isbn.isValid()) {
      throw ValidationException('ISBN æ ¼å¼ç„¡æ•ˆ');
    }
    if (title.isEmpty) {
      throw ValidationException('æ›¸åä¸å¯ç‚ºç©º');
    }
  }

  // æ¥­å‹™è¦å‰‡ï¼šåˆ¤æ–·æ˜¯å¦ç‚ºæ–°æ›¸
  bool isNewRelease() {
    final now = DateTime.now();
    final monthsSincePublish = now.difference(publicationDate.value).inDays / 30;
    return monthsSincePublish <= 6;
  }
}
```

---

### 2.3 å±¤ç´šé–“ä¾è³´é—œä¿‚å’Œä¾è³´æ–¹å‘

**ä¾è³´æ–¹å‘è¦å‰‡**:
```text
Layer 1 (UI)
  â†“ ä¾è³´
Layer 2 (Behavior)
  â†“ ä¾è³´
Layer 3 (UseCase)
  â†“ ä¾è³´
Layer 4 (Domain Events/Interfaces)
  â†‘ å¯¦ä½œ
Layer 5 (Domain Implementation)

é—œéµè¦å‰‡ï¼š
1. å¤–å±¤ä¾è³´å…§å±¤ï¼Œå…§å±¤ä¸ä¾è³´å¤–å±¤
2. Layer 4 æ˜¯ä»‹é¢å±¤ï¼ŒLayer 5 å¯¦ä½œé€™äº›ä»‹é¢
3. Layer 3 åªä¾è³´ Layer 4 çš„æŠ½è±¡ä»‹é¢ï¼Œä¸ä¾è³´ Layer 5 çš„å…·é«”å¯¦ä½œ
4. æ‰€æœ‰ä¾è³´éƒ½é€šéä»‹é¢ï¼ˆDependency Inversion Principleï¼‰
```

**é•åä¾è³´æ–¹å‘çš„ç¯„ä¾‹**:
```dart
// âŒ éŒ¯èª¤ï¼šLayer 5 (Domain) ä¾è³´ Layer 3 (UseCase)
class Book {
  final AddBookToFavoriteUseCase favoriteUseCase; // âŒ Domain ä¸æ‡‰è©²ä¾è³´ UseCase

  Future<void> addToFavorite() async {
    await favoriteUseCase.execute(this.id);
  }
}

// âœ… æ­£ç¢ºï¼šLayer 5 (Domain) ç™¼å¸ƒäº‹ä»¶ï¼Œç”± Layer 3 è™•ç†
class Book {
  void addToFavorite() {
    // Domain åªè¨˜éŒ„ç‹€æ…‹è®Šæ›´ï¼Œä¸åŸ·è¡Œæ“ä½œ
    this.isFavorited = true;
  }
}
```

---

### 2.4 åˆ¤æ–·ã€Œç¨‹å¼ç¢¼å±¬æ–¼å“ªä¸€å±¤ã€çš„æ±ºç­–æ¨¹

**å®Œæ•´æ±ºç­–æ¨¹**ï¼ˆåŒ…å« Infrastructure å±¤ï¼‰(ä¿®æ­£ #3):

```text
äº”å±¤æ¶æ§‹ + Infrastructure å±¤æ±ºç­–æ¨¹ï¼š

1. é€™æ®µç¨‹å¼ç¢¼æ˜¯å¦ã€Œæ¸²æŸ“ UI å…ƒç´ ã€ï¼Ÿ
   - æ¸²æŸ“ Widgetã€Component
   - å®šç¾© UI ä½ˆå±€çµæ§‹
   â”œâ”€ æ˜¯ â†’ Layer 1 (UI/Presentation)
   â””â”€ å¦ â†’ ç¹¼çºŒ

2. é€™æ®µç¨‹å¼ç¢¼æ˜¯å¦ã€Œè™•ç† UI äº‹ä»¶ã€æˆ–ã€Œæ§åˆ¶ UI ç‹€æ…‹ã€æˆ–ã€Œè½‰æ›è³‡æ–™çµ¦ UI ä½¿ç”¨ã€ï¼Ÿ
   - è™•ç† UI äº‹ä»¶: é»æ“Šã€è¼¸å…¥ã€æ‰‹å‹¢
   - æ§åˆ¶ UI ç‹€æ…‹: Loadingã€Errorã€Success
   - è½‰æ›è³‡æ–™: Domain Entity â†’ ViewModel, Domain Exception â†’ ErrorViewModel
   â”œâ”€ æ˜¯ â†’ Layer 2 (Application/Behavior)
   â””â”€ å¦ â†’ ç¹¼çºŒ

3. é€™æ®µç¨‹å¼ç¢¼æ˜¯å¦ã€Œå”èª¿å¤šå€‹ Domain Servicesã€æˆ–ã€Œç·¨æ’æ¥­å‹™æµç¨‹ã€ï¼Ÿ
   - å”èª¿å¤šå€‹ Repository æˆ– Service
   - ç·¨æ’æ¥­å‹™æµç¨‹æ­¥é©Ÿ
   - ç™¼å¸ƒ Domain Events
   â”œâ”€ æ˜¯ â†’ Layer 3 (UseCase)
   â””â”€ å¦ â†’ ç¹¼çºŒ

4. é€™æ®µç¨‹å¼ç¢¼æ˜¯å¦ã€Œå®šç¾©ä»‹é¢å¥‘ç´„ã€æˆ–ã€Œå®šç¾©äº‹ä»¶çµæ§‹ã€ï¼Ÿ
   - å®šç¾© Repository Interface
   - å®šç¾© Domain Event çµæ§‹
   - å®šç¾© DTO æˆ– Value Object ä»‹é¢
   â”œâ”€ æ˜¯ â†’ Layer 4 (Domain Events/Interfaces)
   â””â”€ å¦ â†’ ç¹¼çºŒ

5. é€™æ®µç¨‹å¼ç¢¼æ˜¯å¦ã€Œå¯¦ä½œæ ¸å¿ƒæ¥­å‹™è¦å‰‡ã€æˆ–ã€Œå®šç¾©æ¥­å‹™å¯¦é«”ã€ï¼Ÿ
   - å®šç¾© Entity æˆ– Aggregate
   - å¯¦ä½œæ¥­å‹™è¦å‰‡é©—è­‰
   - å¯¦ä½œ Domain Service
   â”œâ”€ æ˜¯ â†’ Layer 5 (Domain Implementation)
   â””â”€ å¦ â†’ Infrastructure å±¤

Infrastructure å±¤ï¼ˆä¸åœ¨äº”å±¤æ¶æ§‹è¨è«–ç¯„åœå…§ï¼‰:
- è³‡æ–™æŒä¹…åŒ–å¯¦ä½œï¼ˆSqliteBookRepository, SharedPreferencesCacheï¼‰
- ç¬¬ä¸‰æ–¹ API æ•´åˆï¼ˆGoogleBooksApiClient, RestClientï¼‰
- æŠ€è¡“åŸºç¤è¨­æ–½ï¼ˆEventBusImpl, LoggerImpl, HttpClientï¼‰
- æ¡†æ¶ç‰¹å®šå¯¦ä½œï¼ˆFlutterSecureStorage, SharedPreferencesï¼‰
```

**Infrastructure å±¤èªªæ˜** (ä¿®æ­£ #3):

**ç‚ºä»€éº¼ Infrastructure å±¤ä¸ç´å…¥å±¤ç´šéš”é›¢è¨è«–ï¼Ÿ**

1. **æŠ€è¡“å¯¦ä½œç´°ç¯€ vs æ¥­å‹™é‚è¼¯**:
   - Infrastructure å±¤è™•ç†æŠ€è¡“å¯¦ä½œï¼ˆè³‡æ–™åº«ã€ç¶²è·¯ã€å¿«å–ï¼‰
   - äº”å±¤æ¶æ§‹å°ˆæ³¨æ–¼æ¥­å‹™é‚è¼¯çš„å±¤ç´šåŠƒåˆ†
   - å…©è€…çš„è®Šæ›´é©…å‹•å› ç´ ä¸åŒ

2. **è®Šæ›´æ¨¡å¼å·®ç•°**:
   - Infrastructure: æŠ€è¡“é©…å‹•ï¼ˆå‡ç´šå¥—ä»¶ã€æ•ˆèƒ½å„ªåŒ–ï¼‰
   - äº”å±¤æ¶æ§‹: éœ€æ±‚é©…å‹•ï¼ˆåŠŸèƒ½è®Šæ›´ã€æ¥­å‹™è¦å‰‡èª¿æ•´ï¼‰

3. **Ticket è¨­è¨ˆæ¨¡å¼**:
   - Infrastructure å±¤é€šå¸¸æ˜¯ç¨ç«‹çš„æŠ€è¡“ä»»å‹™
   - ä¾‹å¦‚ï¼šã€Œå‡ç´š SQLite åˆ° v3.0ã€ã€ã€Œå¯¦ä½œ Redis å¿«å–ã€
   - å¾ˆå°‘èˆ‡æ¥­å‹™é‚è¼¯å±¤ç´šæ··åˆä¿®æ”¹

4. **æ¸¬è©¦ç­–ç•¥å·®ç•°**:
   - Infrastructure: æ•´åˆæ¸¬è©¦ã€æ•ˆèƒ½æ¸¬è©¦
   - äº”å±¤æ¶æ§‹: å–®å…ƒæ¸¬è©¦ã€è¡Œç‚ºæ¸¬è©¦ã€Widget æ¸¬è©¦

**Infrastructure å±¤çš„å…¸å‹è·è²¬**:
- **è³‡æ–™æŒä¹…åŒ–**: Repository å¯¦ä½œï¼ˆSqliteBookRepositoryï¼‰
- **ç¬¬ä¸‰æ–¹æ•´åˆ**: API Clientï¼ˆGoogleBooksApiClientï¼‰
- **å¿«å–ç®¡ç†**: Cache å¯¦ä½œï¼ˆBookCacheManagerï¼‰
- **æ—¥èªŒè¨˜éŒ„**: Logger å¯¦ä½œ
- **EventBus å¯¦ä½œ**: EventBusImpl

**Infrastructure å±¤ Ticket ç¯„ä¾‹**:
```markdown
### Ticket: å¯¦ä½œ SQLite Book Repository

**å±¤ç´šå®šä½**: Infrastructureï¼ˆæŠ€è¡“å¯¦ä½œï¼‰

**è®Šæ›´ç¯„åœ**:
- æª”æ¡ˆ: `lib/infrastructure/repositories/sqlite_book_repository.dart`
- å¯¦ä½œ: IBookRepository ä»‹é¢

**é©—æ”¶æ¢ä»¶**:
- [ ] å¯¦ä½œæ‰€æœ‰ Repository ä»‹é¢æ–¹æ³•
- [ ] é€šéæ•´åˆæ¸¬è©¦ï¼ˆå¯¦éš›è³‡æ–™åº«æ“ä½œï¼‰
- [ ] æ•ˆèƒ½ç¬¦åˆæ¨™æº–ï¼ˆæŸ¥è©¢ < 100msï¼‰

**æ¸¬è©¦ç¯„åœ**: æ•´åˆæ¸¬è©¦ï¼ˆçœŸå¯¦è³‡æ–™åº«ï¼‰
```

---

## ç¬¬ä¸‰ç« ï¼šå–®å±¤ä¿®æ”¹åŸå‰‡

### 3.1 å–®å±¤ä¿®æ”¹åŸå‰‡å®šç¾©

**æ ¸å¿ƒåŸå‰‡**:
> ä¸€å€‹ Ticket åªæ‡‰è©²ä¿®æ”¹å–®ä¸€æ¶æ§‹å±¤ç´šçš„ç¨‹å¼ç¢¼ï¼Œè®Šæ›´çš„åŸå› å–®ä¸€ä¸”æ˜ç¢ºã€‚

**æ­£å¼å®šç¾©**:
- **å–®å±¤ä¿®æ”¹** = æ‰€æœ‰ç¨‹å¼ç¢¼è®Šæ›´éƒ½é›†ä¸­åœ¨åŒä¸€å€‹ Clean Architecture å±¤ç´š
- **è®Šæ›´åŸå› å–®ä¸€** = ç¬¦åˆ Single Responsibility Principleï¼ˆSRPï¼‰
- **æ¸¬è©¦ç¯„åœé™å®š** = æ¸¬è©¦åªé©—è­‰è©²å±¤ç´šçš„è·è²¬

**ç‚ºä»€éº¼è¦å–®å±¤ä¿®æ”¹**:
1. **é™ä½è®Šæ›´é¢¨éšª**: è®Šæ›´å½±éŸ¿ç¯„åœæœ€å°åŒ–ï¼Œæ¸›å°‘ç ´å£å…¶ä»–å±¤ç´šçš„å¯èƒ½æ€§
2. **æå‡æ¸¬è©¦ç¨ç«‹æ€§**: æ¯å±¤éƒ½å¯ä»¥ç¨ç«‹æ¸¬è©¦ï¼Œä¸éœ€è¦å•Ÿå‹•æ•´å€‹ç³»çµ±
3. **ç¬¦åˆ SRP**: æ¯å€‹ Ticket åªæœ‰ä¸€å€‹ä¿®æ”¹çš„ç†ç”±
4. **å¿«é€Ÿé©—è­‰å¾ªç’°**: ä¿®æ”¹å¾Œå¯ä»¥ç«‹å³é©—è­‰è©²å±¤ç´šçš„æ­£ç¢ºæ€§
5. **ä¾¿æ–¼ Code Review**: å¯©æŸ¥è€…åªéœ€è¦é—œæ³¨å–®ä¸€å±¤ç´šçš„é‚è¼¯

### 3.2 ç†è«–ä¾æ“š

**Single Responsibility Principle (SRP)**:
- **å®šç¾©**: ä¸€å€‹é¡åˆ¥æˆ–æ¨¡çµ„æ‡‰è©²åªæœ‰ä¸€å€‹ä¿®æ”¹çš„ç†ç”±
- **æ‡‰ç”¨**: ä¸€å€‹ Ticket æ‡‰è©²åªæœ‰ä¸€å€‹ä¿®æ”¹çš„ç†ç”±ï¼ˆå°æ‡‰å–®ä¸€å±¤ç´šçš„è·è²¬ï¼‰

**Dependency Inversion Principle (DIP)**:
- **å®šç¾©**: é«˜å±¤æ¨¡çµ„ä¸æ‡‰è©²ä¾è³´ä½å±¤æ¨¡çµ„ï¼Œå…©è€…éƒ½æ‡‰è©²ä¾è³´æŠ½è±¡
- **æ‡‰ç”¨**: ä¿®æ”¹å…§å±¤æ™‚ä¸å½±éŸ¿å¤–å±¤ï¼Œä¿®æ”¹å¤–å±¤æ™‚ä¸å½±éŸ¿å…§å±¤

**Separation of Concerns (SoC)**:
- **å®šç¾©**: ä¸åŒçš„é—œæ³¨é»æ‡‰è©²åˆ†é›¢åˆ°ä¸åŒçš„æ¨¡çµ„
- **æ‡‰ç”¨**: è¦–è¦ºå‘ˆç¾ï¼ˆLayer 1ï¼‰ã€äº‹ä»¶è™•ç†ï¼ˆLayer 2ï¼‰ã€æ¥­å‹™æµç¨‹ï¼ˆLayer 3ï¼‰æ‡‰è©²åˆ†é›¢

### 3.3 å–®å±¤ä¿®æ”¹åˆ¤æ–·æ¨™æº–

**æª¢æŸ¥æ¸…å–®**:
- [ ] æ­¤ Ticket çš„æ‰€æœ‰ç¨‹å¼ç¢¼ä¿®æ”¹éƒ½åœ¨åŒä¸€å€‹æ¶æ§‹å±¤ç´šï¼Ÿ
- [ ] è®Šæ›´çš„åŸå› æ˜¯å¦å–®ä¸€ä¸”æ˜ç¢ºï¼ˆåªå› ç‚ºè©²å±¤ç´šçš„è·è²¬è®Šæ›´ï¼‰ï¼Ÿ
- [ ] æ¸¬è©¦ç¯„åœæ˜¯å¦é™å®šåœ¨è©²å±¤ç´šï¼ˆä¸éœ€è¦å•Ÿå‹•å…¶ä»–å±¤ç´šï¼‰ï¼Ÿ
- [ ] æ˜¯å¦å¯ä»¥ç¨ç«‹é©—æ”¶è€Œä¸ä¾è³´å…¶ä»–å±¤ç´šçš„å®Œæˆï¼Ÿ
- [ ] ä¿®æ”¹è©²å±¤ç´šæ™‚ï¼Œå…¶ä»–å±¤ç´šæ˜¯å¦ä¸éœ€è¦åŒæ­¥ä¿®æ”¹ï¼Ÿ

**åˆ¤æ–·æµç¨‹**:
```text
æ­¥é©Ÿ 1: åˆ—å‡ºæ­¤ Ticket æ¶‰åŠçš„æ‰€æœ‰æª”æ¡ˆ
æ­¥é©Ÿ 2: åˆ¤æ–·æ¯å€‹æª”æ¡ˆå±¬æ–¼å“ªä¸€å€‹å±¤ç´š
æ­¥é©Ÿ 3: æª¢æŸ¥æ˜¯å¦æ‰€æœ‰æª”æ¡ˆéƒ½å±¬æ–¼åŒä¸€å±¤ç´š
  â”œâ”€ æ˜¯ â†’ ç¬¦åˆå–®å±¤ä¿®æ”¹åŸå‰‡ âœ…
  â””â”€ å¦ â†’ é•åå–®å±¤ä¿®æ”¹åŸå‰‡ âŒ
æ­¥é©Ÿ 4: å¦‚æœé•åï¼Œåˆ†ææ˜¯å¦å¯ä»¥æ‹†åˆ†ç‚ºå¤šå€‹ Ticket
  â”œâ”€ å¯æ‹†åˆ† â†’ é‡æ–°è¨­è¨ˆ Ticket
  â””â”€ ä¸å¯æ‹†åˆ† â†’ æª¢æŸ¥æ¶æ§‹è¨­è¨ˆæ˜¯å¦æœ‰å•é¡Œ
```

### 3.4 é•åå–®å±¤ä¿®æ”¹çš„å¸¸è¦‹æ¨¡å¼

**æ¨¡å¼ 1: Shotgun Surgeryï¼ˆæ•£å½ˆæ§æ‰‹è¡“ï¼‰**
```text
å•é¡Œï¼šä¸€å€‹å°è®Šæ›´éœ€è¦åŒæ™‚ä¿®æ”¹å¤šå€‹å±¤ç´š
ç¯„ä¾‹ï¼šæ–°å¢ä¸€å€‹æ¬„ä½éœ€è¦ä¿®æ”¹ UIã€Controllerã€UseCaseã€Entity

åŸå› ï¼šå±¤ç´šé–“è€¦åˆéç·Šï¼Œç¼ºä¹æŠ½è±¡ä»‹é¢
è§£æ±ºï¼šå¼•å…¥ DTO æˆ– Adapter å±¤ï¼Œéš”é›¢å±¤ç´šé–“çš„ä¾è³´
```

**æ¨¡å¼ 2: Feature Envyï¼ˆåŠŸèƒ½å«‰å¦’ï¼‰**
```text
å•é¡Œï¼šä¸€å€‹å±¤ç´šéåº¦ä¾è³´å¦ä¸€å€‹å±¤ç´šçš„å…§éƒ¨ç´°ç¯€
ç¯„ä¾‹ï¼šUI å±¤ç›´æ¥å­˜å– Domain Entity çš„å…§éƒ¨æ¬„ä½

åŸå› ï¼šç¼ºä¹é©ç•¶çš„è³‡æ–™è½‰æ›å±¤
è§£æ±ºï¼šå¼•å…¥ ViewModel æˆ– Presenterï¼Œè½‰æ› Domain è³‡æ–™ç‚º UI è³‡æ–™
```

**æ¨¡å¼ 3: Divergent Changeï¼ˆç™¼æ•£å¼è®Šæ›´ï¼‰**
```text
å•é¡Œï¼šä¸åŒåŸå› çš„è®Šæ›´éƒ½é›†ä¸­åœ¨åŒä¸€å±¤ç´šçš„åŒä¸€å€‹é¡åˆ¥
ç¯„ä¾‹ï¼šBookController åŒæ™‚è² è²¬åˆ—è¡¨é¡¯ç¤ºå’Œè©³æƒ…é¡¯ç¤º

åŸå› ï¼šé•å SRPï¼Œå–®ä¸€é¡åˆ¥æ‰¿æ“”å¤šå€‹è·è²¬
è§£æ±ºï¼šæ‹†åˆ†ç‚º BookListController å’Œ BookDetailController
```

---

## ç¬¬å››ç« ï¼šå¯¦ä½œé †åºæŒ‡å¼•ï¼ˆå¾å¤–è€Œå…§ï¼‰

### 4.1 ç‚ºä»€éº¼å¾å¤–è€Œå…§å¯¦ä½œï¼Ÿ

**å‚³çµ±æ€ç¶­ï¼ˆå¾å…§è€Œå¤–ï¼‰**:
```text
è¨­è¨ˆæ€è€ƒï¼šDomain â†’ UseCase â†’ UI
ç†ç”±ï¼šå…ˆå®šç¾©æ ¸å¿ƒæ¥­å‹™é‚è¼¯ï¼Œå†å¾€å¤–æ“´å±•

å•é¡Œï¼š
- éæ—©è¨­è¨ˆï¼šå…§å±¤è¨­è¨ˆå¯èƒ½éåº¦å·¥ç¨‹åŒ–
- éœ€æ±‚åå·®ï¼šå¯¦ä½œåˆ° UI æ™‚æ‰ç™¼ç¾ Domain è¨­è¨ˆä¸ç¬¦éœ€æ±‚
- æ¸¬è©¦å›°é›£ï¼šå…§å±¤å®Œæˆå‰ï¼Œå¤–å±¤ç„¡æ³•æ¸¬è©¦
```

**å„ªåŒ–æ€ç¶­ï¼ˆå¾å¤–è€Œå…§ï¼‰**:
```text
å¯¦ä½œé †åºï¼šUI â†’ Behavior â†’ UseCase â†’ Domain Events â†’ Domain
ç†ç”±ï¼šå¾æœ€å°å½±éŸ¿ç¯„åœé–‹å§‹ï¼Œé€æ­¥æ·±å…¥æ ¸å¿ƒ

å„ªå‹¢ï¼š
- å½±éŸ¿ç¯„åœéå¢ï¼šå…ˆæ”¹ UI å½±éŸ¿æœ€å°ï¼Œæœ€å¾Œæ”¹ Domain å½±éŸ¿æœ€å¤§
- éœ€æ±‚é©—è­‰ï¼šåŠæ—©ç™¼ç¾éœ€æ±‚åå·®ï¼Œèª¿æ•´æˆæœ¬ä½
- å¿«é€Ÿè¿­ä»£ï¼šæ¯å±¤å®Œæˆå¾Œç«‹å³å¯ä»¥æ¸¬è©¦é©—è­‰
- é¢¨éšªå¯æ§ï¼šç™¼ç¾å•é¡Œæ™‚å½±éŸ¿ç¯„åœæœ€å°
```

### 4.2 å½±éŸ¿ç¯„åœéå¢åŸå‰‡

**å½±éŸ¿ç¯„åœåˆ†æ**:
```text
Layer 1 (UI) ä¿®æ”¹ â†’ å½±éŸ¿ç¯„åœï¼šè¦–è¦ºå‘ˆç¾
  é¢¨éšªï¼šä½ï¼ˆåªå½±éŸ¿ç•«é¢å¤–è§€ï¼‰
  å›æ»¾æˆæœ¬ï¼šæ¥µä½ï¼ˆé‡æ–°æ¸²æŸ“å³å¯ï¼‰

Layer 2 (Behavior) ä¿®æ”¹ â†’ å½±éŸ¿ç¯„åœï¼šäº’å‹•è¡Œç‚º
  é¢¨éšªï¼šä¸­ä½ï¼ˆå½±éŸ¿å–®ä¸€åŠŸèƒ½çš„äº’å‹•æµç¨‹ï¼‰
  å›æ»¾æˆæœ¬ï¼šä½ï¼ˆé‡æ–°è¨­å®šäº‹ä»¶è™•ç†ï¼‰

Layer 3 (UseCase) ä¿®æ”¹ â†’ å½±éŸ¿ç¯„åœï¼šæ¥­å‹™æµç¨‹
  é¢¨éšªï¼šä¸­ï¼ˆå½±éŸ¿æ¥­å‹™é‚è¼¯ç·¨æ’ï¼‰
  å›æ»¾æˆæœ¬ï¼šä¸­ï¼ˆéœ€é‡æ–°æ¸¬è©¦æ¥­å‹™æµç¨‹ï¼‰

Layer 4 (Domain Events) ä¿®æ”¹ â†’ å½±éŸ¿ç¯„åœï¼šå¥‘ç´„å®šç¾©
  é¢¨éšªï¼šä¸­é«˜ï¼ˆå½±éŸ¿æ‰€æœ‰ä¾è³´æ­¤å¥‘ç´„çš„æ¨¡çµ„ï¼‰
  å›æ»¾æˆæœ¬ï¼šé«˜ï¼ˆéœ€åŒæ­¥ä¿®æ”¹æ‰€æœ‰ä¾è³´æ–¹ï¼‰

Layer 5 (Domain) ä¿®æ”¹ â†’ å½±éŸ¿ç¯„åœï¼šæ ¸å¿ƒæ¥­å‹™è¦å‰‡
  é¢¨éšªï¼šé«˜ï¼ˆå½±éŸ¿æ•´å€‹ç³»çµ±çš„æ¥­å‹™é‚è¼¯ï¼‰
  å›æ»¾æˆæœ¬ï¼šæ¥µé«˜ï¼ˆéœ€é‡æ–°è¨­è¨ˆå’Œæ¸¬è©¦ï¼‰
```

**å¯¦ä½œç­–ç•¥**:
- **å…ˆå¯¦ä½œå½±éŸ¿å°çš„å±¤ç´š**ï¼Œå¿«é€Ÿé©—è­‰éœ€æ±‚
- **å†å¯¦ä½œå½±éŸ¿å¤§çš„å±¤ç´š**ï¼Œç¢ºä¿ç©©å®šæ€§
- **æ¯å±¤å®Œæˆå¾Œç«‹å³æ¸¬è©¦**ï¼ŒåŠæ—©ç™¼ç¾å•é¡Œ

### 4.3 æ¯å±¤çš„é©—è­‰æ™‚æ©Ÿå’Œæ–¹æ³•

**Layer 1 é©—è­‰**:
- **æ™‚æ©Ÿ**: UI å¯¦ä½œå®Œæˆå¾Œ
- **æ–¹æ³•**: Widget æ¸¬è©¦ï¼ˆGolden Test, Screenshot Testï¼‰
- **é©—è­‰å…§å®¹**: è¦–è¦ºå‘ˆç¾ã€ä½ˆå±€ã€æ¨£å¼
- **é€šéæ¨™æº–**: UI ç¬¦åˆè¨­è¨ˆç¨¿ï¼Œç„¡è¦–è¦ºéŒ¯èª¤

**Layer 2 é©—è­‰**:
- **æ™‚æ©Ÿ**: äº‹ä»¶è™•ç†é‚è¼¯å¯¦ä½œå®Œæˆå¾Œ
- **æ–¹æ³•**: è¡Œç‚ºæ¸¬è©¦ï¼ˆæ¨¡æ“¬äº‹ä»¶è§¸ç™¼ï¼‰
- **é©—è­‰å…§å®¹**: äº‹ä»¶è™•ç†ã€ç‹€æ…‹è®Šæ›´ã€UseCase å‘¼å«
- **é€šéæ¨™æº–**: äº‹ä»¶æ­£ç¢ºè§¸ç™¼ï¼Œç‹€æ…‹æ­£ç¢ºæ›´æ–°

**Layer 3 é©—è­‰**:
- **æ™‚æ©Ÿ**: UseCase ç·¨æ’é‚è¼¯å¯¦ä½œå®Œæˆå¾Œ
- **æ–¹æ³•**: UseCase æ¸¬è©¦ï¼ˆMock Repositoryï¼‰
- **é©—è­‰å…§å®¹**: æ¥­å‹™æµç¨‹ã€éŒ¯èª¤è™•ç†ã€äº‹ä»¶ç™¼å¸ƒ
- **é€šéæ¨™æº–**: æ¥­å‹™æµç¨‹æ­£ç¢ºåŸ·è¡Œï¼ŒéŒ¯èª¤æ­£ç¢ºè™•ç†

**Layer 4 é©—è­‰**:
- **æ™‚æ©Ÿ**: ä»‹é¢å¥‘ç´„å®šç¾©å®Œæˆå¾Œ
- **æ–¹æ³•**: ä»‹é¢æ¸¬è©¦ï¼ˆé©—è­‰å¥‘ç´„å®Œæ•´æ€§ï¼‰
- **é©—è­‰å…§å®¹**: ä»‹é¢ç°½åã€äº‹ä»¶çµæ§‹ã€DTO å®šç¾©
- **é€šéæ¨™æº–**: ä»‹é¢å¥‘ç´„å®Œæ•´ä¸”æ˜ç¢º

**Layer 5 é©—è­‰**:
- **æ™‚æ©Ÿ**: Domain é‚è¼¯å¯¦ä½œå®Œæˆå¾Œ
- **æ–¹æ³•**: Domain æ¸¬è©¦ï¼ˆç´”å–®å…ƒæ¸¬è©¦ï¼‰
- **é©—è­‰å…§å®¹**: æ¥­å‹™è¦å‰‡ã€ä¸è®Šé‡ã€è¨ˆç®—é‚è¼¯
- **é€šéæ¨™æº–**: æ¥­å‹™è¦å‰‡æ­£ç¢ºå¯¦ä½œï¼Œä¸è®Šé‡ä¿æŒ

### 4.4 ç‰¹æ®Šå ´æ™¯è™•ç† (ä¿®æ­£ #4)

**å¸¸è¦å ´æ™¯ vs ç‰¹æ®Šå ´æ™¯è­˜åˆ¥**:

**å¸¸è¦å ´æ™¯**ï¼ˆé©ç”¨å¾å¤–è€Œå…§ï¼‰:
- âœ… æ–°å¢å®Œæ•´åŠŸèƒ½ï¼ˆå¦‚ï¼šæ›¸ç±æ”¶è—ï¼‰
- âœ… ä¿®æ”¹ç¾æœ‰åŠŸèƒ½ï¼ˆå¦‚ï¼šæœå°‹å„ªåŒ–ï¼‰
- âœ… ä¸€èˆ¬é‡æ§‹ï¼ˆå¦‚ï¼šæ‹†åˆ† Controllerï¼‰

**ç‰¹æ®Šå ´æ™¯**ï¼ˆéœ€è¦æ›¿ä»£ç­–ç•¥ï¼‰:
- âš ï¸ æ¶æ§‹é·ç§»
- âš ï¸ å®‰å…¨æ€§ä¿®å¾©
- âš ï¸ ç·Šæ€¥ Bug Fixï¼ˆå½±éŸ¿æ ¸å¿ƒæ¥­å‹™è¦å‰‡ï¼‰
- âš ï¸ ç¬¬ä¸‰æ–¹å¥—ä»¶å‡ç´šï¼ˆæ¶‰åŠä»‹é¢è®Šæ›´ï¼‰

---

**ç‰¹æ®Šå ´æ™¯ 1: æ¶æ§‹é·ç§»**

**å•é¡Œæè¿°**: å¾ä¸‰å±¤æ¶æ§‹é·ç§»åˆ°äº”å±¤æ¶æ§‹ï¼Œéœ€è¦å¤§ç¯„åœé‡æ§‹

**ä¸é©ç”¨å¾å¤–è€Œå…§çš„åŸå› **:
- éœ€è¦å…ˆå®šç¾©ä»‹é¢å¥‘ç´„ï¼ˆLayer 4ï¼‰å†å¯¦ä½œ
- å¤–å±¤ä¿®æ”¹ä¾è³´å…§å±¤ä»‹é¢ç©©å®š
- å¤§çˆ†ç‚¸å¼é‡æ§‹é¢¨éšªé«˜

**æ›¿ä»£ç­–ç•¥: Interface-First**
```text
æ­¥é©Ÿ 1: å®šç¾© Layer 4 ä»‹é¢å¥‘ç´„
  - å®šç¾©æ‰€æœ‰ Repository Interface
  - å®šç¾©æ‰€æœ‰ Domain Event çµæ§‹

æ­¥é©Ÿ 2: å¯¦ä½œ Layer 5 Domain é‚è¼¯
  - æå–ç¾æœ‰æ¥­å‹™è¦å‰‡åˆ° Domain Entity
  - å¯¦ä½œ Domain Service

æ­¥é©Ÿ 3: å¯¦ä½œ Layer 3 UseCase
  - åŸºæ–¼ Layer 4 ä»‹é¢ç·¨æ’æ¥­å‹™æµç¨‹
  - ä½¿ç”¨ Mock Repository é€²è¡Œé–‹ç™¼

æ­¥é©Ÿ 4: èª¿æ•´ Layer 2 Behavior
  - ç§»é™¤æ¥­å‹™é‚è¼¯ï¼Œæ”¹ç‚ºå‘¼å« UseCase
  - ä¿æŒäº‹ä»¶è™•ç†è·è²¬

æ­¥é©Ÿ 5: èª¿æ•´ Layer 1 UI
  - ç§»é™¤ç›´æ¥ä¾è³´ Domain çš„éƒ¨åˆ†
  - æ”¹ç‚ºä¾è³´ ViewModel
```

**é¢¨éšªæ§åˆ¶**:
- é›™è»Œä¸¦è¡Œï¼šæ–°åŠŸèƒ½ä½¿ç”¨æ–°æ¶æ§‹ï¼ŒèˆŠåŠŸèƒ½é€æ­¥é·ç§»
- æ¼¸é€²å¼é‡æ§‹ï¼šæ¯é€±é·ç§» 1-2 å€‹æ¨¡çµ„
- æ¸¬è©¦è¦†è“‹ç‡ 100%ï¼šç¢ºä¿é‡æ§‹ä¸ç ´å£åŠŸèƒ½

---

**ç‰¹æ®Šå ´æ™¯ 2: å®‰å…¨æ€§ä¿®å¾©**

**å•é¡Œæè¿°**: ä¿®å¾© Domain å±¤çš„å®‰å…¨æ¼æ´ï¼ˆå¦‚ï¼šå¯†ç¢¼åŠ å¯†ä¸è¶³ï¼‰

**ä¸é©ç”¨å¾å¤–è€Œå…§çš„åŸå› **:
- å®‰å…¨å•é¡Œå¿…é ˆå¾æ ¸å¿ƒä¿®å¾©
- å¤–å±¤èª¿æ•´æ˜¯æ¬¡è¦çš„ï¼ˆé¡¯ç¤ºé‚è¼¯ï¼‰
- æ¥­å‹™è¦å‰‡æ­£ç¢ºæ€§å„ªå…ˆæ–¼ UI è®Šæ›´

**æ›¿ä»£ç­–ç•¥: å¾å…§è€Œå¤–ï¼ˆCore-Firstï¼‰**
```text
æ­¥é©Ÿ 1: ä¿®å¾© Layer 5 Domain å®‰å…¨å•é¡Œ
  - å¼·åŒ–å¯†ç¢¼åŠ å¯†æ¼”ç®—æ³•
  - ä¿®æ­£æ¥­å‹™è¦å‰‡æ¼æ´

æ­¥é©Ÿ 2: æ›´æ–° Layer 4 ä»‹é¢å¥‘ç´„
  - å¦‚æœä»‹é¢ç°½åéœ€è¦èª¿æ•´

æ­¥é©Ÿ 3: èª¿æ•´ Layer 3 UseCase
  - æ›´æ–°å‘¼å«æ–¹å¼ä»¥ç¬¦åˆæ–°ä»‹é¢

æ­¥é©Ÿ 4: èª¿æ•´ Layer 2 Behavior
  - æ›´æ–°éŒ¯èª¤è™•ç†é‚è¼¯

æ­¥é©Ÿ 5: èª¿æ•´ Layer 1 UI
  - æ›´æ–°éŒ¯èª¤è¨Šæ¯é¡¯ç¤ºï¼ˆå¦‚æœéœ€è¦ï¼‰
```

**Ticket è¨­è¨ˆç¯„ä¾‹**:
```markdown
Ticket #1: [Layer 5] ä¿®å¾©å¯†ç¢¼åŠ å¯†å®‰å…¨æ¼æ´
Ticket #2: [Layer 4] æ›´æ–° UserRepository ä»‹é¢
Ticket #3: [Layer 3] èª¿æ•´ RegisterUserUseCase
Ticket #4: [Layer 2] æ›´æ–°è¨»å†ŠéŒ¯èª¤è™•ç†
Ticket #5: [Layer 1] æ›´æ–°è¨»å†ŠéŒ¯èª¤è¨Šæ¯
```

---

**ç‰¹æ®Šå ´æ™¯ 3: ç·Šæ€¥ Bug Fix**

**å ´æ™¯åˆ¤æ–·**:
- å¦‚æœ Bug åœ¨ UI å±¤ï¼ˆæ¸²æŸ“éŒ¯èª¤ï¼‰â†’ å¾å¤–è€Œå…§ âœ…
- å¦‚æœ Bug åœ¨ Domain å±¤ï¼ˆæ¥­å‹™é‚è¼¯éŒ¯èª¤ï¼‰â†’ å¾å…§è€Œå¤– âš ï¸

**åˆ¤æ–·æ¨™æº–**:
```text
æª¢æŸ¥ Bug çš„æ ¹å› ä½æ–¼å“ªä¸€å±¤ï¼š
- Layer 1 Bugï¼ˆUI æ¸²æŸ“ï¼‰â†’ åªä¿® Layer 1
- Layer 2 Bugï¼ˆäº‹ä»¶è™•ç†ï¼‰â†’ åªä¿® Layer 2
- Layer 5 Bugï¼ˆæ¥­å‹™è¦å‰‡ï¼‰â†’ å¾ Layer 5 é–‹å§‹ä¿®ï¼Œå‘å¤–èª¿æ•´
```

---

**ç‰¹æ®Šå ´æ™¯ 4: ç¬¬ä¸‰æ–¹å¥—ä»¶å‡ç´š**

**å•é¡Œæè¿°**: å‡ç´šå¥—ä»¶å°è‡´ä»‹é¢ç°½åè®Šæ›´

**æ›¿ä»£ç­–ç•¥: ä¾è³´ä½ç½®æ±ºå®šé †åº**
```text
å¦‚æœå¥—ä»¶è¢« Infrastructure å±¤ä½¿ç”¨:
  â†’ å¾ Infrastructure é–‹å§‹ï¼ˆæŠ€è¡“é©…å‹•ï¼‰

å¦‚æœå¥—ä»¶å½±éŸ¿ Domain Interface:
  â†’ Interface-Firstï¼ˆå…ˆèª¿æ•´ Layer 4ï¼‰
```

---

**ç‰¹æ®Šå ´æ™¯è­˜åˆ¥æª¢æŸ¥æ¸…å–®**:
- [ ] æ­¤ä»»å‹™æ˜¯å¦æ¶‰åŠå¤§ç¯„åœæ¶æ§‹èª¿æ•´ï¼Ÿ â†’ æ¶æ§‹é·ç§»
- [ ] æ­¤ä»»å‹™æ˜¯å¦ä¿®å¾©æ ¸å¿ƒæ¥­å‹™è¦å‰‡ï¼Ÿ â†’ å®‰å…¨æ€§ä¿®å¾© / Bug Fix
- [ ] æ­¤ä»»å‹™æ˜¯å¦ç”±æŠ€è¡“å‡ç´šé©…å‹•ï¼Ÿ â†’ ç¬¬ä¸‰æ–¹å¥—ä»¶å‡ç´š
- [ ] æ­¤ä»»å‹™æ˜¯å¦éœ€è¦å…ˆå®šç¾©ä»‹é¢ï¼Ÿ â†’ Interface-First

### 4.5 é¢¨éšªæ§åˆ¶ç­–ç•¥

**ç­–ç•¥ 1: ä»‹é¢å…ˆè¡Œï¼ˆInterface-Firstï¼‰**
```text
å¯¦ä½œå…§å±¤å‰ï¼Œå…ˆå®šç¾© Layer 4 çš„ä»‹é¢å¥‘ç´„
å„ªå‹¢ï¼š
- å¤–å±¤å¯ä»¥å…ˆä½¿ç”¨ Mock å¯¦ä½œé€²è¡Œé–‹ç™¼
- å…§å±¤å¯¦ä½œæ™‚æœ‰æ˜ç¢ºçš„å¥‘ç´„éµå¾ª
- æ¸›å°‘å±¤ç´šé–“çš„ç­‰å¾…æ™‚é–“
```

**ç­–ç•¥ 2: æ¼¸é€²å¼é‡æ§‹ï¼ˆProgressive Refactoringï¼‰**
```text
æ¯å±¤å¯¦ä½œå®Œæˆå¾Œï¼Œç«‹å³æª¢æŸ¥æ˜¯å¦éœ€è¦é‡æ§‹
å„ªå‹¢ï¼š
- å•é¡ŒåŠæ—©ç™¼ç¾ï¼Œä¿®æ­£æˆæœ¬ä½
- é¿å…æŠ€è¡“å‚µå‹™ç´¯ç©
- ä¿æŒç¨‹å¼ç¢¼å“è³ª
```

**ç­–ç•¥ 3: é€†å‘é©—è­‰ï¼ˆBackward Validationï¼‰**
```text
å¯¦ä½œå…§å±¤å¾Œï¼Œé‡æ–°é©—è­‰å¤–å±¤æ˜¯å¦ä»ç„¶æ­£ç¢º
å„ªå‹¢ï¼š
- ç¢ºä¿å±¤ç´šé–“çš„æ•´åˆæ­£ç¢º
- åŠæ—©ç™¼ç¾ä»‹é¢ä¸åŒ¹é…å•é¡Œ
- æå‡æ•´é«”ç³»çµ±ç©©å®šæ€§
```

---

## ç¬¬äº”ç« ï¼šTicket ç²’åº¦æ¨™æº–

### 5.1 ç‚ºä»€éº¼éœ€è¦é‡åŒ–çš„ç²’åº¦æ¨™æº–ï¼Ÿ

**å•é¡ŒèƒŒæ™¯**ï¼š
- âŒ Ticket éå¤§å°è‡´é–‹ç™¼é€±æœŸé•·ï¼Œé¢¨éšªé«˜
- âŒ Ticket éå°å°è‡´ç®¡ç†æˆæœ¬é«˜ï¼Œæ•ˆç‡ä½
- âŒ ç¼ºä¹å®¢è§€åˆ¤æ–·æ¨™æº–ï¼Œä¾è³´ä¸»è§€ç¶“é©—

**ç²’åº¦æ¨™æº–çš„åƒ¹å€¼**ï¼š
- âœ… **å¯é æ¸¬æ€§**ï¼šä¾æ“šæ¨™æº–å¿«é€Ÿä¼°ç®—å·¥ä½œé‡
- âœ… **é¢¨éšªæ§åˆ¶**ï¼šé™åˆ¶ Ticket å½±éŸ¿ç¯„åœ
- âœ… **å“è³ªä¿è­‰**ï¼šç¢ºä¿æ¸¬è©¦è¦†è“‹ç‡å’Œ Code Review å“è³ª
- âœ… **æ•æ·ç¯€å¥**ï¼šç¶­æŒå¿«é€Ÿè¿­ä»£å’ŒæŒçºŒäº¤ä»˜

### 5.2 é‡åŒ–æŒ‡æ¨™å®šç¾©

**æ ¸å¿ƒæŒ‡æ¨™**ï¼š

| æŒ‡æ¨™ | æ¨™æº–å€¼ | å®¹è¨±ç¯„åœ | èªªæ˜ |
|------|--------|---------|------|
| **ä¿®æ”¹æª”æ¡ˆæ•¸** | 1-3 å€‹ | æœ€å¤š 5 å€‹ | è¶…é 5 å€‹éœ€æ‹†åˆ† |
| **ç¨‹å¼ç¢¼è¡Œæ•¸** | 50-200 è¡Œ | æœ€å¤š 300 è¡Œ | åŒ…å«æ¸¬è©¦ç¨‹å¼ç¢¼ |
| **ä¿®æ”¹å±¤ç´š** | 1 å±¤ | æœ€å¤š 1 å±¤ | åš´æ ¼å–®å±¤ä¿®æ”¹ |
| **æ¸¬è©¦æª”æ¡ˆæ•¸** | 1-2 å€‹ | æœ€å¤š 3 å€‹ | å°æ‡‰ä¿®æ”¹æª”æ¡ˆ |
| **é–‹ç™¼æ™‚é–“** | 2-8 å°æ™‚ | æœ€å¤š 1 å¤© | å–®äººå®Œæˆæ™‚é–“ |
| **æ¸¬è©¦è¦†è“‹ç‡** | 100% | ä¸å®¹è¨±ä½æ–¼ 100% | æ–°å¢ç¨‹å¼ç¢¼è¦†è“‹ç‡ |

**è£œå……èªªæ˜** (ä¿®æ­£ #5)ï¼š

**ä¿®æ”¹æª”æ¡ˆæ•¸é‚Šç•Œè™•ç†**ï¼š
```text
æƒ…å¢ƒ 1ï¼šå‰›å¥½ 5 å€‹æª”æ¡ˆ
  åˆ¤æ–·ï¼šæª¢æŸ¥æ˜¯å¦å¯æ‹†åˆ†ç‚ºæ›´å°çš„ Ticket
  è¡Œå‹•ï¼šå¦‚æœå¯æ‹†åˆ† â†’ æ‹†åˆ†ï¼›å¦‚æœè·è²¬å–®ä¸€ä¸”ä¸å¯æ‹† â†’ ä¿æŒ

æƒ…å¢ƒ 2ï¼š6-7 å€‹æª”æ¡ˆ
  åˆ¤æ–·ï¼šè¶…å‡ºæ¨™æº–ï¼Œå¼·åˆ¶æ‹†åˆ†
  è¡Œå‹•ï¼šåˆ†ææª”æ¡ˆä¾è³´é—œä¿‚ï¼Œæ‹†åˆ†ç‚º 2 å€‹ Ticket

æƒ…å¢ƒ 3ï¼š8+ å€‹æª”æ¡ˆ
  åˆ¤æ–·ï¼šåš´é‡è¶…æ¨™ï¼Œæ¶æ§‹è¨­è¨ˆå¯èƒ½æœ‰å•é¡Œ
  è¡Œå‹•ï¼šé‡æ–°è©•ä¼°æ¶æ§‹è¨­è¨ˆï¼Œé‡æ–°è¦åŠƒ Ticket
```

**ç¨‹å¼ç¢¼è¡Œæ•¸é‚Šç•Œè™•ç†**ï¼š
```text
æƒ…å¢ƒ 1ï¼š250-300 è¡Œ
  åˆ¤æ–·ï¼šæ¥è¿‘ä¸Šé™ï¼Œè©•ä¼°è¤‡é›œåº¦
  è¡Œå‹•ï¼šå¦‚æœæ˜¯ç°¡å–®é‡è¤‡é‚è¼¯ â†’ æ¥å—ï¼›å¦‚æœæ˜¯è¤‡é›œé‚è¼¯ â†’ æ‹†åˆ†

æƒ…å¢ƒ 2ï¼š300-400 è¡Œ
  åˆ¤æ–·ï¼šè¶…å‡ºæ¨™æº–ï¼Œéœ€è¦æ‹†åˆ†
  è¡Œå‹•ï¼šè­˜åˆ¥å¯ç¨ç«‹çš„å­åŠŸèƒ½ï¼Œæ‹†åˆ†ç‚º 2 å€‹ Ticket

æƒ…å¢ƒ 3ï¼š400+ è¡Œ
  åˆ¤æ–·ï¼šåš´é‡è¶…æ¨™ï¼Œè·è²¬ä¸å–®ä¸€
  è¡Œå‹•ï¼šé‡æ–°è¨­è¨ˆï¼Œæ‹†åˆ†ç‚º 3+ å€‹ Ticket
```

**é–‹ç™¼æ™‚é–“é‚Šç•Œè™•ç†**ï¼š
```text
æƒ…å¢ƒ 1ï¼š6-8 å°æ™‚
  åˆ¤æ–·ï¼šæ¥è¿‘ä¸Šé™ï¼Œè©•ä¼°æ˜¯å¦å¯ä¸¦è¡Œ
  è¡Œå‹•ï¼šå¦‚æœå¯ç¨ç«‹é©—è­‰ â†’ æ¥å—ï¼›å¦‚æœä¾è³´å…¶ä»– Ticket â†’ æ‹†åˆ†

æƒ…å¢ƒ 2ï¼š1-1.5 å¤©
  åˆ¤æ–·ï¼šè¶…å‡ºæ¨™æº–ï¼Œé¢¨éšªå¢åŠ 
  è¡Œå‹•ï¼šæ‹†åˆ†ç‚º 2 å€‹åŠå¤© Ticket

æƒ…å¢ƒ 3ï¼š2+ å¤©
  åˆ¤æ–·ï¼šåš´é‡è¶…æ¨™ï¼Œç„¡æ³•å¿«é€Ÿé©—è­‰
  è¡Œå‹•ï¼šé‡æ–°è¦åŠƒï¼Œæ‹†åˆ†ç‚º 4+ å€‹ Ticket
```

### 5.3 è‰¯å¥½çš„ Ticket è¨­è¨ˆç¯„ä¾‹

**ç¯„ä¾‹çµ„ 1ï¼šUI å±¤ Ticket**

```markdown
### Ticketï¼š[Layer 1] å¯¦ä½œæ›¸ç±è©³æƒ…é  UI

**å±¤ç´šå®šä½**ï¼šLayer 1 (UI/Presentation)

**åŠŸèƒ½æè¿°**ï¼š
å¯¦ä½œæ›¸ç±è©³æƒ…é çš„è¦–è¦ºå‘ˆç¾ï¼ŒåŒ…å«æ›¸åã€ä½œè€…ã€å‡ºç‰ˆå¹´ä»½ã€å°é¢åœ–ã€ç°¡ä»‹ç­‰è³‡è¨Šã€‚

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢æª”æ¡ˆï¼š`lib/ui/pages/book_detail_page.dart` (ç´„ 80 è¡Œ)
- æ–°å¢æª”æ¡ˆï¼š`lib/ui/widgets/book_cover_widget.dart` (ç´„ 40 è¡Œ)

**ä¾è³´é …ç›®**ï¼š
- ä¾è³´ BookDetailController (å·²å­˜åœ¨)
- ä¾è³´ Theme å®šç¾© (å·²å­˜åœ¨)

**é©—æ”¶æ¢ä»¶**ï¼š
- [ ] UI ç¬¦åˆè¨­è¨ˆç¨¿
- [ ] æ‰€æœ‰è³‡è¨Šæ­£ç¢ºé¡¯ç¤º
- [ ] éŸ¿æ‡‰å¼ä½ˆå±€æ­£å¸¸
- [ ] é€šé Widget æ¸¬è©¦

**æ¸¬è©¦ç¯„åœ**ï¼š
- Widget æ¸¬è©¦ï¼š`test/ui/pages/book_detail_page_test.dart`
- Golden Testï¼š`test/golden/book_detail_page_golden_test.dart`

**é ä¼°å·¥æ™‚**ï¼š4 å°æ™‚
**ç²’åº¦æŒ‡æ¨™**ï¼šâœ… 2 å€‹æª”æ¡ˆï¼Œ120 è¡Œï¼Œ1 å±¤ï¼Œ4 å°æ™‚
```

---

**ç¯„ä¾‹çµ„ 2ï¼šBehavior å±¤ Ticket**

```markdown
### Ticketï¼š[Layer 2] å¯¦ä½œæ›¸ç±æœå°‹ Controller

**å±¤ç´šå®šä½**ï¼šLayer 2 (Application/Behavior)

**åŠŸèƒ½æè¿°**ï¼š
å¯¦ä½œæ›¸ç±æœå°‹çš„äº‹ä»¶è™•ç†é‚è¼¯ï¼ŒåŒ…å«è¼¸å…¥é©—è­‰ã€Loading ç‹€æ…‹ç®¡ç†ã€éŒ¯èª¤è™•ç†ã€‚

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢æª”æ¡ˆï¼š`lib/application/controllers/book_search_controller.dart` (ç´„ 150 è¡Œ)
- æ–°å¢æª”æ¡ˆï¼š`lib/application/viewmodels/book_search_viewmodel.dart` (ç´„ 50 è¡Œ)

**ä¾è³´é …ç›®**ï¼š
- ä¾è³´ SearchBookUseCase (éœ€å…ˆå®Œæˆ Layer 3 Ticket)
- ä¾è³´ BookPresenter (å·²å­˜åœ¨)

**é©—æ”¶æ¢ä»¶**ï¼š
- [ ] è¼¸å…¥é©—è­‰æ­£ç¢º
- [ ] Loading ç‹€æ…‹æ­£ç¢ºåˆ‡æ›
- [ ] éŒ¯èª¤è¨Šæ¯æ­£ç¢ºé¡¯ç¤º
- [ ] é€šéè¡Œç‚ºæ¸¬è©¦

**æ¸¬è©¦ç¯„åœ**ï¼š
- è¡Œç‚ºæ¸¬è©¦ï¼š`test/application/controllers/book_search_controller_test.dart`
- Mock UseCase é©—è­‰å‘¼å«é‚è¼¯

**é ä¼°å·¥æ™‚**ï¼š6 å°æ™‚
**ç²’åº¦æŒ‡æ¨™**ï¼šâœ… 2 å€‹æª”æ¡ˆï¼Œ200 è¡Œï¼Œ1 å±¤ï¼Œ6 å°æ™‚
```

---

**ç¯„ä¾‹çµ„ 3ï¼šUseCase å±¤ Ticket**

```markdown
### Ticketï¼š[Layer 3] å¯¦ä½œæ›¸ç±æœå°‹ UseCase

**å±¤ç´šå®šä½**ï¼šLayer 3 (UseCase)

**åŠŸèƒ½æè¿°**ï¼š
å¯¦ä½œæ›¸ç±æœå°‹çš„æ¥­å‹™æµç¨‹ï¼Œå”èª¿ Repository å’Œ Cacheï¼Œç™¼å¸ƒæœå°‹äº‹ä»¶ã€‚

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢æª”æ¡ˆï¼š`lib/usecases/search_book_usecase.dart` (ç´„ 100 è¡Œ)

**ä¾è³´é …ç›®**ï¼š
- ä¾è³´ IBookRepository (å·²å­˜åœ¨æ–¼ Layer 4)
- ä¾è³´ IEventBus (å·²å­˜åœ¨æ–¼ Layer 4)

**é©—æ”¶æ¢ä»¶**ï¼š
- [ ] æœå°‹é‚è¼¯æ­£ç¢º
- [ ] å¿«å–ç­–ç•¥æ­£ç¢º
- [ ] äº‹ä»¶æ­£ç¢ºç™¼å¸ƒ
- [ ] é€šé UseCase æ¸¬è©¦

**æ¸¬è©¦ç¯„åœ**ï¼š
- UseCase æ¸¬è©¦ï¼š`test/usecases/search_book_usecase_test.dart`
- Mock Repository å’Œ EventBus

**é ä¼°å·¥æ™‚**ï¼š5 å°æ™‚
**ç²’åº¦æŒ‡æ¨™**ï¼šâœ… 1 å€‹æª”æ¡ˆï¼Œ100 è¡Œï¼Œ1 å±¤ï¼Œ5 å°æ™‚
```

### 5.4 ä¸è‰¯çš„ Ticket è¨­è¨ˆç¯„ä¾‹ï¼ˆåé¢æ•™æï¼‰

**åé¢æ•™æ 1ï¼šè·¨å±¤ä¿®æ”¹**

```markdown
### âŒ Ticketï¼šå¯¦ä½œæ›¸ç±æ”¶è—åŠŸèƒ½

**å•é¡Œåˆ†æ**ï¼š
- ä¿®æ”¹ 4 å€‹å±¤ç´šï¼ˆUI, Behavior, UseCase, Domainï¼‰
- é•åå–®å±¤ä¿®æ”¹åŸå‰‡
- æ¸¬è©¦ç¯„åœéå¤§ï¼Œç„¡æ³•ç¨ç«‹é©—è­‰

**è®Šæ›´ç¯„åœ**ï¼š
- lib/ui/pages/book_detail_page.dart (Layer 1)
- lib/application/controllers/book_detail_controller.dart (Layer 2)
- lib/usecases/add_book_to_favorite_usecase.dart (Layer 3)
- lib/domain/entities/favorite.dart (Layer 5)

**æ‡‰è©²å¦‚ä½•æ‹†åˆ†**ï¼š
- Ticket 1ï¼š[Layer 5] å®šç¾© Favorite Entity
- Ticket 2ï¼š[Layer 4] å®šç¾© IFavoriteRepository
- Ticket 3ï¼š[Layer 3] å¯¦ä½œ AddBookToFavoriteUseCase
- Ticket 4ï¼š[Layer 2] å¯¦ä½œæ”¶è—æŒ‰éˆ•äº‹ä»¶è™•ç†
- Ticket 5ï¼š[Layer 1] å¯¦ä½œæ”¶è—æŒ‰éˆ• UI
```

---

**åé¢æ•™æ 2ï¼šè·è²¬ä¸å–®ä¸€**

```markdown
### âŒ Ticketï¼šå„ªåŒ–æ›¸ç±åˆ—è¡¨åŠŸèƒ½

**å•é¡Œåˆ†æ**ï¼š
- åŒ…å«å¤šå€‹ä¸åŒçš„è®Šæ›´åŸå› 
- æ··åˆäº†ã€Œæ•ˆèƒ½å„ªåŒ–ã€å’Œã€ŒåŠŸèƒ½æ–°å¢ã€
- è®Šæ›´ç¯„åœéå¤§ï¼Œé›£ä»¥é©—æ”¶

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢åˆ†é åŠŸèƒ½
- æ–°å¢æ’åºåŠŸèƒ½
- å„ªåŒ–åˆ—è¡¨æ¸²æŸ“æ•ˆèƒ½
- ä¿®å¾©æœå°‹ Bug

**æ‡‰è©²å¦‚ä½•æ‹†åˆ†**ï¼š
- Ticket 1ï¼š[Layer 3] æ–°å¢æ›¸ç±åˆ—è¡¨åˆ†é  UseCase
- Ticket 2ï¼š[Layer 2] å¯¦ä½œåˆ†é æ§åˆ¶é‚è¼¯
- Ticket 3ï¼š[Layer 3] æ–°å¢æ›¸ç±æ’åº UseCase
- Ticket 4ï¼š[Layer 2] å¯¦ä½œæ’åºæ§åˆ¶é‚è¼¯
- Ticket 5ï¼š[Layer 1] å„ªåŒ–åˆ—è¡¨ Widget æ¸²æŸ“æ•ˆèƒ½
- Ticket 6ï¼š[Layer 2] ä¿®å¾©æœå°‹è¼¸å…¥é©—è­‰ Bug
```

---

**åé¢æ•™æ 3ï¼šç²’åº¦éå°**

```markdown
### âŒ Ticketï¼šä¿®æ”¹æŒ‰éˆ•æ–‡å­—é¡è‰²

**å•é¡Œåˆ†æ**ï¼š
- ç²’åº¦éå°ï¼Œç®¡ç†æˆæœ¬é«˜æ–¼å¯¦ä½œæˆæœ¬
- æ‡‰è©²åˆä½µç‚ºæ›´å¤§çš„ UI èª¿æ•´ Ticket

**è®Šæ›´ç¯„åœ**ï¼š
- lib/ui/pages/book_detail_page.dart (1 è¡Œ)

**æ‡‰è©²å¦‚ä½•åˆä½µ**ï¼š
- Ticketï¼š[Layer 1] èª¿æ•´æ›¸ç±è©³æƒ…é  UI æ¨£å¼
  - ä¿®æ”¹æŒ‰éˆ•æ–‡å­—é¡è‰²
  - èª¿æ•´é–“è·
  - æ›´æ–°å­—é«”å¤§å°
  - å„ªåŒ–ä½ˆå±€
```

### 5.5 Ticket æ‹†åˆ†æŒ‡å¼•

**æ‹†åˆ†åŸå‰‡**ï¼š

1. **æŒ‰æ¶æ§‹å±¤ç´šæ‹†åˆ†**ï¼š
   - ä¸åŒå±¤ç´š = ä¸åŒ Ticket
   - ç¯„ä¾‹ï¼šUI Ticket, Behavior Ticket, UseCase Ticket

2. **æŒ‰åŠŸèƒ½æ¨¡çµ„æ‹†åˆ†**ï¼š
   - ä¸åŒåŠŸèƒ½ = ä¸åŒ Ticket
   - ç¯„ä¾‹ï¼šæœå°‹åŠŸèƒ½, æ”¶è—åŠŸèƒ½, åˆ†äº«åŠŸèƒ½

3. **æŒ‰è®Šæ›´åŸå› æ‹†åˆ†**ï¼š
   - ä¸åŒåŸå›  = ä¸åŒ Ticket
   - ç¯„ä¾‹ï¼šæ–°å¢åŠŸèƒ½ vs Bug ä¿®å¾© vs æ•ˆèƒ½å„ªåŒ–

4. **æŒ‰ä¾è³´é—œä¿‚æ‹†åˆ†**ï¼š
   - æœ‰æ˜ç¢ºå…ˆå¾Œé †åº = æ‹†åˆ†ç‚ºå¤šå€‹ Ticket
   - ç¯„ä¾‹ï¼šå…ˆå¯¦ä½œ Domain â†’ å†å¯¦ä½œ UseCase â†’ å†å¯¦ä½œ UI

**æ‹†åˆ†æµç¨‹**ï¼š

```text
æ­¥é©Ÿ 1ï¼šè­˜åˆ¥è®Šæ›´ç¯„åœ
  - åˆ—å‡ºæ‰€æœ‰éœ€è¦ä¿®æ”¹çš„æª”æ¡ˆ
  - åˆ¤æ–·æ¯å€‹æª”æ¡ˆå±¬æ–¼å“ªä¸€å±¤

æ­¥é©Ÿ 2ï¼šæª¢æŸ¥ç²’åº¦æŒ‡æ¨™
  - æª”æ¡ˆæ•¸ > 5ï¼Ÿâ†’ éœ€è¦æ‹†åˆ†
  - ç¨‹å¼ç¢¼è¡Œæ•¸ > 300ï¼Ÿâ†’ éœ€è¦æ‹†åˆ†
  - è·¨å¤šå€‹å±¤ç´šï¼Ÿâ†’ éœ€è¦æ‹†åˆ†
  - é–‹ç™¼æ™‚é–“ > 1 å¤©ï¼Ÿâ†’ éœ€è¦æ‹†åˆ†

æ­¥é©Ÿ 3ï¼šè­˜åˆ¥æ‹†åˆ†ç¶­åº¦
  - æŒ‰å±¤ç´šæ‹†åˆ†ï¼ˆå„ªå…ˆï¼‰
  - æŒ‰åŠŸèƒ½æ¨¡çµ„æ‹†åˆ†
  - æŒ‰è®Šæ›´åŸå› æ‹†åˆ†

æ­¥é©Ÿ 4ï¼šå®šç¾©ä¾è³´é—œä¿‚
  - ç¢ºå®š Ticket åŸ·è¡Œé †åº
  - æ¨™è¨˜ä¾è³´é …ç›®

æ­¥é©Ÿ 5ï¼šé©—è­‰æ‹†åˆ†çµæœ
  - æ¯å€‹ Ticket è·è²¬å–®ä¸€ï¼Ÿ
  - æ¯å€‹ Ticket å¯ç¨ç«‹é©—æ”¶ï¼Ÿ
  - ç²’åº¦æŒ‡æ¨™ç¬¦åˆæ¨™æº–ï¼Ÿ
```

**æ‹†åˆ†ç¯„ä¾‹**ï¼š

**åŸå§‹éœ€æ±‚**ï¼šå¯¦ä½œæ›¸ç±æœå°‹åŠŸèƒ½

**æ‹†åˆ†çµæœ**ï¼š
```markdown
Ticket 1ï¼š[Layer 5] å®šç¾©æ›¸ç± Entity å’Œé©—è­‰è¦å‰‡
Ticket 2ï¼š[Layer 4] å®šç¾© IBookRepository ä»‹é¢
Ticket 3ï¼š[Layer 3] å¯¦ä½œæ›¸ç±æœå°‹ UseCase
Ticket 4ï¼š[Layer 2] å¯¦ä½œæœå°‹ Controller å’Œ ViewModel
Ticket 5ï¼š[Layer 1] å¯¦ä½œæœå°‹é é¢ UI
Ticket 6ï¼š[Layer 1] å¯¦ä½œæœå°‹çµæœåˆ—è¡¨ Widget
```

### 5.6 ç²’åº¦æª¢æŸ¥æ¸…å–®

**é–‹å§‹å¯¦ä½œå‰**ï¼š
- [ ] æ­¤ Ticket åªä¿®æ”¹å–®ä¸€æ¶æ§‹å±¤ç´šï¼Ÿ
- [ ] ä¿®æ”¹æª”æ¡ˆæ•¸é‡åœ¨ 1-5 å€‹ä¹‹é–“ï¼Ÿ
- [ ] ç¨‹å¼ç¢¼è¡Œæ•¸é ä¼°åœ¨ 50-300 è¡Œä¹‹é–“ï¼Ÿ
- [ ] é–‹ç™¼æ™‚é–“é ä¼°åœ¨ 2-8 å°æ™‚ä¹‹é–“ï¼Ÿ
- [ ] è·è²¬å–®ä¸€ä¸”æ˜ç¢ºï¼Ÿ
- [ ] å¯ä»¥ç¨ç«‹é©—æ”¶ï¼Ÿ

**å¯¦ä½œå®Œæˆå¾Œ**ï¼š
- [ ] å¯¦éš›ä¿®æ”¹æª”æ¡ˆæ•¸ç¬¦åˆé ä¼°ï¼Ÿ
- [ ] å¯¦éš›ç¨‹å¼ç¢¼è¡Œæ•¸ç¬¦åˆé ä¼°ï¼Ÿ
- [ ] æ¸¬è©¦è¦†è“‹ç‡é”åˆ° 100%ï¼Ÿ
- [ ] æ‰€æœ‰æ¸¬è©¦é€šéï¼Ÿ
- [ ] Code Review å¯åœ¨ 30 åˆ†é˜å…§å®Œæˆï¼Ÿ

**è¶…å‡ºæ¨™æº–æ™‚çš„è™•ç†**ï¼š
```text
å¦‚æœæª”æ¡ˆæ•¸è¶…é 5 å€‹ï¼š
  â†’ åˆ†ææ˜¯å¦å¯æ‹†åˆ†ç‚ºå¤šå€‹ Ticket
  â†’ å¦‚æœä¸å¯æ‹†åˆ†ï¼Œè©•ä¼°æ¶æ§‹è¨­è¨ˆæ˜¯å¦åˆç†

å¦‚æœç¨‹å¼ç¢¼è¡Œæ•¸è¶…é 300 è¡Œï¼š
  â†’ æª¢æŸ¥æ˜¯å¦æœ‰é‡è¤‡é‚è¼¯å¯æå–
  â†’ æª¢æŸ¥æ˜¯å¦è·è²¬éå¤šéœ€è¦æ‹†åˆ†

å¦‚æœé–‹ç™¼æ™‚é–“è¶…é 1 å¤©ï¼š
  â†’ æ‹†åˆ†ç‚ºå¤šå€‹æ›´å°çš„ Ticket
  â†’ é‡æ–°è©•ä¼°è¤‡é›œåº¦å’Œä¾è³´é—œä¿‚
```

---

## ç¬¬å…­ç« ï¼šå±¤ç´šæª¢æŸ¥æ©Ÿåˆ¶

### 6.1 ç‚ºä»€éº¼éœ€è¦å±¤ç´šæª¢æŸ¥æ©Ÿåˆ¶ï¼Ÿ

**å•é¡ŒèƒŒæ™¯**ï¼š
- é–‹ç™¼è€…å¯èƒ½ç„¡æ„é–“é•åå–®å±¤ä¿®æ”¹åŸå‰‡
- Code Review æ™‚é›£ä»¥å¿«é€Ÿè­˜åˆ¥å±¤ç´šå•é¡Œ
- ç¼ºä¹è‡ªå‹•åŒ–æª¢æŸ¥å·¥å…·

**å±¤ç´šæª¢æŸ¥çš„åƒ¹å€¼**ï¼š
- âœ… **é é˜²å•é¡Œ**ï¼šåœ¨ Commit å‰ç™¼ç¾å±¤ç´šé•è¦
- âœ… **æå‡æ•ˆç‡**ï¼šè‡ªå‹•åŒ–æª¢æŸ¥æ¸›å°‘äººå·¥å¯©æŸ¥æˆæœ¬
- âœ… **ä¿æŒå“è³ª**ï¼šç¢ºä¿æ¶æ§‹åŸå‰‡è¢«åš´æ ¼éµå®ˆ
- âœ… **æ•™è‚²åœ˜éšŠ**ï¼šæª¢æŸ¥è¨Šæ¯å¹«åŠ©åœ˜éšŠç†è§£æ¶æ§‹

### 6.2 æª”æ¡ˆè·¯å¾‘åˆ†ææ³•

**åŸç†**ï¼šæ ¹æ“šæª”æ¡ˆè·¯å¾‘åˆ¤æ–·æ‰€å±¬å±¤ç´š

**è·¯å¾‘è¦ç¯„**ï¼š
```dart
lib/
â”œâ”€â”€ ui/                    // Layer 1 (UI/Presentation)
â”‚   â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ widgets/
â”‚   â””â”€â”€ themes/
â”œâ”€â”€ application/           // Layer 2 (Application/Behavior)
â”‚   â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ viewmodels/
â”‚   â””â”€â”€ presenters/
â”œâ”€â”€ usecases/             // Layer 3 (UseCase)
â”‚   â””â”€â”€ *.dart
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ events/           // Layer 4 (Domain Events)
â”‚   â”œâ”€â”€ interfaces/       // Layer 4 (Interfaces)
â”‚   â”œâ”€â”€ entities/         // Layer 5 (Domain Implementation)
â”‚   â”œâ”€â”€ value_objects/    // Layer 5
â”‚   â””â”€â”€ services/         // Layer 5
â””â”€â”€ infrastructure/       // Infrastructure (ä¸åœ¨äº”å±¤è¨è«–ç¯„åœ)
    â”œâ”€â”€ repositories/
    â””â”€â”€ api/
```

**æª¢æŸ¥è…³æœ¬ç¯„ä¾‹**ï¼š
```bash
#!/bin/bash

# æª¢æŸ¥ Commit ä¸­çš„æª”æ¡ˆæ˜¯å¦è·¨å±¤
check_single_layer_modification() {
  local files=$(git diff --cached --name-only)
  local layers=()

  for file in $files; do
    if [[ $file == lib/ui/* ]]; then
      layers+=("Layer1")
    elif [[ $file == lib/application/* ]]; then
      layers+=("Layer2")
    elif [[ $file == lib/usecases/* ]]; then
      layers+=("Layer3")
    elif [[ $file == lib/domain/events/* ]] || [[ $file == lib/domain/interfaces/* ]]; then
      layers+=("Layer4")
    elif [[ $file == lib/domain/* ]]; then
      layers+=("Layer5")
    fi
  done

  # å»é‡
  unique_layers=$(echo "${layers[@]}" | tr ' ' '\n' | sort -u | tr '\n' ' ')
  layer_count=$(echo "$unique_layers" | wc -w)

  if [ "$layer_count" -gt 1 ]; then
    echo "âŒ é•åå–®å±¤ä¿®æ”¹åŸå‰‡"
    echo "æ­¤ Commit ä¿®æ”¹äº† $layer_count å€‹å±¤ç´šï¼š$unique_layers"
    echo "è«‹å°‡ä¿®æ”¹æ‹†åˆ†ç‚ºå¤šå€‹ Commit"
    exit 1
  fi

  echo "âœ… ç¬¦åˆå–®å±¤ä¿®æ”¹åŸå‰‡"
}
```

### 6.3 è®Šæ›´åŸå› åˆ†ææ³•

**åŸç†**ï¼šæª¢æŸ¥ Commit Message å’Œç¨‹å¼ç¢¼è®Šæ›´æ˜¯å¦ç¬¦åˆå–®ä¸€åŸå› 

**åˆ†æç¶­åº¦**ï¼š

1. **Commit Message åˆ†æ**ï¼š
   ```text
   è‰¯å¥½ç¯„ä¾‹ï¼š
   - "feat(ui): æ–°å¢æ›¸ç±è©³æƒ…é  UI"
   - "fix(controller): ä¿®å¾©æœå°‹è¼¸å…¥é©—è­‰é‚è¼¯"
   - "refactor(usecase): æ‹†åˆ†æ›¸ç±æœå°‹æµç¨‹"

   ä¸è‰¯ç¯„ä¾‹ï¼š
   - "feat: æ–°å¢æ›¸ç±æœå°‹åŠŸèƒ½"ï¼ˆéæ–¼ç± çµ±ï¼Œå¯èƒ½è·¨å±¤ï¼‰
   - "fix: ä¿®å¾©å¤šå€‹å•é¡Œ"ï¼ˆè®Šæ›´åŸå› ä¸å–®ä¸€ï¼‰
   - "update: èª¿æ•´ç¨‹å¼ç¢¼"ï¼ˆç„¡æ³•åˆ¤æ–·è®Šæ›´åŸå› ï¼‰
   ```

2. **ç¨‹å¼ç¢¼å·®ç•°åˆ†æ**ï¼š
   ```text
   æª¢æŸ¥é …ç›®ï¼š
   - [ ] æ–°å¢çš„ç¨‹å¼ç¢¼æ˜¯å¦å±¬æ–¼åŒä¸€å±¤ç´šï¼Ÿ
   - [ ] ä¿®æ”¹çš„ç¨‹å¼ç¢¼æ˜¯å¦å› ç‚ºç›¸åŒåŸå› ï¼Ÿ
   - [ ] åˆªé™¤çš„ç¨‹å¼ç¢¼æ˜¯å¦å±¬æ–¼åŒä¸€å±¤ç´šï¼Ÿ
   ```

### 6.4 æ¸¬è©¦ç¯„åœåˆ†ææ³•

**åŸç†**ï¼šæ¸¬è©¦æª”æ¡ˆæ‡‰è©²å°æ‡‰å–®ä¸€å±¤ç´šçš„ä¿®æ”¹

**æª¢æŸ¥è¦å‰‡**ï¼š

1. **æ¸¬è©¦æª”æ¡ˆè·¯å¾‘æª¢æŸ¥**ï¼š
   ```dart
   test/
   â”œâ”€â”€ ui/           // å°æ‡‰ Layer 1 ä¿®æ”¹
   â”œâ”€â”€ application/  // å°æ‡‰ Layer 2 ä¿®æ”¹
   â”œâ”€â”€ usecases/     // å°æ‡‰ Layer 3 ä¿®æ”¹
   â””â”€â”€ domain/       // å°æ‡‰ Layer 4/5 ä¿®æ”¹
   ```

2. **æ¸¬è©¦é¡å‹æª¢æŸ¥**ï¼š
   ```text
   Layer 1 â†’ Widget Test, Golden Test
   Layer 2 â†’ è¡Œç‚ºæ¸¬è©¦ï¼ˆæ¨¡æ“¬äº‹ä»¶è§¸ç™¼ï¼‰
   Layer 3 â†’ UseCase Testï¼ˆMock Repositoryï¼‰
   Layer 4 â†’ ä»‹é¢æ¸¬è©¦ï¼ˆé©—è­‰å¥‘ç´„ï¼‰
   Layer 5 â†’ Domain Testï¼ˆç´”å–®å…ƒæ¸¬è©¦ï¼‰
   ```

3. **æ¸¬è©¦è¦†è“‹ç‡æª¢æŸ¥**ï¼š
   ```bash
   # æª¢æŸ¥æ–°å¢ç¨‹å¼ç¢¼çš„æ¸¬è©¦è¦†è“‹ç‡
   flutter test --coverage
   genhtml coverage/lcov.info -o coverage/html

   # ç¢ºä¿æ–°å¢ç¨‹å¼ç¢¼è¦†è“‹ç‡ 100%
   ```

### 6.5 é•è¦æ¨¡å¼è­˜åˆ¥

**å¸¸è¦‹é•è¦æ¨¡å¼**ï¼š

**æ¨¡å¼ 1ï¼šUI å±¤åŒ…å«æ¥­å‹™é‚è¼¯**
```dart
// âŒ é•è¦ï¼šWidget ä¸­åŒ…å«æ¥­å‹™é‚è¼¯
class BookListWidget extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final books = _filterNewBooks(_getAllBooks());  // âŒ æ¥­å‹™é‚è¼¯
    return ListView.builder(...);
  }

  List<Book> _filterNewBooks(List<Book> books) {
    // âŒ æ¥­å‹™è¦å‰‡æ‡‰è©²åœ¨ Domain å±¤
    return books.where((b) => b.publishYear >= DateTime.now().year).toList();
  }
}

// âœ… æ­£ç¢ºï¼šWidget åªè² è²¬æ¸²æŸ“
class BookListWidget extends StatelessWidget {
  final BookListController controller;

  @override
  Widget build(BuildContext context) {
    final books = controller.filteredBooks;  // âœ… ç”± Controller æä¾›è³‡æ–™
    return ListView.builder(...);
  }
}
```

---

**æ¨¡å¼ 2ï¼šController åŒ…å«æ¥­å‹™è¦å‰‡**
```dart
// âŒ é•è¦ï¼šController åŒ…å«æ ¸å¿ƒæ¥­å‹™è¦å‰‡
class BookController {
  Future<void> addBook(Book book) async {
    // âŒ æ¥­å‹™è¦å‰‡æ‡‰è©²åœ¨ Domain å±¤
    if (book.isbn.length != 13) {
      throw ValidationException('ISBN å¿…é ˆç‚º 13 ç¢¼');
    }

    await bookRepository.save(book);
  }
}

// âœ… æ­£ç¢ºï¼šController åªå‘¼å« UseCase
class BookController {
  final AddBookUseCase addBookUseCase;

  Future<void> addBook(Book book) async {
    final result = await addBookUseCase.execute(book);
    if (!result.isSuccess) {
      errorMessage = result.error;
    }
  }
}

// âœ… æ¥­å‹™è¦å‰‡åœ¨ Domain Entity
class Book {
  final ISBN isbn;

  Book({required this.isbn}) {
    _validate();
  }

  void _validate() {
    if (!isbn.isValid()) {
      throw ValidationException('ISBN æ ¼å¼ç„¡æ•ˆ');
    }
  }
}
```

---

**æ¨¡å¼ 3ï¼šUseCase ç›´æ¥ä¾è³´å…·é«”å¯¦ä½œ**
```dart
// âŒ é•è¦ï¼šUseCase ä¾è³´å…·é«”å¯¦ä½œ
class SearchBookUseCase {
  final SqliteBookRepository repository;  // âŒ å…·é«”å¯¦ä½œ

  SearchBookUseCase(this.repository);
}

// âœ… æ­£ç¢ºï¼šUseCase ä¾è³´æŠ½è±¡ä»‹é¢
class SearchBookUseCase {
  final IBookRepository repository;  // âœ… æŠ½è±¡ä»‹é¢

  SearchBookUseCase(this.repository);
}
```

### 6.6 è‡ªå‹•åŒ–æª¢æŸ¥å·¥å…·æ•´åˆ

**Pre-commit Hook ç¯„ä¾‹**ï¼š
```bash
#!/bin/bash
# .git/hooks/pre-commit

echo "ğŸ” åŸ·è¡Œå±¤ç´šéš”é›¢æª¢æŸ¥..."

# 1. æª¢æŸ¥å–®å±¤ä¿®æ”¹åŸå‰‡
./scripts/check_single_layer_modification.sh || exit 1

# 2. æª¢æŸ¥æ¸¬è©¦è¦†è“‹ç‡
flutter test --coverage || exit 1
./scripts/check_coverage.sh || exit 1

# 3. æª¢æŸ¥ Commit Message æ ¼å¼
./scripts/check_commit_message.sh || exit 1

echo "âœ… æ‰€æœ‰æª¢æŸ¥é€šé"
```

**CI/CD æ•´åˆç¯„ä¾‹**ï¼š
```yaml
# .github/workflows/pr_check.yml
name: PR Architecture Check

on: [pull_request]

jobs:
  architecture_check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: æª¢æŸ¥å–®å±¤ä¿®æ”¹åŸå‰‡
        run: ./scripts/check_single_layer_in_pr.sh

      - name: æª¢æŸ¥æ¸¬è©¦è¦†è“‹ç‡
        run: |
          flutter test --coverage
          ./scripts/check_coverage.sh

      - name: ç”Ÿæˆæ¶æ§‹åˆ†æå ±å‘Š
        run: ./scripts/generate_architecture_report.sh
```

---

## ç¬¬ä¸ƒç« ï¼šå¯¦è¸æ¡ˆä¾‹

### 7.1 æ¡ˆä¾‹ç¸½è¦½

æœ¬ç« æä¾›ä¸‰å€‹å®Œæ•´çš„å¯¦è¸æ¡ˆä¾‹ï¼Œå±•ç¤ºå¦‚ä½•åœ¨çœŸå¯¦å°ˆæ¡ˆä¸­æ‡‰ç”¨å±¤ç´šéš”é›¢æ´¾å·¥æ–¹æ³•è«–ã€‚

**æ¡ˆä¾‹ 1ï¼šæ–°å¢æ›¸ç±æœå°‹åŠŸèƒ½**ï¼ˆå®Œæ•´äº”å±¤å¯¦ä½œç¯„ä¾‹ï¼‰
**æ¡ˆä¾‹ 2ï¼šé‡æ§‹ç¾æœ‰ç¨‹å¼ç¢¼**ï¼ˆé•åå±¤ç´šéš”é›¢çš„é‡æ§‹æ¡ˆä¾‹ï¼‰
**æ¡ˆä¾‹ 3ï¼šæ¶æ§‹é·ç§»æ¡ˆä¾‹** (ä¿®æ­£ #6)ï¼ˆå¾èˆŠæ¶æ§‹é·ç§»åˆ°äº”å±¤æ¶æ§‹ï¼‰

---

### 7.2 æ¡ˆä¾‹ 1ï¼šæ–°å¢æ›¸ç±æœå°‹åŠŸèƒ½ï¼ˆå®Œæ•´äº”å±¤å¯¦ä½œï¼‰

**éœ€æ±‚æè¿°**ï¼š
ä½¿ç”¨è€…å¯ä»¥åœ¨é¦–é è¼¸å…¥ ISBN æˆ–æ›¸åï¼Œæœå°‹æ›¸ç±ï¼Œä¸¦é¡¯ç¤ºæœå°‹çµæœåˆ—è¡¨ã€‚

**Ticket æ‹†åˆ†çµæœ**ï¼š

#### Ticket 1ï¼š[Layer 5] å®šç¾© Book Entity å’Œ ISBN Value Object

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/domain/entities/book.dart`
- æ–°å¢ï¼š`lib/domain/value_objects/isbn.dart`

**å¯¦ä½œé‡é»**ï¼š
```dart
// lib/domain/value_objects/isbn.dart
class ISBN {
  final String value;

  ISBN(this.value) {
    if (!_isValid(value)) {
      throw ValidationException('ISBN æ ¼å¼ç„¡æ•ˆ');
    }
  }

  bool _isValid(String isbn) {
    return isbn.length == 13 && RegExp(r'^\d{13}$').hasMatch(isbn);
  }

  bool isValid() => _isValid(value);
}

// lib/domain/entities/book.dart
class Book {
  final ISBN isbn;
  final Title title;
  final Author author;

  Book({
    required this.isbn,
    required this.title,
    required this.author,
  });
}
```

**æ¸¬è©¦ç¯„åœ**ï¼š
```dart
// test/domain/value_objects/isbn_test.dart
test('ISBN æ‡‰è©²é©—è­‰æ ¼å¼', () {
  expect(() => ISBN('1234567890123'), returnsNormally);
  expect(() => ISBN('invalid'), throwsA(isA<ValidationException>()));
});
```

---

#### Ticket 2ï¼š[Layer 4] å®šç¾© IBookRepository ä»‹é¢

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/domain/interfaces/i_book_repository.dart`

**å¯¦ä½œé‡é»**ï¼š
```dart
// lib/domain/interfaces/i_book_repository.dart
abstract class IBookRepository {
  Future<OperationResult<List<Book>>> searchByIsbn(String isbn);
  Future<OperationResult<List<Book>>> searchByTitle(String title);
}
```

---

#### Ticket 3ï¼š[Layer 3] å¯¦ä½œ SearchBookUseCase

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/usecases/search_book_usecase.dart`

**å¯¦ä½œé‡é»**ï¼š
```dart
// lib/usecases/search_book_usecase.dart
class SearchBookUseCase {
  final IBookRepository bookRepository;
  final IEventBus eventBus;

  SearchBookUseCase({
    required this.bookRepository,
    required this.eventBus,
  });

  Future<OperationResult<List<Book>>> execute(String query) async {
    try {
      // åˆ¤æ–·æŸ¥è©¢é¡å‹
      final isIsbn = ISBN.isValidFormat(query);

      final result = isIsbn
          ? await bookRepository.searchByIsbn(query)
          : await bookRepository.searchByTitle(query);

      if (result.isSuccess) {
        eventBus.publish(BookSearchedEvent(query: query, resultCount: result.data!.length));
      }

      return result;
    } catch (e) {
      return OperationResult.failure('æœå°‹å¤±æ•—ï¼š$e');
    }
  }
}
```

**æ¸¬è©¦ç¯„åœ**ï¼š
```dart
// test/usecases/search_book_usecase_test.dart
test('æ‡‰è©²æ ¹æ“š ISBN æœå°‹æ›¸ç±', () async {
  when(mockRepository.searchByIsbn(any))
      .thenAnswer((_) async => OperationResult.success([mockBook]));

  final result = await useCase.execute('1234567890123');

  expect(result.isSuccess, true);
  verify(mockRepository.searchByIsbn('1234567890123')).called(1);
});
```

---

#### Ticket 4ï¼š[Layer 2] å¯¦ä½œ BookSearchController

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/application/controllers/book_search_controller.dart`
- æ–°å¢ï¼š`lib/application/viewmodels/book_search_viewmodel.dart`

**å¯¦ä½œé‡é»**ï¼š
```dart
// lib/application/controllers/book_search_controller.dart
class BookSearchController extends ChangeNotifier {
  final SearchBookUseCase searchBookUseCase;

  BookSearchController({required this.searchBookUseCase});

  bool isLoading = false;
  List<BookViewModel> searchResults = [];
  String? errorMessage;

  Future<void> onSearch(String query) async {
    if (query.isEmpty) {
      errorMessage = 'è«‹è¼¸å…¥æœå°‹é—œéµå­—';
      notifyListeners();
      return;
    }

    isLoading = true;
    errorMessage = null;
    notifyListeners();

    final result = await searchBookUseCase.execute(query);

    isLoading = false;

    if (result.isSuccess) {
      searchResults = result.data!
          .map((book) => BookPresenter.toViewModel(book))
          .toList();
    } else {
      errorMessage = result.error;
    }

    notifyListeners();
  }
}
```

**æ¸¬è©¦ç¯„åœ**ï¼š
```dart
// test/application/controllers/book_search_controller_test.dart
test('æœå°‹æˆåŠŸæ‡‰è©²æ›´æ–°æœå°‹çµæœ', () async {
  when(mockUseCase.execute(any))
      .thenAnswer((_) async => OperationResult.success([mockBook]));

  await controller.onSearch('test');

  expect(controller.searchResults.length, 1);
  expect(controller.isLoading, false);
  expect(controller.errorMessage, null);
});
```

---

#### Ticket 5ï¼š[Layer 1] å¯¦ä½œæœå°‹é é¢ UI

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/ui/pages/book_search_page.dart`

**å¯¦ä½œé‡é»**ï¼š
```dart
// lib/ui/pages/book_search_page.dart
class BookSearchPage extends StatelessWidget {
  final BookSearchController controller;

  const BookSearchPage({required this.controller});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('æ›¸ç±æœå°‹')),
      body: Column(
        children: [
          TextField(
            onSubmitted: controller.onSearch,
            decoration: InputDecoration(hintText: 'è¼¸å…¥ ISBN æˆ–æ›¸å'),
          ),
          if (controller.isLoading) CircularProgressIndicator(),
          if (controller.errorMessage != null) Text(controller.errorMessage!),
          Expanded(
            child: ListView.builder(
              itemCount: controller.searchResults.length,
              itemBuilder: (context, index) {
                final book = controller.searchResults[index];
                return ListTile(
                  title: Text(book.title),
                  subtitle: Text(book.author),
                );
              },
            ),
          ),
        ],
      ),
    );
  }
}
```

**æ¸¬è©¦ç¯„åœ**ï¼š
```dart
// test/ui/pages/book_search_page_test.dart
testWidgets('æ‡‰è©²é¡¯ç¤ºæœå°‹çµæœ', (tester) async {
  controller.searchResults = [mockBookViewModel];

  await tester.pumpWidget(MaterialApp(home: BookSearchPage(controller: controller)));

  expect(find.text('æ¸¬è©¦æ›¸ç±'), findsOneWidget);
});
```

---

### 7.3 æ¡ˆä¾‹ 2ï¼šé‡æ§‹ç¾æœ‰ç¨‹å¼ç¢¼ï¼ˆé•åå±¤ç´šéš”é›¢ï¼‰

**å•é¡Œå ´æ™¯**ï¼š
ç¾æœ‰ç¨‹å¼ç¢¼å°‡æ¥­å‹™é‚è¼¯æ··åœ¨ UI å±¤ï¼Œéœ€è¦é‡æ§‹ç‚ºç¬¦åˆäº”å±¤æ¶æ§‹ã€‚

**åŸå§‹ç¨‹å¼ç¢¼ï¼ˆé•è¦ï¼‰**ï¼š
```dart
// âŒ æ‰€æœ‰é‚è¼¯éƒ½åœ¨ Widget ä¸­
class BookListPage extends StatefulWidget {
  @override
  _BookListPageState createState() => _BookListPageState();
}

class _BookListPageState extends State<BookListPage> {
  List<Book> books = [];
  bool isLoading = false;

  @override
  void initState() {
    super.initState();
    _loadBooks();
  }

  Future<void> _loadBooks() async {
    setState(() => isLoading = true);

    // âŒ ç›´æ¥å‘¼å« Repositoryï¼ˆæ‡‰è©²é€é UseCaseï¼‰
    final response = await http.get(Uri.parse('https://api.books.com/books'));
    final jsonData = jsonDecode(response.body);

    // âŒ è³‡æ–™è½‰æ›é‚è¼¯ï¼ˆæ‡‰è©²åœ¨ Presenterï¼‰
    books = (jsonData as List).map((json) => Book(
      isbn: ISBN(json['isbn']),
      title: Title(json['title']),
    )).toList();

    // âŒ æ¥­å‹™é‚è¼¯ï¼ˆæ‡‰è©²åœ¨ Domainï¼‰
    books = books.where((b) => b.publishYear >= 2020).toList();

    setState(() => isLoading = false);
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: isLoading
          ? CircularProgressIndicator()
          : ListView.builder(
              itemCount: books.length,
              itemBuilder: (context, index) => ListTile(title: Text(books[index].title.value)),
            ),
    );
  }
}
```

**é‡æ§‹ Ticket æ‹†åˆ†**ï¼š

#### Ticket 1ï¼š[Layer 5] å®šç¾© Book Entity å’Œæ¥­å‹™è¦å‰‡

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/domain/entities/book.dart`

**å¯¦ä½œé‡é»**ï¼š
```dart
// lib/domain/entities/book.dart
class Book {
  final ISBN isbn;
  final Title title;
  final int publishYear;

  Book({
    required this.isbn,
    required this.title,
    required this.publishYear,
  });

  // âœ… æ¥­å‹™è¦å‰‡ç§»åˆ° Domain
  bool isNewRelease() {
    return publishYear >= DateTime.now().year - 1;
  }
}
```

---

#### Ticket 2ï¼š[Layer 4] å®šç¾© IBookRepository ä»‹é¢

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/domain/interfaces/i_book_repository.dart`

**å¯¦ä½œé‡é»**ï¼š
```dart
abstract class IBookRepository {
  Future<OperationResult<List<Book>>> getAllBooks();
}
```

---

#### Ticket 3ï¼š[Layer 3] å¯¦ä½œ GetAllBooksUseCase

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/usecases/get_all_books_usecase.dart`

**å¯¦ä½œé‡é»**ï¼š
```dart
class GetAllBooksUseCase {
  final IBookRepository repository;

  GetAllBooksUseCase({required this.repository});

  Future<OperationResult<List<Book>>> execute({bool onlyNewReleases = false}) async {
    final result = await repository.getAllBooks();

    if (result.isSuccess && onlyNewReleases) {
      // âœ… æ¥­å‹™é‚è¼¯ä½¿ç”¨ Domain æ–¹æ³•
      final filteredBooks = result.data!.where((b) => b.isNewRelease()).toList();
      return OperationResult.success(filteredBooks);
    }

    return result;
  }
}
```

---

#### Ticket 4ï¼š[Layer 2] å¯¦ä½œ BookListController

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/application/controllers/book_list_controller.dart`

**å¯¦ä½œé‡é»**ï¼š
```dart
class BookListController extends ChangeNotifier {
  final GetAllBooksUseCase getAllBooksUseCase;

  BookListController({required this.getAllBooksUseCase});

  List<BookViewModel> books = [];
  bool isLoading = false;

  Future<void> loadBooks({bool onlyNewReleases = false}) async {
    isLoading = true;
    notifyListeners();

    final result = await getAllBooksUseCase.execute(onlyNewReleases: onlyNewReleases);

    if (result.isSuccess) {
      // âœ… ä½¿ç”¨ Presenter è½‰æ›
      books = result.data!.map((book) => BookPresenter.toViewModel(book)).toList();
    }

    isLoading = false;
    notifyListeners();
  }
}
```

---

#### Ticket 5ï¼š[Layer 1] é‡æ§‹ BookListPage UI

**è®Šæ›´ç¯„åœ**ï¼š
- ä¿®æ”¹ï¼š`lib/ui/pages/book_list_page.dart`

**å¯¦ä½œé‡é»**ï¼š
```dart
// âœ… Widget åªè² è²¬æ¸²æŸ“
class BookListPage extends StatelessWidget {
  final BookListController controller;

  const BookListPage({required this.controller});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: controller.isLoading
          ? CircularProgressIndicator()
          : ListView.builder(
              itemCount: controller.books.length,
              itemBuilder: (context, index) {
                final book = controller.books[index];
                return ListTile(title: Text(book.title));
              },
            ),
    );
  }
}
```

---

### 7.4 æ¡ˆä¾‹ 3ï¼šæ¶æ§‹é·ç§»æ¡ˆä¾‹ï¼ˆå¾ä¸‰å±¤åˆ°äº”å±¤ï¼‰ (ä¿®æ­£ #6)

**é·ç§»èƒŒæ™¯**ï¼š
å°ˆæ¡ˆåŸæœ¬ä½¿ç”¨ç°¡å–®çš„ MVC ä¸‰å±¤æ¶æ§‹ï¼Œç¾åœ¨éœ€è¦é·ç§»åˆ°äº”å±¤ Clean Architectureã€‚

**åŸå§‹æ¶æ§‹ï¼ˆä¸‰å±¤ï¼‰**ï¼š
```text
lib/
â”œâ”€â”€ models/        // æ··åˆäº† Entity å’Œ ViewModel
â”œâ”€â”€ controllers/   // æ··åˆäº† UI é‚è¼¯å’Œæ¥­å‹™é‚è¼¯
â””â”€â”€ views/         // UI å±¤
```

**ç›®æ¨™æ¶æ§‹ï¼ˆäº”å±¤ï¼‰**ï¼š
```text
lib/
â”œâ”€â”€ ui/            // Layer 1
â”œâ”€â”€ application/   // Layer 2
â”œâ”€â”€ usecases/      // Layer 3
â”œâ”€â”€ domain/        // Layer 4 + 5
â””â”€â”€ infrastructure/
```

**é·ç§»ç­–ç•¥ï¼šInterface-First äº”éšæ®µè¨ˆç•«** (ä¿®æ­£ #6)ï¼š

#### éšæ®µ 1ï¼šå®šç¾© Layer 4 ä»‹é¢å¥‘ç´„ï¼ˆä¸å½±éŸ¿ç¾æœ‰ç¨‹å¼ç¢¼ï¼‰

**ç›®æ¨™**ï¼šå»ºç«‹æ–°æ¶æ§‹çš„ä»‹é¢éª¨æ¶ï¼Œèˆ‡èˆŠç¨‹å¼ç¢¼ä¸¦å­˜

**Ticket ç¯„ä¾‹**ï¼š
```markdown
### Ticket 1-1ï¼š[Layer 4] å®šç¾©æ‰€æœ‰ Repository ä»‹é¢

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/domain/interfaces/i_book_repository.dart`
- æ–°å¢ï¼š`lib/domain/interfaces/i_favorite_repository.dart`
- æ–°å¢ï¼š`lib/domain/interfaces/i_event_bus.dart`

**ç‰¹é»**ï¼š
- ä¸ä¿®æ”¹ä»»ä½•ç¾æœ‰ç¨‹å¼ç¢¼
- åªå®šç¾©ä»‹é¢ï¼Œä¸å¯¦ä½œ
- ç‚ºå¾ŒçºŒé·ç§»å»ºç«‹å¥‘ç´„åŸºç¤
```

**å¯¦ä½œé‡é»**ï¼š
```dart
// lib/domain/interfaces/i_book_repository.dart
abstract class IBookRepository {
  Future<OperationResult<Book>> findById(String id);
  Future<OperationResult<List<Book>>> findAll();
  Future<OperationResult<void>> save(Book book);
}
```

---

#### éšæ®µ 2ï¼šæå– Domain Entity å’Œ Value Objectsï¼ˆæ¼¸é€²å¼é·ç§»ï¼‰

**ç›®æ¨™**ï¼šå°‡ `models/` ä¸­çš„è³‡æ–™æ¨¡å‹åˆ†é›¢ç‚º Domain Entity å’Œ ViewModel

**Ticket ç¯„ä¾‹**ï¼š
```markdown
### Ticket 2-1ï¼š[Layer 5] æå– Book Entity

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/domain/entities/book.dart`
- æ–°å¢ï¼š`lib/domain/value_objects/isbn.dart`
- ä¿ç•™ï¼š`lib/models/book_model.dart`ï¼ˆæš«æ™‚ä¿ç•™ï¼‰

**é·ç§»ç­–ç•¥**ï¼š
- æ–°å»º Domain Entityï¼ŒåŒ…å«æ¥­å‹™è¦å‰‡
- èˆŠçš„ Model ä¿ç•™ï¼Œæ·»åŠ  `toDomain()` è½‰æ›æ–¹æ³•
- é€æ­¥å°‡æ¥­å‹™é‚è¼¯å¾ Controller ç§»åˆ° Entity
```

**å¯¦ä½œé‡é»**ï¼š
```dart
// lib/domain/entities/book.dart (æ–°)
class Book {
  final ISBN isbn;
  final Title title;

  Book({required this.isbn, required this.title}) {
    _validate();
  }

  void _validate() {
    if (!isbn.isValid()) throw ValidationException('ISBN ç„¡æ•ˆ');
  }
}

// lib/models/book_model.dart (èˆŠï¼Œæš«æ™‚ä¿ç•™)
class BookModel {
  final String isbn;
  final String title;

  BookModel({required this.isbn, required this.title});

  // âœ… æ·»åŠ è½‰æ›æ–¹æ³•
  Book toDomain() {
    return Book(
      isbn: ISBN(isbn),
      title: Title(title),
    );
  }

  factory BookModel.fromDomain(Book book) {
    return BookModel(
      isbn: book.isbn.value,
      title: book.title.value,
    );
  }
}
```

---

#### éšæ®µ 3ï¼šå¯¦ä½œ Layer 3 UseCaseï¼ˆæ–°åŠŸèƒ½å„ªå…ˆï¼‰

**ç›®æ¨™**ï¼šæ–°åŠŸèƒ½ä½¿ç”¨ UseCaseï¼ŒèˆŠåŠŸèƒ½ä¿æŒä¸è®Š

**Ticket ç¯„ä¾‹**ï¼š
```markdown
### Ticket 3-1ï¼š[Layer 3] å¯¦ä½œ SearchBookUseCaseï¼ˆæ–°åŠŸèƒ½ï¼‰

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼š`lib/usecases/search_book_usecase.dart`
- ä½¿ç”¨ Mock Repository é–‹ç™¼ï¼ˆInfrastructure å°šæœªå®Œæˆï¼‰

**é·ç§»ç­–ç•¥**ï¼š
- æ–°åŠŸèƒ½ç›´æ¥ä½¿ç”¨æ–°æ¶æ§‹
- èˆŠåŠŸèƒ½æš«æ™‚ä¿æŒèˆŠé‚è¼¯
- é›™è»Œä¸¦è¡Œï¼Œé€æ­¥é·ç§»
```

**å¯¦ä½œé‡é»**ï¼š
```dart
// lib/usecases/search_book_usecase.dart
class SearchBookUseCase {
  final IBookRepository repository;  // âœ… ä¾è³´æŠ½è±¡ä»‹é¢

  SearchBookUseCase({required this.repository});

  Future<OperationResult<List<Book>>> execute(String query) async {
    return await repository.searchByTitle(query);
  }
}

// é–‹ç™¼éšæ®µä½¿ç”¨ Mock
class MockBookRepository implements IBookRepository {
  @override
  Future<OperationResult<List<Book>>> searchByTitle(String query) async {
    // è¿”å›æ¸¬è©¦è³‡æ–™
    return OperationResult.success([mockBook]);
  }
}
```

---

#### éšæ®µ 4ï¼šèª¿æ•´ Layer 2 Behaviorï¼ˆç§»é™¤æ¥­å‹™é‚è¼¯ï¼‰

**ç›®æ¨™**ï¼šå°‡ Controller çš„æ¥­å‹™é‚è¼¯ç§»åˆ° UseCase

**Ticket ç¯„ä¾‹**ï¼š
```markdown
### Ticket 4-1ï¼š[Layer 2] é‡æ§‹ BookControllerï¼ˆç§»é™¤æ¥­å‹™é‚è¼¯ï¼‰

**è®Šæ›´ç¯„åœ**ï¼š
- ä¿®æ”¹ï¼š`lib/controllers/book_controller.dart` â†’ `lib/application/controllers/book_controller.dart`

**é·ç§»ç­–ç•¥**ï¼š
- ç§»é™¤ Controller ä¸­çš„æ¥­å‹™é‚è¼¯
- æ”¹ç‚ºå‘¼å« UseCase
- ä¿æŒäº‹ä»¶è™•ç†è·è²¬
```

**å¯¦ä½œé‡é»**ï¼š
```dart
// èˆŠ Controllerï¼ˆé•è¦ï¼‰
class BookController {
  Future<void> searchBook(String query) async {
    // âŒ æ¥­å‹™é‚è¼¯åœ¨ Controller
    if (query.length < 3) {
      errorMessage = 'æœå°‹é—œéµå­—è‡³å°‘ 3 å€‹å­—';
      return;
    }

    final response = await http.get(...);
    books = parseBooks(response.body);
  }
}

// æ–° Controllerï¼ˆç¬¦åˆè¦ç¯„ï¼‰
class BookController {
  final SearchBookUseCase searchBookUseCase;

  Future<void> searchBook(String query) async {
    // âœ… åªè™•ç† UI é‚è¼¯
    if (query.isEmpty) {
      errorMessage = 'è«‹è¼¸å…¥æœå°‹é—œéµå­—';
      notifyListeners();
      return;
    }

    isLoading = true;
    notifyListeners();

    // âœ… å‘¼å« UseCase
    final result = await searchBookUseCase.execute(query);

    isLoading = false;
    if (result.isSuccess) {
      books = result.data!.map((b) => BookPresenter.toViewModel(b)).toList();
    } else {
      errorMessage = result.error;
    }
    notifyListeners();
  }
}
```

---

#### éšæ®µ 5ï¼šèª¿æ•´ Layer 1 UIï¼ˆç§»é™¤ç›´æ¥ä¾è³´ï¼‰

**ç›®æ¨™**ï¼šUI åªä¾è³´ Controllerï¼Œä¸ç›´æ¥å­˜å– Domain

**Ticket ç¯„ä¾‹**ï¼š
```markdown
### Ticket 5-1ï¼š[Layer 1] é‡æ§‹ BookListPageï¼ˆç§»é™¤ Domain ä¾è³´ï¼‰

**è®Šæ›´ç¯„åœ**ï¼š
- ä¿®æ”¹ï¼š`lib/views/book_list_page.dart` â†’ `lib/ui/pages/book_list_page.dart`

**é·ç§»ç­–ç•¥**ï¼š
- ç§»é™¤ UI å° Domain Entity çš„ç›´æ¥ä¾è³´
- æ”¹ç‚ºä½¿ç”¨ ViewModel
- ç¢ºä¿ UI åªæ¸²æŸ“ï¼Œä¸åŒ…å«é‚è¼¯
```

**å¯¦ä½œé‡é»**ï¼š
```dart
// èˆŠ UIï¼ˆé•è¦ï¼‰
class BookListPage extends StatelessWidget {
  Widget build(BuildContext context) {
    final books = controller.books;  // âŒ ç›´æ¥ä½¿ç”¨ Domain Entity
    return ListView.builder(
      itemBuilder: (context, index) {
        final book = books[index];
        return ListTile(
          title: Text(book.title.value),  // âŒ ç›´æ¥å­˜å– Value Object
          subtitle: Text(book.isbn.value),
        );
      },
    );
  }
}

// æ–° UIï¼ˆç¬¦åˆè¦ç¯„ï¼‰
class BookListPage extends StatelessWidget {
  Widget build(BuildContext context) {
    final books = controller.bookViewModels;  // âœ… ä½¿ç”¨ ViewModel
    return ListView.builder(
      itemBuilder: (context, index) {
        final book = books[index];
        return ListTile(
          title: Text(book.title),  // âœ… ç›´æ¥å­˜å– String
          subtitle: Text(book.isbn),
        );
      },
    );
  }
}
```

---

**é·ç§»é€²åº¦ç®¡ç†**ï¼š

```markdown
## æ¶æ§‹é·ç§»é€²åº¦è¿½è¹¤

### éšæ®µ 1ï¼šä»‹é¢å®šç¾©ï¼ˆå®Œæˆåº¦ï¼š100%ï¼‰
- [x] IBookRepository ä»‹é¢
- [x] IFavoriteRepository ä»‹é¢
- [x] IEventBus ä»‹é¢

### éšæ®µ 2ï¼šDomain æå–ï¼ˆå®Œæˆåº¦ï¼š60%ï¼‰
- [x] Book Entity
- [x] Favorite Entity
- [ ] Reading Entityï¼ˆé€²è¡Œä¸­ï¼‰
- [ ] Review Entityï¼ˆå¾…é–‹å§‹ï¼‰

### éšæ®µ 3ï¼šUseCase å¯¦ä½œï¼ˆå®Œæˆåº¦ï¼š40%ï¼‰
- [x] SearchBookUseCaseï¼ˆæ–°åŠŸèƒ½ï¼‰
- [x] AddBookToFavoriteUseCaseï¼ˆæ–°åŠŸèƒ½ï¼‰
- [ ] GetBookDetailUseCaseï¼ˆå¾…é·ç§»ï¼‰
- [ ] UpdateReadingProgressUseCaseï¼ˆå¾…é·ç§»ï¼‰

### éšæ®µ 4ï¼šController é‡æ§‹ï¼ˆå®Œæˆåº¦ï¼š20%ï¼‰
- [x] BookSearchControllerï¼ˆå·²é‡æ§‹ï¼‰
- [ ] BookListControllerï¼ˆé€²è¡Œä¸­ï¼‰
- [ ] FavoriteControllerï¼ˆå¾…é–‹å§‹ï¼‰

### éšæ®µ 5ï¼šUI èª¿æ•´ï¼ˆå®Œæˆåº¦ï¼š10%ï¼‰
- [x] BookSearchPageï¼ˆå·²é·ç§»ï¼‰
- [ ] BookListPageï¼ˆå¾…é·ç§»ï¼‰
- [ ] BookDetailPageï¼ˆå¾…é·ç§»ï¼‰
```

**é¢¨éšªæ§åˆ¶æªæ–½**ï¼š

1. **é›™è»Œä¸¦è¡Œ**ï¼š
   - æ–°åŠŸèƒ½ä½¿ç”¨æ–°æ¶æ§‹
   - èˆŠåŠŸèƒ½ä¿æŒé‹ä½œ
   - é€æ­¥é·ç§»ï¼Œä¸å¤§çˆ†ç‚¸é‡æ§‹

2. **æ¸¬è©¦è¦†è“‹ç‡ 100%**ï¼š
   - æ¯å€‹é·ç§» Ticket éƒ½åŒ…å«å®Œæ•´æ¸¬è©¦
   - ç¢ºä¿é‡æ§‹ä¸ç ´å£åŠŸèƒ½

3. **æ¯é€±é·ç§» 1-2 å€‹æ¨¡çµ„**ï¼š
   - æ§åˆ¶é·ç§»ç¯€å¥
   - é™ä½é¢¨éšª

4. **å»ºç«‹ Adapter å±¤**ï¼š
   - èˆŠç¨‹å¼ç¢¼å‘¼å«æ–°ç¨‹å¼ç¢¼æ™‚ï¼Œä½¿ç”¨ Adapter è½‰æ›
   - æ–°ç¨‹å¼ç¢¼å‘¼å«èˆŠç¨‹å¼ç¢¼æ™‚ï¼Œä½¿ç”¨ Adapter éš”é›¢

**é·ç§»å®Œæˆæ¨™æº–**ï¼š
- [ ] æ‰€æœ‰ Controller éƒ½ç§»é™¤æ¥­å‹™é‚è¼¯
- [ ] æ‰€æœ‰ UI éƒ½ä½¿ç”¨ ViewModel
- [ ] æ‰€æœ‰æ¥­å‹™é‚è¼¯éƒ½åœ¨ Domain æˆ– UseCase
- [ ] åˆªé™¤èˆŠçš„ `models/` å’Œ `controllers/` ç›®éŒ„
- [ ] æ¸¬è©¦è¦†è“‹ç‡ç¶­æŒ 100%
- [ ] æ‰€æœ‰åŠŸèƒ½æ­£å¸¸é‹ä½œ

---

## ç¬¬å…«ç« ï¼šèˆ‡å…¶ä»–æ–¹æ³•è«–çš„æ•´åˆ

### 8.1 èˆ‡ Clean Architecture å¯¦ä½œæ–¹æ³•è«–çš„é—œä¿‚

**Clean Architecture å¯¦ä½œæ–¹æ³•è«–**ï¼š
- **è·è²¬**ï¼šå®šç¾©å¦‚ä½•å¯¦ä½œæ¯ä¸€å±¤çš„ç¨‹å¼ç¢¼
- **å…§å®¹**ï¼šä¾è³´å€’ç½®ã€ä»‹é¢è¨­è¨ˆã€æ¨¡çµ„é‚Šç•Œ

**å±¤ç´šéš”é›¢æ´¾å·¥æ–¹æ³•è«–**ï¼š
- **è·è²¬**ï¼šå®šç¾©å¦‚ä½•æ‹†åˆ† Ticket å’Œå¯¦ä½œé †åº
- **å…§å®¹**ï¼šå–®å±¤ä¿®æ”¹ã€å¾å¤–è€Œå…§ã€ç²’åº¦æ¨™æº–

**æ•´åˆæ–¹å¼**ï¼š
- Clean Architecture å®šç¾©ã€Œå¦‚ä½•å¯«ç¨‹å¼ã€
- å±¤ç´šéš”é›¢æ´¾å·¥å®šç¾©ã€Œå¦‚ä½•æ‹†ä»»å‹™ã€
- å…©è€…äº’è£œï¼Œå…±åŒç¢ºä¿æ¶æ§‹å“è³ª

**å¯¦å‹™æ‡‰ç”¨**ï¼š
```markdown
### Ticketï¼š[Layer 3] å¯¦ä½œæ›¸ç±æœå°‹ UseCase

**æ¶æ§‹éµå¾ª**ï¼š
- éµå¾ª Clean Architectureï¼šä¾è³´ IBookRepository æŠ½è±¡ä»‹é¢ âœ…
- éµå¾ªå±¤ç´šéš”é›¢ï¼šåªä¿®æ”¹ Layer 3ï¼Œä¸ä¿®æ”¹å…¶ä»–å±¤ç´š âœ…

**ç¨‹å¼ç¢¼ç¯„ä¾‹**ï¼š
class SearchBookUseCase {
  final IBookRepository repository;  // âœ… ä¾è³´æŠ½è±¡ï¼ˆClean Architectureï¼‰

  // âœ… å–®ä¸€è·è²¬ï¼šåªè² è²¬æœå°‹æ¥­å‹™æµç¨‹ï¼ˆå±¤ç´šéš”é›¢ï¼‰
  Future<OperationResult<List<Book>>> execute(String query) async {
    return await repository.searchByTitle(query);
  }
}
```

---

### 8.2 èˆ‡ TDD å››éšæ®µæµç¨‹çš„é—œä¿‚

**TDD å››éšæ®µæµç¨‹**ï¼š
1. **Phase 1ï¼ˆåŠŸèƒ½è¨­è¨ˆï¼‰**ï¼šè¨­è¨ˆåŠŸèƒ½è¦æ ¼å’Œä»‹é¢
2. **Phase 2ï¼ˆæ¸¬è©¦é©—è­‰ï¼‰**ï¼šæ’°å¯«æ¸¬è©¦ï¼Œå®šç¾©é©—æ”¶æ¨™æº–
3. **Phase 3ï¼ˆå¯¦ä½œåŸ·è¡Œï¼‰**ï¼šå¯¦ä½œç¨‹å¼ç¢¼ï¼Œé€šéæ¸¬è©¦
4. **Phase 4ï¼ˆé‡æ§‹å„ªåŒ–ï¼‰**ï¼šè©•ä¼°ç¨‹å¼ç¢¼å“è³ªï¼ŒåŸ·è¡Œé‡æ§‹

**å±¤ç´šéš”é›¢æ´¾å·¥åœ¨ TDD ä¸­çš„è§’è‰²**ï¼š

**Phase 1 ä½¿ç”¨å±¤ç´šéš”é›¢**ï¼š
- è¨­è¨ˆæ™‚ä½¿ç”¨æ±ºç­–æ¨¹åˆ¤æ–·ç¨‹å¼ç¢¼å±¬æ–¼å“ªä¸€å±¤
- ä½¿ç”¨ç²’åº¦æ¨™æº–æ‹†åˆ† Ticket
- å®šç¾©æ¯å€‹ Ticket çš„å±¤ç´šå®šä½

**Phase 2 é©—è­‰å±¤ç´šéš”é›¢**ï¼š
- æ¸¬è©¦åªé©—è­‰å–®ä¸€å±¤ç´šçš„è·è²¬
- æ¸¬è©¦æª”æ¡ˆè·¯å¾‘å°æ‡‰å±¤ç´šçµæ§‹
- æ¸¬è©¦è¦†è“‹ç‡æª¢æŸ¥å±¤ç´šå®Œæ•´æ€§

**Phase 3 å¯¦ä½œç¬¦åˆå±¤ç´šéš”é›¢**ï¼š
- éµå¾ªå¾å¤–è€Œå…§å¯¦ä½œé †åº
- æ¯å€‹ Ticket åªä¿®æ”¹å–®ä¸€å±¤ç´š
- ä¿®æ”¹å®Œæˆå¾Œç«‹å³é©—è­‰

**Phase 4 è©•ä¼°å±¤ç´šéš”é›¢é•è¦**ï¼š
- æª¢æŸ¥æ˜¯å¦é•åå–®å±¤ä¿®æ”¹åŸå‰‡
- æª¢æŸ¥æ˜¯å¦æ··åˆå¤šå±¤è·è²¬
- é‡æ§‹æ™‚ä¿æŒå±¤ç´šéš”é›¢

**æ•´åˆç¯„ä¾‹**ï¼š

```markdown
## TDD å››éšæ®µ + å±¤ç´šéš”é›¢

### Phase 1ï¼šåŠŸèƒ½è¨­è¨ˆ
**ä»»å‹™**ï¼šè¨­è¨ˆæ›¸ç±æœå°‹åŠŸèƒ½

**ä½¿ç”¨å±¤ç´šéš”é›¢æ–¹æ³•è«–**ï¼š
- ä½¿ç”¨æ±ºç­–æ¨¹æ‹†åˆ†ç‚º 5 å€‹å±¤ç´šçš„ Ticket
- å®šç¾©æ¯å€‹ Ticket çš„ç²’åº¦æ¨™æº–
- ç¢ºå®šå¾å¤–è€Œå…§å¯¦ä½œé †åº

**ç”¢å‡º**ï¼š
- Ticket 1ï¼š[Layer 5] å®šç¾© Book Entity
- Ticket 2ï¼š[Layer 4] å®šç¾© IBookRepository
- Ticket 3ï¼š[Layer 3] å¯¦ä½œ SearchBookUseCase
- Ticket 4ï¼š[Layer 2] å¯¦ä½œ SearchController
- Ticket 5ï¼š[Layer 1] å¯¦ä½œæœå°‹ UI

---

### Phase 2ï¼šæ¸¬è©¦é©—è­‰
**ä»»å‹™**ï¼šç‚ºæ¯å€‹ Ticket æ’°å¯«æ¸¬è©¦

**ä½¿ç”¨å±¤ç´šéš”é›¢æ–¹æ³•è«–**ï¼š
- æ¯å±¤ä½¿ç”¨å°æ‡‰çš„æ¸¬è©¦é¡å‹
- æ¸¬è©¦æª”æ¡ˆè·¯å¾‘å°æ‡‰å±¤ç´šçµæ§‹

**ç”¢å‡º**ï¼š
- test/domain/entities/book_test.dartï¼ˆLayer 5 æ¸¬è©¦ï¼‰
- test/usecases/search_book_usecase_test.dartï¼ˆLayer 3 æ¸¬è©¦ï¼‰
- test/application/controllers/search_controller_test.dartï¼ˆLayer 2 æ¸¬è©¦ï¼‰
- test/ui/pages/search_page_test.dartï¼ˆLayer 1 æ¸¬è©¦ï¼‰

---

### Phase 3ï¼šå¯¦ä½œåŸ·è¡Œ
**ä»»å‹™**ï¼šå¯¦ä½œç¨‹å¼ç¢¼ä¸¦é€šéæ¸¬è©¦

**ä½¿ç”¨å±¤ç´šéš”é›¢æ–¹æ³•è«–**ï¼š
- éµå¾ªå¾å¤–è€Œå…§å¯¦ä½œé †åº
- æ¯å€‹ Ticket å¯¦ä½œå®Œæˆå¾Œç«‹å³é©—è­‰

**åŸ·è¡Œé †åº**ï¼š
1. å¯¦ä½œ Layer 5ï¼ˆDomainï¼‰
2. å¯¦ä½œ Layer 4ï¼ˆInterfaceï¼‰
3. å¯¦ä½œ Layer 3ï¼ˆUseCaseï¼‰
4. å¯¦ä½œ Layer 2ï¼ˆBehaviorï¼‰
5. å¯¦ä½œ Layer 1ï¼ˆUIï¼‰

---

### Phase 4ï¼šé‡æ§‹å„ªåŒ–
**ä»»å‹™**ï¼šè©•ä¼°ç¨‹å¼ç¢¼å“è³ªï¼ŒåŸ·è¡Œé‡æ§‹

**ä½¿ç”¨å±¤ç´šéš”é›¢æ–¹æ³•è«–**ï¼š
- æª¢æŸ¥æ˜¯å¦é•åå–®å±¤ä¿®æ”¹åŸå‰‡
- æª¢æŸ¥å±¤ç´šè·è²¬æ˜¯å¦æ··æ·†

**æª¢æŸ¥é …ç›®**ï¼š
- [ ] æ¯å€‹æª”æ¡ˆéƒ½å±¬æ–¼å–®ä¸€å±¤ç´šï¼Ÿ
- [ ] æ²’æœ‰è·¨å±¤ç›´æ¥å‘¼å«ï¼Ÿ
- [ ] ä¾è³´æ–¹å‘æ­£ç¢ºï¼ˆå¤–å±¤ä¾è³´å…§å±¤ï¼‰ï¼Ÿ
- [ ] æ¸¬è©¦ç¯„åœç¬¦åˆå±¤ç´šå®šä½ï¼Ÿ
```

---

### 8.3 èˆ‡ Ticket è¨­è¨ˆæ–¹æ³•è«–çš„é—œä¿‚

**Ticket è¨­è¨ˆæ–¹æ³•è«–**ï¼š
- å®šç¾© Ticket çš„åŸºæœ¬æ ¼å¼ï¼ˆæ¨™é¡Œã€æè¿°ã€é©—æ”¶æ¢ä»¶ï¼‰
- å®šç¾© Ticket çš„å¯«ä½œè¦ç¯„

**å±¤ç´šéš”é›¢æ´¾å·¥æ–¹æ³•è«–**ï¼š
- å®šç¾© Ticket çš„ç²’åº¦æ¨™æº–ï¼ˆæª”æ¡ˆæ•¸ã€è¡Œæ•¸ã€æ™‚é–“ï¼‰
- å®šç¾© Ticket çš„æ‹†åˆ†åŸå‰‡ï¼ˆæŒ‰å±¤ç´šæ‹†åˆ†ï¼‰

**æ•´åˆæ–¹å¼**ï¼š

**Ticket æ¨¡æ¿æ•´åˆ**ï¼š
```markdown
### Ticketï¼š[Layer X] {åŠŸèƒ½åç¨±}

**å±¤ç´šå®šä½**ï¼šLayer X ({å±¤ç´šåç¨±})  â† ä¾†è‡ªå±¤ç´šéš”é›¢æ´¾å·¥

**åŠŸèƒ½æè¿°**ï¼š  â† ä¾†è‡ª Ticket è¨­è¨ˆæ–¹æ³•è«–
{è©³ç´°åŠŸèƒ½æè¿°}

**è®Šæ›´ç¯„åœ**ï¼š  â† ä¾†è‡ªå±¤ç´šéš”é›¢æ´¾å·¥ï¼ˆç²’åº¦æª¢æŸ¥ï¼‰
- æ–°å¢æª”æ¡ˆï¼šlib/{layer}/{module}/{file}.dart (ç´„ XX è¡Œ)

**ä¾è³´é …ç›®**ï¼š  â† ä¾†è‡ª Ticket è¨­è¨ˆæ–¹æ³•è«–
- ä¾è³´ XXX (å·²å­˜åœ¨)

**é©—æ”¶æ¢ä»¶**ï¼š  â† ä¾†è‡ª Ticket è¨­è¨ˆæ–¹æ³•è«–
- [ ] åŠŸèƒ½æ­£ç¢ºå¯¦ä½œ
- [ ] é€šéæ¸¬è©¦
- [ ] ç¬¦åˆå±¤ç´šéš”é›¢åŸå‰‡  â† ä¾†è‡ªå±¤ç´šéš”é›¢æ´¾å·¥

**æ¸¬è©¦ç¯„åœ**ï¼š  â† ä¾†è‡ªå±¤ç´šéš”é›¢æ´¾å·¥ï¼ˆå±¤ç´šå°æ‡‰ï¼‰
- test/{layer}/{file}_test.dart

**é ä¼°å·¥æ™‚**ï¼šXX å°æ™‚  â† ä¾†è‡ªå±¤ç´šéš”é›¢æ´¾å·¥ï¼ˆç²’åº¦æ¨™æº–ï¼‰
**ç²’åº¦æŒ‡æ¨™**ï¼šX å€‹æª”æ¡ˆï¼ŒXX è¡Œï¼Œ1 å±¤ï¼ŒXX å°æ™‚  â† ä¾†è‡ªå±¤ç´šéš”é›¢æ´¾å·¥
```

---

### 8.4 èˆ‡æ•æ·é–‹ç™¼çš„æ•´åˆ

**Sprint è¦åŠƒ**ï¼š
- ä½¿ç”¨å±¤ç´šéš”é›¢æ´¾å·¥æ‹†åˆ† Ticket
- æ¯å€‹ Ticket ç¨ç«‹é©—æ”¶ï¼Œç¬¦åˆæ•æ·å¿«é€Ÿè¿­ä»£

**Daily Standup**ï¼š
- æ¯å€‹ Ticket åªä¿®æ”¹å–®ä¸€å±¤ç´šï¼Œæ˜“æ–¼æºé€šé€²åº¦
- å•é¡Œå®šä½æ¸…æ™°ï¼ˆå±¬æ–¼å“ªä¸€å±¤ï¼Ÿï¼‰

**Code Review**ï¼š
- å–®å±¤ä¿®æ”¹é™ä½ Review è¤‡é›œåº¦
- å¯©æŸ¥è€…åªéœ€é—œæ³¨å–®ä¸€å±¤ç´šçš„é‚è¼¯

**æŒçºŒæ•´åˆ**ï¼š
- æ¯å€‹ Ticket å®Œæˆå¾Œç«‹å³æ¸¬è©¦
- æ¸¬è©¦ç¨ç«‹ï¼Œä¸ä¾è³´å…¶ä»–å±¤ç´š

**æ•´åˆç¯„ä¾‹**ï¼š

```markdown
## Sprint 1 è¦åŠƒ

**Sprint ç›®æ¨™**ï¼šå¯¦ä½œæ›¸ç±æœå°‹åŠŸèƒ½

**ä½¿ç”¨å±¤ç´šéš”é›¢æ´¾å·¥æ–¹æ³•è«–**ï¼š
- æ‹†åˆ†ç‚º 5 å€‹ Ticketï¼Œæ¯å€‹ Ticket å°æ‡‰å–®ä¸€å±¤ç´š
- æ¯å€‹ Ticket é ä¼° 4-6 å°æ™‚
- å¾å¤–è€Œå…§å¯¦ä½œï¼Œå¿«é€Ÿé©—è­‰éœ€æ±‚

**Sprint Backlog**ï¼š
| Ticket | å±¤ç´š | é ä¼°å·¥æ™‚ | è² è²¬äºº | ç‹€æ…‹ |
|--------|------|---------|--------|------|
| #1 | Layer 5 | 4h | Alice | âœ… Done |
| #2 | Layer 4 | 3h | Bob | âœ… Done |
| #3 | Layer 3 | 5h | Alice | ğŸ”„ In Progress |
| #4 | Layer 2 | 6h | Carol | â³ To Do |
| #5 | Layer 1 | 4h | Bob | â³ To Do |

**Daily Standup**ï¼š
- Aliceï¼šã€Œæ˜¨å¤©å®Œæˆ Layer 5 Book Entityï¼Œä»Šå¤©å¯¦ä½œ Layer 3 SearchUseCaseã€
- Bobï¼šã€Œæ˜¨å¤©å®Œæˆ Layer 4 IBookRepository ä»‹é¢ï¼Œä»Šå¤©ç­‰å¾… Layer 3 å®Œæˆã€
- Carolï¼šã€Œç­‰å¾… Layer 3 å®Œæˆå¾Œé–‹å§‹ Layer 2 Controllerã€
```

---

## ç¬¬ä¹ç« ï¼šå¸¸è¦‹å•é¡Œ FAQ

### 9.1 æ–¹æ³•è«–ç†è§£å•é¡Œ

**Q1ï¼šç‚ºä»€éº¼ä¸€å®šè¦å–®å±¤ä¿®æ”¹ï¼Ÿå¤šå±¤ä¸€èµ·æ”¹ä¸æ˜¯æ›´å¿«å—ï¼Ÿ**

A1ï¼š
- **çŸ­æœŸçœ‹èµ·ä¾†å¿«**ï¼šä¸€æ¬¡æ”¹å®Œæ‰€æœ‰å±¤ç´šï¼Œæ„Ÿè¦ºçœæ™‚é–“
- **é•·æœŸé¢¨éšªé«˜**ï¼š
  - æ¸¬è©¦å›°é›£ï¼ˆéœ€è¦å•Ÿå‹•æ•´å€‹ç³»çµ±ï¼‰
  - Code Review è¤‡é›œï¼ˆå¯©æŸ¥è€…éœ€è¦ç†è§£æ‰€æœ‰å±¤ç´šï¼‰
  - å•é¡Œå®šä½å›°é›£ï¼ˆå‡ºéŒ¯æ™‚ä¸çŸ¥é“æ˜¯å“ªä¸€å±¤çš„å•é¡Œï¼‰
  - å›æ»¾å›°é›£ï¼ˆç„¡æ³•åªå›æ»¾æŸä¸€å±¤ï¼‰

**å¯¦ä¾‹æ¯”è¼ƒ**ï¼š
```markdown
## è·¨å±¤ä¿®æ”¹ï¼ˆé¢¨éšªé«˜ï¼‰
Ticketï¼šå¯¦ä½œæ›¸ç±æœå°‹åŠŸèƒ½
- ä¿®æ”¹ Layer 1, 2, 3, 5ï¼ˆ4 å€‹å±¤ç´šï¼‰
- æ¸¬è©¦éœ€è¦å•Ÿå‹•æ•´å€‹ç³»çµ±
- Code Review éœ€è¦ 1 å°æ™‚
- å‡ºéŒ¯æ™‚ç„¡æ³•åˆ¤æ–·æ˜¯å“ªä¸€å±¤çš„å•é¡Œ

## å–®å±¤ä¿®æ”¹ï¼ˆé¢¨éšªä½ï¼‰
Ticket 1ï¼š[Layer 5] å®šç¾© Book Entity
Ticket 2ï¼š[Layer 3] å¯¦ä½œ SearchUseCase
Ticket 3ï¼š[Layer 2] å¯¦ä½œ SearchController
Ticket 4ï¼š[Layer 1] å¯¦ä½œæœå°‹ UI
- æ¯å€‹ Ticket ç¨ç«‹æ¸¬è©¦
- Code Review æ¯å€‹åªéœ€ 15 åˆ†é˜
- å•é¡Œå®šä½æ¸…æ™°
```

---

**Q2ï¼šInfrastructure å±¤æ‡‰è©²å¦‚ä½•è™•ç†ï¼Ÿ**

A2ï¼š
- **Infrastructure å±¤ä¸åœ¨äº”å±¤æ¶æ§‹è¨è«–ç¯„åœ**
- **åŸå› **ï¼šæŠ€è¡“å¯¦ä½œç´°ç¯€ vs æ¥­å‹™é‚è¼¯
- **Ticket è¨­è¨ˆ**ï¼šInfrastructure å±¤é€šå¸¸æ˜¯ç¨ç«‹çš„æŠ€è¡“ä»»å‹™

**å¯¦ä¾‹**ï¼š
```markdown
### Ticketï¼š[Infrastructure] å¯¦ä½œ SQLite Book Repository

**å±¤ç´šå®šä½**ï¼šInfrastructureï¼ˆæŠ€è¡“å¯¦ä½œï¼‰

**è®Šæ›´ç¯„åœ**ï¼š
- æ–°å¢ï¼šlib/infrastructure/repositories/sqlite_book_repository.dart

**ä¾è³´é …ç›®**ï¼š
- å¯¦ä½œ IBookRepository ä»‹é¢ï¼ˆLayer 4ï¼‰

**æ¸¬è©¦ç¯„åœ**ï¼š
- æ•´åˆæ¸¬è©¦ï¼ˆå¯¦éš›è³‡æ–™åº«æ“ä½œï¼‰
```

---

**Q3ï¼šæ±ºç­–æ¨¹ç„¡æ³•åˆ¤æ–·æ™‚æ€éº¼è¾¦ï¼Ÿ**

A3ï¼š
- **æ­¥é©Ÿ 1**ï¼šé‡æ–°æª¢è¦–ç¨‹å¼ç¢¼çš„è·è²¬
- **æ­¥é©Ÿ 2**ï¼šå•è‡ªå·±ã€Œé€™æ®µç¨‹å¼ç¢¼çš„è®Šæ›´åŸå› æ˜¯ä»€éº¼ï¼Ÿã€
  - è¦–è¦ºè®Šæ›´ â†’ Layer 1
  - äº’å‹•è®Šæ›´ â†’ Layer 2
  - æ¥­å‹™æµç¨‹è®Šæ›´ â†’ Layer 3
  - å¥‘ç´„è®Šæ›´ â†’ Layer 4
  - æ¥­å‹™è¦å‰‡è®Šæ›´ â†’ Layer 5
- **æ­¥é©Ÿ 3**ï¼šå¦‚æœä»ç„¡æ³•åˆ¤æ–·ï¼Œå¯èƒ½æ˜¯è·è²¬ä¸å–®ä¸€ï¼Œéœ€è¦æ‹†åˆ†

---

### 9.2 å¯¦å‹™æ“ä½œå•é¡Œ

**Q4ï¼šTicket ç²’åº¦å¤ªå°ï¼Œç®¡ç†æˆæœ¬é«˜æ€éº¼è¾¦ï¼Ÿ**

A4ï¼š
- **æª¢æŸ¥æ˜¯å¦éåº¦æ‹†åˆ†**ï¼š
  - ä¿®æ”¹ 1 è¡Œç¨‹å¼ç¢¼ = ç²’åº¦éå°
  - æ‡‰è©²åˆä½µç‚ºæ›´å¤§çš„ Ticket
- **åˆä½µåŸå‰‡**ï¼š
  - åŒä¸€å±¤ç´šçš„å°ä¿®æ”¹å¯ä»¥åˆä½µ
  - è®Šæ›´åŸå› ç›¸åŒå¯ä»¥åˆä½µ
- **ç¯„ä¾‹**ï¼š
  ```markdown
  âŒ Ticket 1ï¼šä¿®æ”¹æŒ‰éˆ•é¡è‰²ï¼ˆ1 è¡Œï¼‰
  âŒ Ticket 2ï¼šèª¿æ•´é–“è·ï¼ˆ2 è¡Œï¼‰

  âœ… Ticketï¼šèª¿æ•´æ›¸ç±è©³æƒ…é  UI æ¨£å¼
  - ä¿®æ”¹æŒ‰éˆ•é¡è‰²
  - èª¿æ•´é–“è·
  - æ›´æ–°å­—é«”å¤§å°
  ```

---

**Q5ï¼šç²’åº¦æ¨™æº–è¶…å‡ºå®¹è¨±ç¯„åœæ™‚æ€éº¼è¾¦ï¼Ÿ**

A5ï¼š
- **æª”æ¡ˆæ•¸è¶…é 5 å€‹**ï¼šå¼·åˆ¶æ‹†åˆ†ç‚ºå¤šå€‹ Ticket
- **ç¨‹å¼ç¢¼è¡Œæ•¸è¶…é 300 è¡Œ**ï¼šæª¢æŸ¥æ˜¯å¦æœ‰é‡è¤‡é‚è¼¯å¯æå–
- **é–‹ç™¼æ™‚é–“è¶…é 1 å¤©**ï¼šé‡æ–°è©•ä¼°è¤‡é›œåº¦ï¼Œæ‹†åˆ†ç‚ºæ›´å°çš„ Ticket

**è™•ç†æµç¨‹**ï¼š
```text
æ­¥é©Ÿ 1ï¼šåˆ†æè¶…å‡ºåŸå› 
  - è·è²¬éå¤šï¼Ÿâ†’ æ‹†åˆ†ç‚ºå¤šå€‹ Ticket
  - ç¨‹å¼ç¢¼é‡è¤‡ï¼Ÿâ†’ æå–å…±ç”¨é‚è¼¯
  - ä¾è³´è¤‡é›œï¼Ÿâ†’ é‡æ–°è¨­è¨ˆæ¶æ§‹

æ­¥é©Ÿ 2ï¼šé‡æ–°è¦åŠƒ Ticket
  - æŒ‰åŠŸèƒ½æ¨¡çµ„æ‹†åˆ†
  - æŒ‰ä¾è³´é—œä¿‚æ‹†åˆ†

æ­¥é©Ÿ 3ï¼šé©—è­‰æ‹†åˆ†çµæœ
  - æ¯å€‹ Ticket ç¬¦åˆç²’åº¦æ¨™æº–ï¼Ÿ
  - æ¯å€‹ Ticket å¯ç¨ç«‹é©—æ”¶ï¼Ÿ
```

---

**Q6ï¼šå¾å¤–è€Œå…§å¯¦ä½œï¼Œå…§å±¤é‚„æ²’å®Œæˆæ€éº¼æ¸¬è©¦ï¼Ÿ**

A6ï¼š
- **ä½¿ç”¨ Mock æˆ– Stub**ï¼š
  - å¤–å±¤é–‹ç™¼æ™‚ï¼Œä½¿ç”¨ Mock å¯¦ä½œå…§å±¤ä»‹é¢
  - å…§å±¤å®Œæˆå¾Œï¼Œæ›¿æ›ç‚ºçœŸå¯¦å¯¦ä½œ
- **ç¯„ä¾‹**ï¼š
  ```dart
  // Layer 2 é–‹ç™¼æ™‚ï¼ŒLayer 3 å°šæœªå®Œæˆ

  // ä½¿ç”¨ Mock UseCase
  class MockSearchBookUseCase implements SearchBookUseCase {
    @override
    Future<OperationResult<List<Book>>> execute(String query) async {
      // è¿”å›æ¸¬è©¦è³‡æ–™
      return OperationResult.success([mockBook]);
    }
  }

  // Layer 2 æ¸¬è©¦
  test('æœå°‹æˆåŠŸæ‡‰è©²æ›´æ–°çµæœ', () async {
    final mockUseCase = MockSearchBookUseCase();
    final controller = BookSearchController(searchBookUseCase: mockUseCase);

    await controller.onSearch('test');

    expect(controller.searchResults.length, 1);
  });
  ```

---

### 9.3 åœ˜éšŠå”ä½œå•é¡Œ (ä¿®æ­£ #7)

**Q7ï¼šåœ˜éšŠæˆå“¡å°äº”å±¤æ¶æ§‹ç†è§£ä¸ä¸€è‡´æ€éº¼è¾¦ï¼Ÿ**

A7ï¼š
- **å»ºç«‹åœ˜éšŠå…±è­˜**ï¼š
  1. çµ„ç¹”æ¶æ§‹åŸ¹è¨“ï¼ˆ1-2 å°æ™‚ï¼‰
  2. Code Review æ™‚åŠ å¼·æºé€š
  3. å»ºç«‹æ¶æ§‹æ±ºç­–æ–‡ä»¶ï¼ˆADRï¼‰
  4. å®šæœŸæ¶æ§‹å›é¡§æœƒè­°

- **å¯¦å‹™åšæ³•**ï¼š
  ```markdown
  ## åœ˜éšŠæ¶æ§‹åŸ¹è¨“è¨ˆç•«

  ### Week 1ï¼šç†è«–åŸ¹è¨“
  - äº”å±¤æ¶æ§‹å®šç¾©
  - å–®å±¤ä¿®æ”¹åŸå‰‡
  - æ±ºç­–æ¨¹ä½¿ç”¨

  ### Week 2ï¼šå¯¦ä½œç·´ç¿’
  - Pair Programming
  - å…±åŒè¨­è¨ˆ Ticket
  - Code Review äº’ç›¸å­¸ç¿’

  ### Week 3ï¼šç¨ç«‹é–‹ç™¼
  - æ¯äººè² è²¬ä¸åŒå±¤ç´šçš„ Ticket
  - æ¯æ—¥ Standup è¨è«–é‡åˆ°çš„å•é¡Œ

  ### Week 4ï¼šå›é¡§æ”¹é€²
  - æª¢è¦–é•è¦æ¡ˆä¾‹
  - æ›´æ–°åœ˜éšŠè¦ç¯„
  - å»ºç«‹æœ€ä½³å¯¦è¸æ–‡ä»¶
  ```

---

**Q8ï¼šä¸åŒé–‹ç™¼è€…å°ã€Œå±¤ç´šå®šä½ã€æœ‰çˆ­è­°æ€éº¼è¾¦ï¼Ÿ**

A8ï¼š
- **ä½¿ç”¨æ±ºç­–æ¨¹å®¢è§€åˆ¤æ–·**ï¼š
  - ä¸ä¾è³´ä¸»è§€æ„è¦‹
  - æŒ‰ç…§æ±ºç­–æ¨¹æ­¥é©Ÿé€ä¸€æª¢æŸ¥

- **å»ºç«‹çˆ­è­°è§£æ±ºæ©Ÿåˆ¶**ï¼š
  1. **åˆæ­¥è¨è«–**ï¼šåœ˜éšŠå…§éƒ¨è¨è«– 15 åˆ†é˜
  2. **æ±ºç­–æ¨¹åˆ¤æ–·**ï¼šä½¿ç”¨æ±ºç­–æ¨¹å®¢è§€åˆ†æ
  3. **æ¶æ§‹å¸«è£æ±º**ï¼šå¦‚ä»æœ‰çˆ­è­°ï¼Œç”±æ¶æ§‹å¸«è£æ±º
  4. **è¨˜éŒ„æ±ºç­–**ï¼šå¯«å…¥ ADRï¼ˆArchitecture Decision Recordï¼‰

- **ç¯„ä¾‹**ï¼š
  ```markdown
  ## ADR-001ï¼šè³‡æ–™è½‰æ›é‚è¼¯çš„å±¤ç´šå®šä½

  **å•é¡Œ**ï¼šBookPresenter.toViewModel() æ‡‰è©²æ”¾åœ¨å“ªä¸€å±¤ï¼Ÿ

  **çˆ­è­°é»**ï¼š
  - æ„è¦‹ Aï¼šæ”¾åœ¨ Layer 3ï¼ˆå› ç‚ºæ˜¯è³‡æ–™è½‰æ›ï¼‰
  - æ„è¦‹ Bï¼šæ”¾åœ¨ Layer 2ï¼ˆå› ç‚ºæ˜¯çµ¦ UI ä½¿ç”¨ï¼‰

  **æ±ºç­–æ¨¹åˆ¤æ–·**ï¼š
  - æ­¥é©Ÿ 2ï¼šé€™æ®µç¨‹å¼ç¢¼æ˜¯å¦ã€Œè½‰æ›è³‡æ–™çµ¦ UI ä½¿ç”¨ã€ï¼Ÿ
    - æ˜¯ â†’ Layer 2

  **æœ€çµ‚æ±ºå®š**ï¼š
  - BookPresenter.toViewModel() å±¬æ–¼ Layer 2
  - åŸå› ï¼šè½‰æ›ç›®çš„æ˜¯ç‚ºäº† UI é¡¯ç¤º

  **åŸ·è¡Œæ¨™æº–**ï¼š
  - æ‰€æœ‰ Presenter éƒ½æ”¾åœ¨ `lib/application/presenters/`
  - æ¸¬è©¦æ”¾åœ¨ `test/application/presenters/`
  ```

---

**Q9ï¼šåœ˜éšŠè¦æ¨¡å¤§ï¼Œå¦‚ä½•å”èª¿å¤šäººé–‹ç™¼åŒä¸€åŠŸèƒ½ï¼Ÿ**

A9ï¼š
- **æŒ‰å±¤ç´šåˆ†å·¥**ï¼š
  - ä¸åŒå±¤ç´šå¯ä»¥ä¸¦è¡Œé–‹ç™¼
  - ä½¿ç”¨ Mock ä»‹é¢éš”é›¢ä¾è³´

- **åˆ†å·¥ç¯„ä¾‹**ï¼š
  ```markdown
  ## åŠŸèƒ½ï¼šæ›¸ç±æœå°‹ï¼ˆåœ˜éšŠåˆ†å·¥ï¼‰

  ### Alice è² è²¬ Domain å±¤ï¼ˆLayer 4 + 5ï¼‰
  - Ticket 1ï¼š[Layer 5] å®šç¾© Book Entity
  - Ticket 2ï¼š[Layer 4] å®šç¾© IBookRepository
  - é ä¼°ï¼š1 å¤©

  ### Bob è² è²¬ UseCase å±¤ï¼ˆLayer 3ï¼‰
  - Ticket 3ï¼š[Layer 3] å¯¦ä½œ SearchBookUseCase
  - ä¾è³´ï¼šç­‰å¾… Alice å®Œæˆ Layer 4 ä»‹é¢
  - é–‹ç™¼ç­–ç•¥ï¼šå…ˆç”¨ Mock Repository é–‹ç™¼
  - é ä¼°ï¼š1 å¤©

  ### Carol è² è²¬ Application å±¤ï¼ˆLayer 2ï¼‰
  - Ticket 4ï¼š[Layer 2] å¯¦ä½œ SearchController
  - ä¾è³´ï¼šç­‰å¾… Bob å®Œæˆ Layer 3
  - é–‹ç™¼ç­–ç•¥ï¼šå…ˆç”¨ Mock UseCase é–‹ç™¼
  - é ä¼°ï¼š1 å¤©

  ### David è² è²¬ UI å±¤ï¼ˆLayer 1ï¼‰
  - Ticket 5ï¼š[Layer 1] å¯¦ä½œæœå°‹é é¢ UI
  - ä¾è³´ï¼šç­‰å¾… Carol å®Œæˆ Layer 2
  - é–‹ç™¼ç­–ç•¥ï¼šå…ˆç”¨ Mock Controller é–‹ç™¼
  - é ä¼°ï¼š1 å¤©

  ### å”ä½œæ™‚é–“ç·š
  Day 1ï¼šAlice, Bob, Carol, David åŒæ™‚é–‹å§‹ï¼ˆä½¿ç”¨ Mockï¼‰
  Day 2ï¼šAlice å®Œæˆ â†’ Bob æ•´åˆçœŸå¯¦ä»‹é¢
  Day 3ï¼šBob å®Œæˆ â†’ Carol æ•´åˆçœŸå¯¦ UseCase
  Day 4ï¼šCarol å®Œæˆ â†’ David æ•´åˆçœŸå¯¦ Controller
  Day 5ï¼šæ•´åˆæ¸¬è©¦ï¼ŒåŠŸèƒ½å®Œæˆ
  ```

---

**Q10ï¼šCode Review æ™‚å¦‚ä½•å¿«é€Ÿæª¢æŸ¥å±¤ç´šéš”é›¢åŸå‰‡ï¼Ÿ**

A10ï¼š
- **å»ºç«‹ Code Review Checklist**ï¼š
  ```markdown
  ## å±¤ç´šéš”é›¢ Code Review Checklist

  ### 1. å–®å±¤ä¿®æ”¹æª¢æŸ¥
  - [ ] æ­¤ PR æ˜¯å¦åªä¿®æ”¹å–®ä¸€å±¤ç´šï¼Ÿ
  - [ ] å¦‚æœè·¨å±¤ï¼Œæ˜¯å¦æœ‰åˆç†åŸå› ï¼Ÿï¼ˆå¦‚æ¶æ§‹é·ç§»ï¼‰

  ### 2. ä¾è³´æ–¹å‘æª¢æŸ¥
  - [ ] å¤–å±¤æ˜¯å¦ä¾è³´å…§å±¤çš„æŠ½è±¡ä»‹é¢ï¼Ÿ
  - [ ] å…§å±¤æ˜¯å¦æ²’æœ‰ä¾è³´å¤–å±¤ï¼Ÿ

  ### 3. è·è²¬å–®ä¸€æ€§æª¢æŸ¥
  - [ ] æ¯å€‹æª”æ¡ˆæ˜¯å¦åªæœ‰å–®ä¸€è·è²¬ï¼Ÿ
  - [ ] UI å±¤æ˜¯å¦æ²’æœ‰æ¥­å‹™é‚è¼¯ï¼Ÿ
  - [ ] Controller æ˜¯å¦æ²’æœ‰æ ¸å¿ƒæ¥­å‹™è¦å‰‡ï¼Ÿ

  ### 4. æ¸¬è©¦ç¯„åœæª¢æŸ¥
  - [ ] æ¸¬è©¦æª”æ¡ˆè·¯å¾‘æ˜¯å¦å°æ‡‰å±¤ç´šçµæ§‹ï¼Ÿ
  - [ ] æ¸¬è©¦é¡å‹æ˜¯å¦ç¬¦åˆå±¤ç´šå®šä½ï¼Ÿ
  - [ ] æ¸¬è©¦è¦†è“‹ç‡æ˜¯å¦é”åˆ° 100%ï¼Ÿ

  ### 5. Commit Message æª¢æŸ¥
  - [ ] Commit Message æ˜¯å¦æ¨™æ˜å±¤ç´šï¼ˆå¦‚ feat(layer2)ï¼‰ï¼Ÿ
  - [ ] è®Šæ›´åŸå› æ˜¯å¦å–®ä¸€ä¸”æ˜ç¢ºï¼Ÿ
  ```

- **å¿«é€Ÿæª¢æŸ¥æŠ€å·§**ï¼š
  1. **çœ‹æª”æ¡ˆè·¯å¾‘**ï¼š5 ç§’åˆ¤æ–·æ˜¯å¦è·¨å±¤
  2. **çœ‹ import èªå¥**ï¼šæª¢æŸ¥ä¾è³´æ–¹å‘
  3. **çœ‹æ¸¬è©¦æª”æ¡ˆ**ï¼šé©—è­‰æ¸¬è©¦ç¯„åœ

---

**Q11ï¼šæ–°æˆå“¡åŠ å…¥ï¼Œå¦‚ä½•å¿«é€Ÿä¸Šæ‰‹å±¤ç´šéš”é›¢æ´¾å·¥ï¼Ÿ**

A11ï¼š
- **éšæ®µå¼åŸ¹è¨“è¨ˆç•«**ï¼š

  **Week 1ï¼šç†è«–å­¸ç¿’ï¼ˆ4 å°æ™‚ï¼‰**
  - é–±è®€æœ¬æ–‡ä»¶ï¼ˆ2 å°æ™‚ï¼‰
  - è§€çœ‹æ¶æ§‹åŸ¹è¨“å½±ç‰‡ï¼ˆ1 å°æ™‚ï¼‰
  - å®Œæˆæ±ºç­–æ¨¹ç·´ç¿’ï¼ˆ1 å°æ™‚ï¼‰

  **Week 2ï¼šå¯¦æˆ°æ¼”ç·´ï¼ˆPair Programmingï¼‰**
  - èˆ‡è³‡æ·±æˆå“¡ Pair Programmingï¼ˆ3 å¤©ï¼‰
  - è§€å¯Ÿ Ticket æ‹†åˆ†éç¨‹
  - åƒèˆ‡ Code Review

  **Week 3ï¼šç¨ç«‹é–‹ç™¼ï¼ˆæœ‰ç›£ç£ï¼‰**
  - ç¨ç«‹è² è²¬å–®ä¸€å±¤ç´šçš„ Ticket
  - æ¯æ—¥èˆ‡ Mentor è¨è«–é€²åº¦
  - Code Review ç”± Mentor ä»”ç´°å¯©æŸ¥

  **Week 4ï¼šå®Œå…¨ç¨ç«‹**
  - ç¨ç«‹è¨­è¨ˆ Ticket
  - ç¨ç«‹é–‹ç™¼å’Œæ¸¬è©¦
  - åƒèˆ‡åœ˜éšŠ Code Review

- **å­¸ç¿’è³‡æºæ¸…å–®**ï¼š
  ```markdown
  ## å±¤ç´šéš”é›¢æ´¾å·¥å­¸ç¿’è³‡æº

  ### å¿…è®€æ–‡ä»¶
  1. æœ¬æ–‡ä»¶ï¼šå±¤ç´šéš”é›¢æ´¾å·¥æ–¹æ³•è«–
  2. Clean Architecture å¯¦ä½œæ–¹æ³•è«–
  3. TDD å››éšæ®µæµç¨‹æ–‡ä»¶

  ### åƒè€ƒç¯„ä¾‹
  1. æ¡ˆä¾‹ 1ï¼šæ–°å¢æ›¸ç±æœå°‹åŠŸèƒ½ï¼ˆå®Œæ•´äº”å±¤å¯¦ä½œï¼‰
  2. æ¡ˆä¾‹ 2ï¼šé‡æ§‹ç¾æœ‰ç¨‹å¼ç¢¼ï¼ˆé•è¦æ¡ˆä¾‹åˆ†æï¼‰
  3. æ¡ˆä¾‹ 3ï¼šæ¶æ§‹é·ç§»ï¼ˆäº”éšæ®µé·ç§»è¨ˆç•«ï¼‰

  ### ç·´ç¿’é¡Œ
  1. æ±ºç­–æ¨¹ç·´ç¿’ï¼šåˆ¤æ–· 10 æ®µç¨‹å¼ç¢¼çš„å±¤ç´šå®šä½
  2. Ticket æ‹†åˆ†ç·´ç¿’ï¼šå°‡å®Œæ•´åŠŸèƒ½æ‹†åˆ†ç‚ºå–®å±¤ Ticket
  3. Code Review ç·´ç¿’ï¼šè­˜åˆ¥é•è¦æ¨¡å¼

  ### Mentor æŒ‡å®š
  - Mentorï¼š{è³‡æ·±æˆå“¡åç¨±}
  - è¯çµ¡æ–¹å¼ï¼š{Slack/Email}
  - æ¯é€±ä¸€å°ä¸€ï¼š30 åˆ†é˜
  ```

---

**Q12ï¼šå¦‚ä½•è¡¡é‡åœ˜éšŠçš„å±¤ç´šéš”é›¢åŸ·è¡Œå“è³ªï¼Ÿ**

A12ï¼š
- **é‡åŒ–æŒ‡æ¨™**ï¼š

  | æŒ‡æ¨™ | è¨ˆç®—æ–¹å¼ | ç›®æ¨™å€¼ |
  |------|---------|--------|
  | **å–®å±¤ä¿®æ”¹ç‡** | å–®å±¤ Ticket æ•¸ / ç¸½ Ticket æ•¸ | â‰¥ 90% |
  | **Ticket ç²’åº¦åˆè¦ç‡** | ç¬¦åˆç²’åº¦æ¨™æº–çš„ Ticket æ•¸ / ç¸½æ•¸ | â‰¥ 85% |
  | **æ¸¬è©¦è¦†è“‹ç‡** | æ–°å¢ç¨‹å¼ç¢¼æ¸¬è©¦è¦†è“‹ç‡ | 100% |
  | **Code Review æ™‚é–“** | å¹³å‡æ¯å€‹ PR çš„ Review æ™‚é–“ | â‰¤ 30 åˆ†é˜ |
  | **æ¶æ§‹é•è¦æ•¸** | æ¯é€±ç™¼ç¾çš„æ¶æ§‹é•è¦æ¬¡æ•¸ | â‰¤ 2 æ¬¡ |

- **å®šæœŸæª¢è¦–**ï¼š
  ```markdown
  ## æ¯æœˆæ¶æ§‹å“è³ªæª¢è¦–æœƒè­°

  ### è­°ç¨‹
  1. å›é¡§æœ¬æœˆé‡åŒ–æŒ‡æ¨™ï¼ˆ15 åˆ†é˜ï¼‰
  2. åˆ†æé•è¦æ¡ˆä¾‹ï¼ˆ20 åˆ†é˜ï¼‰
  3. è¨è«–æ”¹é€²æªæ–½ï¼ˆ15 åˆ†é˜ï¼‰
  4. æ›´æ–°åœ˜éšŠè¦ç¯„ï¼ˆ10 åˆ†é˜ï¼‰

  ### ç”¢å‡º
  - æ¶æ§‹å“è³ªæœˆå ±
  - é•è¦æ¡ˆä¾‹åˆ†ææ–‡ä»¶
  - æ”¹é€²è¡Œå‹•è¨ˆç•«
  ```

---

## ç¬¬åç« ï¼šåƒè€ƒè³‡æ–™

### 10.1 æ ¸å¿ƒåƒè€ƒæ–‡ç»

**Clean Architecture ç›¸é—œ**ï¼š
1. **Clean Architecture** - Robert C. Martin
   - æ ¸å¿ƒç†è«–ï¼šä¾è³´å€’ç½®ã€å±¤ç´šéš”é›¢ã€ä»‹é¢æŠ½è±¡
   - æœ¬æ–¹æ³•è«–çš„ç†è«–åŸºç¤

2. **Implementing Clean Architecture**
   - å¯¦å‹™æŒ‡å¼•ï¼šå¦‚ä½•åœ¨çœŸå¯¦å°ˆæ¡ˆä¸­å¯¦ä½œ Clean Architecture
   - æä¾›å…·é«”ç¯„ä¾‹å’Œæœ€ä½³å¯¦è¸

**è»Ÿé«”è¨­è¨ˆåŸå‰‡**ï¼š
3. **SOLID Principles**
   - Single Responsibility Principleï¼ˆSRPï¼‰
   - Open/Closed Principleï¼ˆOCPï¼‰
   - Liskov Substitution Principleï¼ˆLSPï¼‰
   - Interface Segregation Principleï¼ˆISPï¼‰
   - Dependency Inversion Principleï¼ˆDIPï¼‰

4. **Domain-Driven Design** - Eric Evans
   - Entity, Value Object, Aggregate è¨­è¨ˆ
   - é ˜åŸŸæ¨¡å‹é©…å‹•è¨­è¨ˆ

**æ•æ·èˆ‡ TDD**ï¼š
5. **Test-Driven Development** - Kent Beck
   - TDD å¯¦è¸æ–¹æ³•
   - æ¸¬è©¦å…ˆè¡Œé–‹ç™¼

6. **Agile Software Development** - Robert C. Martin
   - æ•æ·é–‹ç™¼åŸå‰‡
   - å¿«é€Ÿè¿­ä»£èˆ‡æŒçºŒäº¤ä»˜

### 10.2 å°ˆæ¡ˆç‰¹å®šæ–‡ä»¶

**æœ¬å°ˆæ¡ˆæ–¹æ³•è«–æ–‡ä»¶**ï¼š
1. **Clean Architecture å¯¦ä½œæ–¹æ³•è«–**
   - è·¯å¾‘ï¼š`.claude/methodologies/clean-architecture-implementation.md`
   - å…§å®¹ï¼šäº”å±¤æ¶æ§‹å¯¦ä½œç´°ç¯€

2. **TDD å››éšæ®µæµç¨‹**
   - è·¯å¾‘ï¼š`.claude/tdd-collaboration-flow.md`
   - å…§å®¹ï¼šPhase 1-4 è©³ç´°æµç¨‹

3. **Ticket è¨­è¨ˆæ–¹æ³•è«–**
   - è·¯å¾‘ï¼š`.claude/methodologies/ticket-design-methodology.md`
   - å…§å®¹ï¼šTicket å¯«ä½œè¦ç¯„

4. **5W1H è‡ªè¦ºæ±ºç­–æ–¹æ³•è«–**
   - è·¯å¾‘ï¼š`.claude/methodologies/5w1h-self-awareness-methodology.md`
   - å…§å®¹ï¼šæ±ºç­–æ¡†æ¶å’Œé€ƒé¿è¡Œç‚ºæª¢æ¸¬

5. **æ•æ·é‡æ§‹æ–¹æ³•è«–**
   - è·¯å¾‘ï¼š`.claude/methodologies/agile-refactor-methodology.md`
   - å…§å®¹ï¼šä»£ç†äººåˆ†å·¥å”ä½œæ¨¡å¼

### 10.3 å·¥å…·èˆ‡è…³æœ¬

**å±¤ç´šæª¢æŸ¥å·¥å…·**ï¼š

#### 1. æª”æ¡ˆè·¯å¾‘åˆ†æè…³æœ¬

**ç”¨é€”**ï¼šæª¢æŸ¥ Commit æ˜¯å¦è·¨å±¤

**è…³æœ¬ä½ç½®**ï¼š`scripts/check_single_layer_modification.sh`

```bash
#!/bin/bash
# scripts/check_single_layer_modification.sh
# æª¢æŸ¥ Git Commit æ˜¯å¦ç¬¦åˆå–®å±¤ä¿®æ”¹åŸå‰‡

set -e

# ç²å–ä¿®æ”¹çš„æª”æ¡ˆåˆ—è¡¨
files=$(git diff --name-only HEAD~1)

# å®šç¾©å±¤ç´šé—œè¯é™£åˆ—
declare -A layers

# åˆ†ææ¯å€‹æª”æ¡ˆçš„å±¤ç´š
for file in $files; do
    if [[ $file == lib/presentation/pages/* ]] || [[ $file == lib/presentation/widgets/* ]]; then
        layers["Layer1"]=1
    elif [[ $file == lib/presentation/controllers/* ]] || [[ $file == lib/presentation/presenters/* ]]; then
        layers["Layer2"]=1
    elif [[ $file == lib/application/use_cases/* ]]; then
        layers["Layer3"]=1
    elif [[ $file == lib/domain/events/* ]] || [[ $file == lib/domain/interfaces/* ]]; then
        layers["Layer4"]=1
    elif [[ $file == lib/domain/entities/* ]] || [[ $file == lib/domain/services/* ]]; then
        layers["Layer5"]=1
    elif [[ $file == lib/infrastructure/* ]]; then
        layers["Infrastructure"]=1
    fi
done

# æª¢æŸ¥å±¤ç´šæ•¸é‡
layer_count=${#layers[@]}

if [[ $layer_count -eq 0 ]]; then
    echo "âš ï¸  ç„¡æ³•åˆ¤æ–·å±¤ç´šï¼ˆå¯èƒ½æ˜¯éç¨‹å¼ç¢¼æª”æ¡ˆï¼‰"
    exit 0
elif [[ $layer_count -eq 1 ]]; then
    echo "âœ… ç¬¦åˆå–®å±¤ä¿®æ”¹åŸå‰‡"
    echo "ğŸ“ ä¿®æ”¹å±¤ç´š: ${!layers[@]}"
    exit 0
else
    echo "âŒ é•åå–®å±¤ä¿®æ”¹åŸå‰‡"
    echo "ğŸ“ æ¶‰åŠå±¤ç´š: ${!layers[@]}"
    echo ""
    echo "å»ºè­°ï¼š"
    echo "1. å°‡æ­¤ Commit æ‹†åˆ†ç‚ºå¤šå€‹å–®å±¤ Commit"
    echo "2. æ¯å€‹ Commit åªä¿®æ”¹å–®ä¸€å±¤ç´š"
    exit 1
fi
```

**ä½¿ç”¨æ–¹å¼**ï¼š
```bash
# åœ¨ Git Hook ä¸­åŸ·è¡Œ
./scripts/check_single_layer_modification.sh

# æˆ–åœ¨ CI/CD ä¸­åŸ·è¡Œ
bash scripts/check_single_layer_modification.sh
```

---

#### 2. æ¸¬è©¦è¦†è“‹ç‡æª¢æŸ¥è…³æœ¬

**ç”¨é€”**ï¼šç¢ºä¿æ–°å¢ç¨‹å¼ç¢¼ 100% æ¸¬è©¦è¦†è“‹ç‡

**è…³æœ¬ä½ç½®**ï¼š`scripts/check_coverage.sh`

```bash
#!/bin/bash
# scripts/check_coverage.sh
# æª¢æŸ¥æ¸¬è©¦è¦†è“‹ç‡æ˜¯å¦é”åˆ° 100%

set -e

# åŸ·è¡Œæ¸¬è©¦ä¸¦ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
flutter test --coverage

# æª¢æŸ¥ lcov.info æ˜¯å¦å­˜åœ¨
if [[ ! -f coverage/lcov.info ]]; then
    echo "âŒ æ‰¾ä¸åˆ°è¦†è“‹ç‡å ±å‘Š: coverage/lcov.info"
    exit 1
fi

# ä½¿ç”¨ lcov åˆ†æè¦†è“‹ç‡
lcov --summary coverage/lcov.info > coverage_summary.txt 2>&1

# æå–è¦†è“‹ç‡ç™¾åˆ†æ¯”
coverage=$(grep "lines" coverage_summary.txt | awk '{print $2}' | sed 's/%//')

echo "ğŸ“Š ç•¶å‰æ¸¬è©¦è¦†è“‹ç‡: ${coverage}%"

# æª¢æŸ¥æ˜¯å¦é”åˆ° 100%
if (( $(echo "$coverage >= 100.0" | bc -l) )); then
    echo "âœ… æ¸¬è©¦è¦†è“‹ç‡é”æ¨™ï¼ˆ100%ï¼‰"
    exit 0
elif (( $(echo "$coverage >= 95.0" | bc -l) )); then
    echo "âš ï¸  æ¸¬è©¦è¦†è“‹ç‡æ¥è¿‘é”æ¨™ï¼ˆ${coverage}%ï¼‰ï¼Œå»ºè­°è£œå……æ¸¬è©¦"
    exit 0
else
    echo "âŒ æ¸¬è©¦è¦†è“‹ç‡æœªé”æ¨™ï¼ˆ${coverage}% < 100%ï¼‰"
    echo ""
    echo "å»ºè­°ï¼š"
    echo "1. ä½¿ç”¨ genhtml ç”Ÿæˆè©³ç´°å ±å‘Šï¼šgenhtml coverage/lcov.info -o coverage/html"
    echo "2. é–‹å•Ÿ coverage/html/index.html æŸ¥çœ‹æœªè¦†è“‹çš„ç¨‹å¼ç¢¼"
    echo "3. è£œå……ç¼ºå¤±çš„æ¸¬è©¦æ¡ˆä¾‹"
    exit 1
fi
```

**ä½¿ç”¨æ–¹å¼**ï¼š
```bash
# æ‰‹å‹•åŸ·è¡Œ
./scripts/check_coverage.sh

# åœ¨ CI/CD ä¸­åŸ·è¡Œ
bash scripts/check_coverage.sh
```

---

#### 3. Commit Message é©—è­‰è…³æœ¬

**ç”¨é€”**ï¼šé©—è­‰ Commit Message æ˜¯å¦ç¬¦åˆå±¤ç´šéš”é›¢è¦ç¯„æ ¼å¼

**è…³æœ¬ä½ç½®**ï¼š`scripts/check_commit_message.sh`

```bash
#!/bin/bash
# scripts/check_commit_message.sh
# é©—è­‰ Commit Message æ˜¯å¦ç¬¦åˆå±¤ç´šéš”é›¢è¦ç¯„

set -e

# è®€å– Commit Message
commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

# å®šç¾©åˆæ³•çš„ Commit Message æ ¼å¼
# æ ¼å¼ï¼š[Layer X] <type>: <description>
# ç¯„ä¾‹ï¼š[Layer 1] feat: æ–°å¢æ›¸ç±è©³æƒ…é é¢

layer_pattern='^\[Layer [1-5]\]'
infra_pattern='^\[Infrastructure\]'
type_pattern='(feat|fix|refactor|test|docs|style|chore):'

# æª¢æŸ¥æ˜¯å¦ç¬¦åˆå±¤ç´šæ ¼å¼
if [[ $commit_msg =~ $layer_pattern ]] || [[ $commit_msg =~ $infra_pattern ]]; then
    # æª¢æŸ¥é¡å‹æ ¼å¼
    if [[ $commit_msg =~ $type_pattern ]]; then
        echo "âœ… Commit Message æ ¼å¼æ­£ç¢º"
        echo "ğŸ“‹ è¨Šæ¯å…§å®¹: $commit_msg"
        exit 0
    else
        echo "âŒ Commit Message ç¼ºå°‘é¡å‹æ¨™è¨˜"
        echo "ğŸ“‹ ç•¶å‰è¨Šæ¯: $commit_msg"
        echo ""
        echo "å»ºè­°æ ¼å¼ï¼š"
        echo "  [Layer X] <type>: <description>"
        echo ""
        echo "åˆæ³•é¡å‹ï¼š"
        echo "  - feat: æ–°åŠŸèƒ½"
        echo "  - fix: ä¿®å¾©"
        echo "  - refactor: é‡æ§‹"
        echo "  - test: æ¸¬è©¦"
        echo "  - docs: æ–‡ä»¶"
        echo "  - style: æ ¼å¼"
        echo "  - chore: é›œé …"
        exit 1
    fi
else
    echo "âŒ Commit Message ç¼ºå°‘å±¤ç´šæ¨™è¨˜"
    echo "ğŸ“‹ ç•¶å‰è¨Šæ¯: $commit_msg"
    echo ""
    echo "å»ºè­°æ ¼å¼ï¼š"
    echo "  [Layer 1] feat: UI ç›¸é—œä¿®æ”¹"
    echo "  [Layer 2] refactor: Controller é‡æ§‹"
    echo "  [Layer 3] feat: æ–°å¢ UseCase"
    echo "  [Layer 4] feat: å®šç¾©æ–°äº‹ä»¶"
    echo "  [Layer 5] feat: Domain é‚è¼¯å¯¦ä½œ"
    echo "  [Infrastructure] chore: å‡ç´šè³‡æ–™åº«"
    exit 1
fi
```

**ä½¿ç”¨æ–¹å¼**ï¼š
```bash
# åœ¨ Git Hook ä¸­åŸ·è¡Œï¼ˆcommit-msg hookï¼‰
./scripts/check_commit_message.sh .git/COMMIT_EDITMSG

# æ‰‹å‹•é©—è­‰
echo "[Layer 1] feat: æ–°å¢æ›¸ç±è©³æƒ…é é¢" | ./scripts/check_commit_message.sh /dev/stdin
```

**CI/CD æ•´åˆ**ï¼š
4. **GitHub Actions Workflow**
   - `.github/workflows/pr_check.yml`
   - PR è‡ªå‹•æª¢æŸ¥å±¤ç´šéš”é›¢åŸå‰‡

5. **Pre-commit Hook**
   - `.git/hooks/pre-commit`
   - Commit å‰è‡ªå‹•æª¢æŸ¥

### 10.4 å»¶ä¼¸é–±è®€

**æ¶æ§‹è¨­è¨ˆ**ï¼š
1. **Hexagonal Architecture** - Alistair Cockburn
   - å…­é‚Šå½¢æ¶æ§‹
   - Ports and Adapters æ¨¡å¼

2. **Onion Architecture** - Jeffrey Palermo
   - æ´‹è”¥æ¶æ§‹
   - å±¤ç´šéš”é›¢æ€æƒ³

**æ¸¬è©¦ç­–ç•¥**ï¼š
3. **Growing Object-Oriented Software, Guided by Tests**
   - æ¸¬è©¦é©…å‹•ç‰©ä»¶å°å‘è¨­è¨ˆ
   - Mock å’Œ Stub ä½¿ç”¨

4. **The Art of Unit Testing** - Roy Osherove
   - å–®å…ƒæ¸¬è©¦æœ€ä½³å¯¦è¸
   - æ¸¬è©¦éš”é›¢æŠ€å·§

**åœ˜éšŠå”ä½œ**ï¼š
5. **Extreme Programming Explained** - Kent Beck
   - Pair Programming
   - æŒçºŒæ•´åˆ

6. **The Phoenix Project** - Gene Kim
   - DevOps å¯¦è¸
   - æŒçºŒäº¤ä»˜æµç¨‹

### 10.5 ç·šä¸Šè³‡æº

**Clean Architecture ç¤¾ç¾¤**ï¼š
1. **Clean Coders**
   - ç¶²å€ï¼šhttps://cleancoders.com
   - Robert C. Martin çš„æ•™å­¸å½±ç‰‡

2. **Flutter Clean Architecture Examples**
   - GitHubï¼šflutter-clean-architecture-examples
   - å¯¦éš›å°ˆæ¡ˆç¯„ä¾‹

**å·¥å…·æ¨è–¦**ï¼š
3. **PlantUML**
   - æ¶æ§‹åœ–ç¹ªè£½å·¥å…·
   - è¦–è¦ºåŒ–å±¤ç´šé—œä¿‚

4. **Dependency Cruiser**
   - ä¾è³´é—œä¿‚åˆ†æå·¥å…·
   - æª¢æ¸¬ä¾è³´æ–¹å‘é•è¦

### 10.6 æ›´æ–°è¨˜éŒ„

**v1.0.0** (2025-10-11)
- åˆç‰ˆç™¼å¸ƒ
- æ•´åˆ Phase 1 åŸå§‹è¨­è¨ˆï¼ˆ1707 è¡Œï¼‰
- æ•´åˆ Phase 1 ä¿®æ­£å…§å®¹ï¼ˆ1098 è¡Œï¼‰
- åŒ…å« 7 å€‹ä¿®æ­£ï¼š
  - ä¿®æ­£ #1ï¼šPresenter è³‡æ–™è½‰æ›è·è²¬æ˜ç¢ºå®šä½
  - ä¿®æ­£ #2ï¼šéŒ¯èª¤è½‰æ› vs éŒ¯èª¤é¡¯ç¤ºé‚Šç•Œé‡æ¸…
  - ä¿®æ­£ #3ï¼šæ±ºç­–æ¨¹æ¶µè“‹ Infrastructure å±¤åˆ¤æ–·
  - ä¿®æ­£ #4ï¼šç‰¹æ®Šå ´æ™¯è™•ç†ï¼ˆæ¶æ§‹é·ç§»ã€å®‰å…¨ä¿®å¾©ï¼‰
  - ä¿®æ­£ #5ï¼šTicket ç²’åº¦æ¨™æº–é‚Šç•Œå€é–“ç´°åŒ–
  - ä¿®æ­£ #6ï¼šæ¶æ§‹é·ç§» Interface-First äº”éšæ®µæŒ‡å¼•
  - ä¿®æ­£ #7ï¼šåœ˜éšŠå”ä½œæŒ‡å¼•ï¼ˆQ7-Q12ï¼‰

---

**æ–‡ä»¶çµæŸ**

---

**é—œæ–¼æœ¬æ–‡ä»¶**ï¼š

æœ¬æ–‡ä»¶å®šç¾©äº†å®Œæ•´çš„å±¤ç´šéš”é›¢æ´¾å·¥æ–¹æ³•è«–ï¼Œç‚ºæ‰€æœ‰éµå¾ª Clean Architecture çš„å°ˆæ¡ˆæä¾› Ticket æ‹†åˆ†å’Œå¯¦ä½œé †åºæŒ‡å¼•ã€‚

**é©ç”¨å°è±¡**ï¼š
- å°ˆæ¡ˆç¶“ç†ï¼ˆPMï¼‰ï¼šè¦åŠƒå’Œæ‹†åˆ† Ticket
- é–‹ç™¼äººå“¡ï¼šåŸ·è¡Œå–®å±¤ä¿®æ”¹
- æ¶æ§‹å¸«ï¼šè¨­è¨ˆå’Œå¯©æŸ¥æ¶æ§‹
- Code Reviewerï¼šæª¢æŸ¥å±¤ç´šéš”é›¢åŸå‰‡

**æ ¸å¿ƒåƒ¹å€¼**ï¼š
- é™ä½è®Šæ›´é¢¨éšª
- æå‡æ¸¬è©¦ç¨ç«‹æ€§
- åŠ é€Ÿé–‹ç™¼å¾ªç’°
- æå‡ Code Review æ•ˆç‡

**æŒçºŒæ”¹é€²**ï¼š
æœ¬æ–‡ä»¶å°‡æ ¹æ“šå¯¦å‹™ç¶“é©—æŒçºŒæ›´æ–°ï¼Œæ­¡è¿æä¾›å›é¥‹å’Œæ”¹é€²å»ºè­°ã€‚

---
